<!-- HTML header for doxygen 1.8.4-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.4"/>
<title>NVBIO: E:/git/nvbio/contrib/htslib/cram/cram_structs.h Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="extra_stylesheet.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript">
    (function(i, s, o, g, r, a, m) {
        i['GoogleAnalyticsObject'] = r; i[r] = i[r] || function() {
            (i[r].q = i[r].q || []).push(arguments)
        }, i[r].l = 1 * new Date(); a = s.createElement(o),
  m = s.getElementsByTagName(o)[0]; a.async = 1; a.src = g; m.parentNode.insertBefore(a, m)
    })(window, document, 'script', '//www.google-analytics.com/analytics.js', 'ga');
    ga('create', 'UA-47310325-1', 'nvlabs.github.io');
    ga('send', 'pageview');
</script>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">NVBIO
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.4 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="modules.html"><span>Modules</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li><a href="examples.html"><span>Examples</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&#160;List</span></a></li>
      <li><a href="globals.html"><span>File&#160;Members</span></a></li>
    </ul>
  </div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Classes</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Namespaces</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&#160;</span>Typedefs</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(7)"><span class="SelectionMark">&#160;</span>Enumerations</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(8)"><span class="SelectionMark">&#160;</span>Enumerator</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(9)"><span class="SelectionMark">&#160;</span>Friends</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(10)"><span class="SelectionMark">&#160;</span>Macros</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(11)"><span class="SelectionMark">&#160;</span>Groups</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(12)"><span class="SelectionMark">&#160;</span>Pages</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_3847941dc22744d30c1d316a1f1a60e2.html">contrib</a></li><li class="navelem"><a class="el" href="dir_1f8b60e8cc95185043cfc776c828be7a.html">htslib</a></li><li class="navelem"><a class="el" href="dir_6dbdc261664c8166edce7032c37210f4.html">cram</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="headertitle">
<div class="title">cram_structs.h</div>  </div>
</div><!--header-->
<div class="contents">
<a href="cram__structs_8h.html">Go to the documentation of this file.</a><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;<span class="comment">/*</span></div>
<div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;<span class="comment">Copyright (c) 2012-2013 Genome Research Ltd.</span></div>
<div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;<span class="comment">Author: James Bonfield &lt;jkb@sanger.ac.uk&gt;</span></div>
<div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;<span class="comment"></span></div>
<div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;<span class="comment">Redistribution and use in source and binary forms, with or without </span></div>
<div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;<span class="comment">modification, are permitted provided that the following conditions are met:</span></div>
<div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;<span class="comment"></span></div>
<div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;<span class="comment">   1. Redistributions of source code must retain the above copyright notice, </span></div>
<div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160;<span class="comment">this list of conditions and the following disclaimer.</span></div>
<div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;<span class="comment"></span></div>
<div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;<span class="comment">   2. Redistributions in binary form must reproduce the above copyright notice, </span></div>
<div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160;<span class="comment">this list of conditions and the following disclaimer in the documentation </span></div>
<div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160;<span class="comment">and/or other materials provided with the distribution.</span></div>
<div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160;<span class="comment"></span></div>
<div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160;<span class="comment">   3. Neither the names Genome Research Ltd and Wellcome Trust Sanger</span></div>
<div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160;<span class="comment">Institute nor the names of its contributors may be used to endorse or promote</span></div>
<div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160;<span class="comment">products derived from this software without specific prior written permission.</span></div>
<div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160;<span class="comment"></span></div>
<div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160;<span class="comment">THIS SOFTWARE IS PROVIDED BY GENOME RESEARCH LTD AND CONTRIBUTORS &quot;AS IS&quot; AND </span></div>
<div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160;<span class="comment">ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED </span></div>
<div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;<span class="comment">WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE </span></div>
<div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;<span class="comment">DISCLAIMED. IN NO EVENT SHALL GENOME RESEARCH LTD OR CONTRIBUTORS BE LIABLE</span></div>
<div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;<span class="comment">FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL</span></div>
<div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;<span class="comment">DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR</span></div>
<div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;<span class="comment">SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER</span></div>
<div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;<span class="comment">CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY,</span></div>
<div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;<span class="comment">OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE</span></div>
<div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;<span class="comment">OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.</span></div>
<div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;<span class="comment">*/</span></div>
<div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;</div>
<div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;<span class="preprocessor">#ifndef _CRAM_STRUCTS_H_</span></div>
<div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;<span class="preprocessor"></span><span class="preprocessor">#define _CRAM_STRUCTS_H_</span></div>
<div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;<span class="preprocessor"></span></div>
<div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;<span class="preprocessor">#ifdef __cplusplus</span></div>
<div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;<span class="preprocessor"></span><span class="keyword">extern</span> <span class="stringliteral">&quot;C&quot;</span> {</div>
<div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;<span class="preprocessor"></span></div>
<div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;<span class="comment">/*</span></div>
<div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;<span class="comment"> * Defines in-memory structs for the basic file-format objects in the</span></div>
<div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;<span class="comment"> * CRAM format.</span></div>
<div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;<span class="comment"> *</span></div>
<div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;<span class="comment"> * The basic file format is:</span></div>
<div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;<span class="comment"> *     File-def SAM-hdr Container Container ...</span></div>
<div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;<span class="comment"> *</span></div>
<div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;<span class="comment"> * Container:</span></div>
<div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;<span class="comment"> *     Service-block data-block data-block ...</span></div>
<div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;<span class="comment"> *</span></div>
<div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;<span class="comment"> * Multiple blocks in a container are grouped together as slices,</span></div>
<div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;<span class="comment"> * also sometimes referred to as landmarks in the spec.</span></div>
<div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;<span class="comment"> */</span></div>
<div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;</div>
<div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;</div>
<div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;<span class="preprocessor">#include &lt;stdint.h&gt;</span></div>
<div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;</div>
<div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="thread__pool_8h.html">cram/thread_pool.h</a>&quot;</span></div>
<div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;</div>
<div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;<span class="preprocessor">#ifdef SAMTOOLS</span></div>
<div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;<span class="preprocessor"></span><span class="comment">// From within samtools/HTSlib</span></div>
<div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;<span class="preprocessor">#  include &quot;<a class="code" href="string__alloc_8h.html">cram/string_alloc.h</a>&quot;</span></div>
<div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;<span class="preprocessor">#  include &quot;<a class="code" href="khash_8h.html">htslib/khash.h</a>&quot;</span></div>
<div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;</div>
<div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;<span class="comment">// Generic hash-map integer -&gt; integer</span></div>
<div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;<a class="code" href="khash_8h.html#ae4272644f2e011a3a69d814056246125">KHASH_MAP_INIT_INT</a>(m_i2i, <span class="keywordtype">int</span>)</div>
<div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;</div>
<div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;<span class="comment">// Generic hash-set integer -&gt; (existance)</span></div>
<div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;<a class="code" href="khash_8h.html#a2d99965972be994f02464d6992575e83">KHASH_SET_INIT_INT</a>(s_i2i)</div>
<div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;</div>
<div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;<span class="comment">// For brevity</span></div>
<div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;typedef <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> uc;</div>
<div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;</div>
<div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;<span class="comment">/*</span></div>
<div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;<span class="comment"> * A union for the preservation map. Required for khash.</span></div>
<div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;<span class="comment"> */</span></div>
<div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;typedef union {</div>
<div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;    <span class="keywordtype">int</span> i;</div>
<div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;    <span class="keywordtype">char</span> *p;</div>
<div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;} pmap_t;</div>
<div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;</div>
<div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;<span class="comment">// Generates static functions here which isn&#39;t ideal, but we have no way</span></div>
<div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;<span class="comment">// currently to declare the kh_map_t structure here without also declaring a</span></div>
<div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;<span class="comment">// duplicate in the .c files due to the nature of the KHASH macros.</span></div>
<div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;<a class="code" href="khash_8h.html#a296c6de6bacb01ad7565979ac15a68c2">KHASH_MAP_INIT_STR</a>(<a class="code" href="group___mapping.html#gad30b05e1249763bbda8b4745c92a42ae">map</a>, pmap_t)</div>
<div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;</div>
<div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;struct <a class="code" href="structh_f_i_l_e.html">hFILE</a>;</div>
<div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;typedef struct hFILE <a class="code" href="cram__structs_8h.html#ae89ef453a84c7efb414039d3c093a4e5">cram_FILE</a>;</div>
<div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;</div>
<div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;<span class="preprocessor">#else</span></div>
<div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;<span class="preprocessor"></span><span class="comment">// From within io_lib</span></div>
<div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;<span class="preprocessor">#  include &quot;cram/bam.h&quot;</span>              <span class="comment">// For BAM header parsing</span></div>
<div class="line"><a name="l00090"></a><span class="lineno"><a class="code" href="cram__structs_8h.html#ae89ef453a84c7efb414039d3c093a4e5">   90</a></span>&#160;<span class="keyword">typedef</span> FILE <a class="code" href="cram__structs_8h.html#ae89ef453a84c7efb414039d3c093a4e5">cram_FILE</a>;</div>
<div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;<span class="preprocessor"></span></div>
<div class="line"><a name="l00093"></a><span class="lineno"><a class="code" href="cram__structs_8h.html#a83fadad644c8088321735301699d6963">   93</a></span>&#160;<span class="preprocessor">#define SEQS_PER_SLICE 10000</span></div>
<div class="line"><a name="l00094"></a><span class="lineno"><a class="code" href="cram__structs_8h.html#a7a15eecf3f5da1fb81d7cf19028c31e0">   94</a></span>&#160;<span class="preprocessor"></span><span class="preprocessor">#define SLICE_PER_CNT  1</span></div>
<div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;<span class="preprocessor"></span></div>
<div class="line"><a name="l00096"></a><span class="lineno"><a class="code" href="cram__structs_8h.html#af1d697dd8863d256e62b8a66373ea22a">   96</a></span>&#160;<span class="preprocessor">#define CRAM_SUBST_MATRIX &quot;CGTNAGTNACTNACGNACGT&quot;</span></div>
<div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;<span class="preprocessor"></span></div>
<div class="line"><a name="l00098"></a><span class="lineno"><a class="code" href="cram__structs_8h.html#a72f3fa20036a156badf7087fccfbdd60">   98</a></span>&#160;<span class="preprocessor">#define TN_external</span></div>
<div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;<span class="preprocessor"></span><span class="comment">//#define NS_external</span></div>
<div class="line"><a name="l00100"></a><span class="lineno"><a class="code" href="cram__structs_8h.html#afdc4d90fdd0c6b4638e18be15d8a2691">  100</a></span>&#160;<span class="preprocessor">#define TS_external</span></div>
<div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;<span class="preprocessor"></span><span class="comment">//#define BA_external</span></div>
<div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;</div>
<div class="line"><a name="l00103"></a><span class="lineno"><a class="code" href="cram__structs_8h.html#a24c9fd089645bd2f96e7576f743d43aa">  103</a></span>&#160;<span class="preprocessor">#define MAX_STAT_VAL 1024</span></div>
<div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;<span class="preprocessor"></span><span class="comment">//#define MAX_STAT_VAL 16</span></div>
<div class="line"><a name="l00105"></a><span class="lineno"><a class="code" href="structcram__stats.html">  105</a></span>&#160;<span class="keyword">typedef</span> <span class="keyword">struct </span>{</div>
<div class="line"><a name="l00106"></a><span class="lineno"><a class="code" href="structcram__stats.html#a69f7f57f316acb73de90f42cab8780ce">  106</a></span>&#160;    <span class="keywordtype">int</span> freqs[<a class="code" href="cram__structs_8h.html#a24c9fd089645bd2f96e7576f743d43aa">MAX_STAT_VAL</a>];</div>
<div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;    <a class="code" href="khash_8h.html#a918655286199787582304265cd9d4463">khash_t</a>(m_i2i) *h;</div>
<div class="line"><a name="l00108"></a><span class="lineno"><a class="code" href="structcram__stats.html#a8fea71ab4d6e1d62bea43d9933dfd711">  108</a></span>&#160;    <span class="keywordtype">int</span> <a class="code" href="structcram__stats.html#a8fea71ab4d6e1d62bea43d9933dfd711">nsamp</a>; <span class="comment">// total number of values added</span></div>
<div class="line"><a name="l00109"></a><span class="lineno"><a class="code" href="structcram__stats.html#a67334dd789495e8f2741e15e29a6da00">  109</a></span>&#160;    <span class="keywordtype">int</span> <a class="code" href="structcram__stats.html#a67334dd789495e8f2741e15e29a6da00">nvals</a>; <span class="comment">// total number of unique values added</span></div>
<div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;} <a class="code" href="structcram__stats.html">cram_stats</a>;</div>
<div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;</div>
<div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;<span class="comment">/* NB: matches java impl, not the spec */</span></div>
<div class="line"><a name="l00113"></a><span class="lineno"><a class="code" href="cram__structs_8h.html#a2c60912ab219d52f6bf975af078eb4fa">  113</a></span>&#160;<span class="keyword">enum</span> <a class="code" href="cram__structs_8h.html#a2c60912ab219d52f6bf975af078eb4fa">cram_encoding</a> {</div>
<div class="line"><a name="l00114"></a><span class="lineno"><a class="code" href="cram__structs_8h.html#a2c60912ab219d52f6bf975af078eb4faa2a6afdc758f2735134a4917131e8d441">  114</a></span>&#160;    <a class="code" href="cram__structs_8h.html#a2c60912ab219d52f6bf975af078eb4faa2a6afdc758f2735134a4917131e8d441">E_NULL</a>               = 0,</div>
<div class="line"><a name="l00115"></a><span class="lineno"><a class="code" href="cram__structs_8h.html#a2c60912ab219d52f6bf975af078eb4faa60169a7d774741c4ab3db203325008d9">  115</a></span>&#160;    <a class="code" href="cram__structs_8h.html#a2c60912ab219d52f6bf975af078eb4faa60169a7d774741c4ab3db203325008d9">E_EXTERNAL</a>           = 1,</div>
<div class="line"><a name="l00116"></a><span class="lineno"><a class="code" href="cram__structs_8h.html#a2c60912ab219d52f6bf975af078eb4faaccf00e6ab05b7ea9ab2c2a01e291f545">  116</a></span>&#160;    <a class="code" href="cram__structs_8h.html#a2c60912ab219d52f6bf975af078eb4faaccf00e6ab05b7ea9ab2c2a01e291f545">E_GOLOMB</a>             = 2,</div>
<div class="line"><a name="l00117"></a><span class="lineno"><a class="code" href="cram__structs_8h.html#a2c60912ab219d52f6bf975af078eb4faa716ffec6b163c6ec0d6abf2d0a1517e5">  117</a></span>&#160;    <a class="code" href="cram__structs_8h.html#a2c60912ab219d52f6bf975af078eb4faa716ffec6b163c6ec0d6abf2d0a1517e5">E_HUFFMAN</a>            = 3,</div>
<div class="line"><a name="l00118"></a><span class="lineno"><a class="code" href="cram__structs_8h.html#a2c60912ab219d52f6bf975af078eb4faaf2297f36837fc4d55d8b2bd3fbbaa26b">  118</a></span>&#160;    <a class="code" href="cram__structs_8h.html#a2c60912ab219d52f6bf975af078eb4faaf2297f36837fc4d55d8b2bd3fbbaa26b">E_BYTE_ARRAY_LEN</a>     = 4,</div>
<div class="line"><a name="l00119"></a><span class="lineno"><a class="code" href="cram__structs_8h.html#a2c60912ab219d52f6bf975af078eb4faa2d8eac36f58e42d47728cd31d6dda89a">  119</a></span>&#160;    <a class="code" href="cram__structs_8h.html#a2c60912ab219d52f6bf975af078eb4faa2d8eac36f58e42d47728cd31d6dda89a">E_BYTE_ARRAY_STOP</a>    = 5,</div>
<div class="line"><a name="l00120"></a><span class="lineno"><a class="code" href="cram__structs_8h.html#a2c60912ab219d52f6bf975af078eb4faa8868681921a657b993c96a29826faacd">  120</a></span>&#160;    <a class="code" href="cram__structs_8h.html#a2c60912ab219d52f6bf975af078eb4faa8868681921a657b993c96a29826faacd">E_BETA</a>               = 6,</div>
<div class="line"><a name="l00121"></a><span class="lineno"><a class="code" href="cram__structs_8h.html#a2c60912ab219d52f6bf975af078eb4faafd21774998b9930bee197001b5f7b756">  121</a></span>&#160;    <a class="code" href="cram__structs_8h.html#a2c60912ab219d52f6bf975af078eb4faafd21774998b9930bee197001b5f7b756">E_SUBEXP</a>             = 7,</div>
<div class="line"><a name="l00122"></a><span class="lineno"><a class="code" href="cram__structs_8h.html#a2c60912ab219d52f6bf975af078eb4faa320aae50adfad3f5d55abb2e5f197e93">  122</a></span>&#160;    <a class="code" href="cram__structs_8h.html#a2c60912ab219d52f6bf975af078eb4faa320aae50adfad3f5d55abb2e5f197e93">E_GOLOMB_RICE</a>        = 8,</div>
<div class="line"><a name="l00123"></a><span class="lineno"><a class="code" href="cram__structs_8h.html#a2c60912ab219d52f6bf975af078eb4faa983afd05f25b301b8b7371b79dd3f113">  123</a></span>&#160;    <a class="code" href="cram__structs_8h.html#a2c60912ab219d52f6bf975af078eb4faa983afd05f25b301b8b7371b79dd3f113">E_GAMMA</a>              = 9</div>
<div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;};</div>
<div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;</div>
<div class="line"><a name="l00126"></a><span class="lineno"><a class="code" href="cram__structs_8h.html#a0ef7e3936f6c847006846b629e2738ec">  126</a></span>&#160;<span class="keyword">enum</span> <a class="code" href="cram__structs_8h.html#a0ef7e3936f6c847006846b629e2738ec">cram_external_type</a> {</div>
<div class="line"><a name="l00127"></a><span class="lineno"><a class="code" href="cram__structs_8h.html#a0ef7e3936f6c847006846b629e2738eca5306277aad551e0d1b56650782592c76">  127</a></span>&#160;    <a class="code" href="cram__structs_8h.html#a0ef7e3936f6c847006846b629e2738eca5306277aad551e0d1b56650782592c76">E_INT</a>                = 1,</div>
<div class="line"><a name="l00128"></a><span class="lineno"><a class="code" href="cram__structs_8h.html#a0ef7e3936f6c847006846b629e2738eca280c304351c7c60453fefde18087184f">  128</a></span>&#160;    <a class="code" href="cram__structs_8h.html#a0ef7e3936f6c847006846b629e2738eca280c304351c7c60453fefde18087184f">E_LONG</a>               = 2,</div>
<div class="line"><a name="l00129"></a><span class="lineno"><a class="code" href="cram__structs_8h.html#a0ef7e3936f6c847006846b629e2738ecabf0498d15b7968316cc122f7e66122c8">  129</a></span>&#160;    <a class="code" href="cram__structs_8h.html#a0ef7e3936f6c847006846b629e2738ecabf0498d15b7968316cc122f7e66122c8">E_BYTE</a>               = 3,</div>
<div class="line"><a name="l00130"></a><span class="lineno"><a class="code" href="cram__structs_8h.html#a0ef7e3936f6c847006846b629e2738eca2cc6da7f4e3fba67662e800987d570e1">  130</a></span>&#160;    <a class="code" href="cram__structs_8h.html#a0ef7e3936f6c847006846b629e2738eca2cc6da7f4e3fba67662e800987d570e1">E_BYTE_ARRAY</a>         = 4,</div>
<div class="line"><a name="l00131"></a><span class="lineno"><a class="code" href="cram__structs_8h.html#a0ef7e3936f6c847006846b629e2738eca735a36d9f8e7f64a3de4ef03d5480491">  131</a></span>&#160;    <a class="code" href="cram__structs_8h.html#a0ef7e3936f6c847006846b629e2738eca735a36d9f8e7f64a3de4ef03d5480491">E_BYTE_ARRAY_BLOCK</a>   = 5,</div>
<div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;};</div>
<div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;</div>
<div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;<span class="comment">/* &quot;File Definition Structure&quot; */</span></div>
<div class="line"><a name="l00135"></a><span class="lineno"><a class="code" href="structcram__file__def.html">  135</a></span>&#160;<span class="keyword">typedef</span> <span class="keyword">struct </span>{</div>
<div class="line"><a name="l00136"></a><span class="lineno"><a class="code" href="structcram__file__def.html#a23884c15ebbd4f1c202e96bc45c9362e">  136</a></span>&#160;    <span class="keywordtype">char</span>    magic[4];</div>
<div class="line"><a name="l00137"></a><span class="lineno"><a class="code" href="structcram__file__def.html#af034aa4fe247bc3de72fc7b3723a0055">  137</a></span>&#160;    <a class="code" href="kstdint_8h.html#aba7bc1797add20fe3efdf37ced1182c5">uint8_t</a> <a class="code" href="structcram__file__def.html#af034aa4fe247bc3de72fc7b3723a0055">major_version</a>;</div>
<div class="line"><a name="l00138"></a><span class="lineno"><a class="code" href="structcram__file__def.html#aa8922a7485c16b077d45107ec264b33b">  138</a></span>&#160;    <a class="code" href="kstdint_8h.html#aba7bc1797add20fe3efdf37ced1182c5">uint8_t</a> <a class="code" href="structcram__file__def.html#aa8922a7485c16b077d45107ec264b33b">minor_version</a>;</div>
<div class="line"><a name="l00139"></a><span class="lineno"><a class="code" href="structcram__file__def.html#a83a665d14695436ddd3449b62942b917">  139</a></span>&#160;    <span class="keywordtype">char</span>    file_id[20];      <span class="comment">// Filename or SHA1 checksum</span></div>
<div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;} <a class="code" href="structcram__file__def.html">cram_file_def</a>;</div>
<div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;</div>
<div class="line"><a name="l00142"></a><span class="lineno"><a class="code" href="cram__structs_8h.html#a77396b9650e6fbbc186ecb8153948c85">  142</a></span>&#160;<span class="preprocessor">#define CRAM_1_VERS 100 // 1.0</span></div>
<div class="line"><a name="l00143"></a><span class="lineno"><a class="code" href="cram__structs_8h.html#a43e4acef81d2547610be03d1100e2daf">  143</a></span>&#160;<span class="preprocessor"></span><span class="preprocessor">#define CRAM_2_VERS 200 // 1.1, or 2.0?</span></div>
<div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;<span class="preprocessor"></span></div>
<div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;<span class="keyword">struct </span><a class="code" href="structcram__slice.html">cram_slice</a>;</div>
<div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;</div>
<div class="line"><a name="l00147"></a><span class="lineno"><a class="code" href="cram__structs_8h.html#aaba757c9ea23fabb284dc002713c30a5">  147</a></span>&#160;<span class="keyword">enum</span> <a class="code" href="cram__structs_8h.html#aaba757c9ea23fabb284dc002713c30a5">cram_block_method</a> {</div>
<div class="line"><a name="l00148"></a><span class="lineno"><a class="code" href="cram__structs_8h.html#aaba757c9ea23fabb284dc002713c30a5a88101b6cb7e050019872d39148eaaba9">  148</a></span>&#160;    <a class="code" href="cram__structs_8h.html#aaba757c9ea23fabb284dc002713c30a5a88101b6cb7e050019872d39148eaaba9">BM_ERROR</a> = -1,</div>
<div class="line"><a name="l00149"></a><span class="lineno"><a class="code" href="cram__structs_8h.html#aaba757c9ea23fabb284dc002713c30a5abdeded99fe7d3f2773014a9a2cfb73d7">  149</a></span>&#160;    <a class="code" href="cram__structs_8h.html#aaba757c9ea23fabb284dc002713c30a5abdeded99fe7d3f2773014a9a2cfb73d7">RAW</a>   = 0,</div>
<div class="line"><a name="l00150"></a><span class="lineno"><a class="code" href="cram__structs_8h.html#aaba757c9ea23fabb284dc002713c30a5a388483cd14bd349b3e0f2a7511bbec0e">  150</a></span>&#160;    <a class="code" href="cram__structs_8h.html#aaba757c9ea23fabb284dc002713c30a5a388483cd14bd349b3e0f2a7511bbec0e">GZIP</a>  = 1,</div>
<div class="line"><a name="l00151"></a><span class="lineno"><a class="code" href="cram__structs_8h.html#aaba757c9ea23fabb284dc002713c30a5af072cbd4765483ae305ca479f7764031">  151</a></span>&#160;    <a class="code" href="cram__structs_8h.html#aaba757c9ea23fabb284dc002713c30a5af072cbd4765483ae305ca479f7764031">BZIP2</a> = 2,</div>
<div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;};</div>
<div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;</div>
<div class="line"><a name="l00154"></a><span class="lineno"><a class="code" href="cram__structs_8h.html#af9934fb23b7763e058c4dfb074ce9a49">  154</a></span>&#160;<span class="keyword">enum</span> <a class="code" href="cram__structs_8h.html#af9934fb23b7763e058c4dfb074ce9a49">cram_content_type</a> {</div>
<div class="line"><a name="l00155"></a><span class="lineno"><a class="code" href="cram__structs_8h.html#af9934fb23b7763e058c4dfb074ce9a49a953dc74397e2314430158ffa33f2ec0a">  155</a></span>&#160;    <a class="code" href="cram__structs_8h.html#af9934fb23b7763e058c4dfb074ce9a49a953dc74397e2314430158ffa33f2ec0a">CT_ERROR</a>           = -1,</div>
<div class="line"><a name="l00156"></a><span class="lineno"><a class="code" href="cram__structs_8h.html#af9934fb23b7763e058c4dfb074ce9a49ae266ed1a6756405c884f41b322438cd5">  156</a></span>&#160;    <a class="code" href="cram__structs_8h.html#af9934fb23b7763e058c4dfb074ce9a49ae266ed1a6756405c884f41b322438cd5">FILE_HEADER</a>        = 0,</div>
<div class="line"><a name="l00157"></a><span class="lineno"><a class="code" href="cram__structs_8h.html#af9934fb23b7763e058c4dfb074ce9a49a2e2b585e9729f519f2df9d64ba20a4f7">  157</a></span>&#160;    <a class="code" href="cram__structs_8h.html#af9934fb23b7763e058c4dfb074ce9a49a2e2b585e9729f519f2df9d64ba20a4f7">COMPRESSION_HEADER</a> = 1,</div>
<div class="line"><a name="l00158"></a><span class="lineno"><a class="code" href="cram__structs_8h.html#af9934fb23b7763e058c4dfb074ce9a49acbab9e6ab1d4b600b6abd78d67741906">  158</a></span>&#160;    <a class="code" href="cram__structs_8h.html#af9934fb23b7763e058c4dfb074ce9a49acbab9e6ab1d4b600b6abd78d67741906">MAPPED_SLICE</a>       = 2,</div>
<div class="line"><a name="l00159"></a><span class="lineno"><a class="code" href="cram__structs_8h.html#af9934fb23b7763e058c4dfb074ce9a49a418fd0738333d78848bb983a2047e1d7">  159</a></span>&#160;    <a class="code" href="cram__structs_8h.html#af9934fb23b7763e058c4dfb074ce9a49a418fd0738333d78848bb983a2047e1d7">UNMAPPED_SLICE</a>     = 3, <span class="comment">// CRAM_1_VERS only</span></div>
<div class="line"><a name="l00160"></a><span class="lineno"><a class="code" href="cram__structs_8h.html#af9934fb23b7763e058c4dfb074ce9a49a63fbb9fe7b9a695d3a65541465cb99d5">  160</a></span>&#160;    <a class="code" href="cram__structs_8h.html#af9934fb23b7763e058c4dfb074ce9a49a63fbb9fe7b9a695d3a65541465cb99d5">EXTERNAL</a>           = 4,</div>
<div class="line"><a name="l00161"></a><span class="lineno"><a class="code" href="cram__structs_8h.html#af9934fb23b7763e058c4dfb074ce9a49a6fb62912f795482b5e8a28aded6b02e9">  161</a></span>&#160;    <a class="code" href="cram__structs_8h.html#af9934fb23b7763e058c4dfb074ce9a49a6fb62912f795482b5e8a28aded6b02e9">CORE</a>               = 5,</div>
<div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;};</div>
<div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;</div>
<div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;<span class="comment">/* Compression metrics */</span></div>
<div class="line"><a name="l00165"></a><span class="lineno"><a class="code" href="structcram__metrics.html">  165</a></span>&#160;<span class="keyword">typedef</span> <span class="keyword">struct </span>{</div>
<div class="line"><a name="l00166"></a><span class="lineno"><a class="code" href="structcram__metrics.html#a3ded4c27fd2e6373702e2850dc98c616">  166</a></span>&#160;    <span class="keywordtype">int</span> <a class="code" href="structcram__metrics.html#a3ded4c27fd2e6373702e2850dc98c616">m1</a>;</div>
<div class="line"><a name="l00167"></a><span class="lineno"><a class="code" href="structcram__metrics.html#a5fbe0c6b13794101d5458e4f1d9e1233">  167</a></span>&#160;    <span class="keywordtype">int</span> <a class="code" href="structcram__metrics.html#a5fbe0c6b13794101d5458e4f1d9e1233">m2</a>;</div>
<div class="line"><a name="l00168"></a><span class="lineno"><a class="code" href="structcram__metrics.html#a4752cdf7e1271eaf5afd33b09414293a">  168</a></span>&#160;    <span class="keywordtype">int</span> <a class="code" href="structcram__metrics.html#a4752cdf7e1271eaf5afd33b09414293a">trial</a>;</div>
<div class="line"><a name="l00169"></a><span class="lineno"><a class="code" href="structcram__metrics.html#a630d067e323e90845fd2bde0ea02a8a3">  169</a></span>&#160;    <span class="keywordtype">int</span> <a class="code" href="structcram__metrics.html#a630d067e323e90845fd2bde0ea02a8a3">next_trial</a>;</div>
<div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;} <a class="code" href="structcram__metrics.html">cram_metrics</a>;</div>
<div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;</div>
<div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;<span class="comment">/* Block */</span></div>
<div class="line"><a name="l00173"></a><span class="lineno"><a class="code" href="structcram__block.html">  173</a></span>&#160;<span class="keyword">typedef</span> <span class="keyword">struct </span>{</div>
<div class="line"><a name="l00174"></a><span class="lineno"><a class="code" href="structcram__block.html#a8b8394d5916108d365160683edf5c2cb">  174</a></span>&#160;    <span class="keyword">enum</span> <a class="code" href="cram__structs_8h.html#aaba757c9ea23fabb284dc002713c30a5">cram_block_method</a>  method, orig_method;</div>
<div class="line"><a name="l00175"></a><span class="lineno"><a class="code" href="structcram__block.html#a3991da04cf33bfa496e778e74c78a0b9">  175</a></span>&#160;    <span class="keyword">enum</span> <a class="code" href="cram__structs_8h.html#af9934fb23b7763e058c4dfb074ce9a49">cram_content_type</a>  content_type;</div>
<div class="line"><a name="l00176"></a><span class="lineno"><a class="code" href="structcram__block.html#a29deffa408ae9409f158ca17de53bfbe">  176</a></span>&#160;    <a class="code" href="kstdint_8h.html#a2ba621978a511250f7250fb10e05ffbe">int32_t</a>  <a class="code" href="structcram__block.html#a29deffa408ae9409f158ca17de53bfbe">content_id</a>;</div>
<div class="line"><a name="l00177"></a><span class="lineno"><a class="code" href="structcram__block.html#a0fafe2f42ecaac8b243cbdc4032dcef7">  177</a></span>&#160;    <a class="code" href="kstdint_8h.html#a2ba621978a511250f7250fb10e05ffbe">int32_t</a>  <a class="code" href="structcram__block.html#a0fafe2f42ecaac8b243cbdc4032dcef7">comp_size</a>;</div>
<div class="line"><a name="l00178"></a><span class="lineno"><a class="code" href="structcram__block.html#aa0764cf09bf2a5d5608901ace42215c8">  178</a></span>&#160;    <a class="code" href="kstdint_8h.html#a2ba621978a511250f7250fb10e05ffbe">int32_t</a>  <a class="code" href="structcram__block.html#aa0764cf09bf2a5d5608901ace42215c8">uncomp_size</a>;</div>
<div class="line"><a name="l00179"></a><span class="lineno"><a class="code" href="structcram__block.html#ae00eec4cd97cbf917755298f13a31d34">  179</a></span>&#160;    <a class="code" href="kstdint_8h.html#a2ba621978a511250f7250fb10e05ffbe">int32_t</a>  <a class="code" href="structcram__block.html#ae00eec4cd97cbf917755298f13a31d34">idx</a>; <span class="comment">/* offset into data */</span></div>
<div class="line"><a name="l00180"></a><span class="lineno"><a class="code" href="structcram__block.html#ab404a5dfd61f0a40cc91f670109c55f4">  180</a></span>&#160;    <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span>    *<a class="code" href="structcram__block.html#ab404a5dfd61f0a40cc91f670109c55f4">data</a>;</div>
<div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;</div>
<div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;    <span class="comment">// For bit I/O</span></div>
<div class="line"><a name="l00183"></a><span class="lineno"><a class="code" href="structcram__block.html#a6251dbd92425fedfa8846d98b38c3f25">  183</a></span>&#160;    <span class="keywordtype">size_t</span> <a class="code" href="structcram__block.html#a6251dbd92425fedfa8846d98b38c3f25">alloc</a>;</div>
<div class="line"><a name="l00184"></a><span class="lineno"><a class="code" href="structcram__block.html#a662d767787dd16168ed38628f9285b79">  184</a></span>&#160;    <span class="keywordtype">size_t</span> <a class="code" href="structcram__block.html#a662d767787dd16168ed38628f9285b79">byte</a>;</div>
<div class="line"><a name="l00185"></a><span class="lineno"><a class="code" href="structcram__block.html#a8d2096320913845e375a9fd4bc7d3a3e">  185</a></span>&#160;    <span class="keywordtype">int</span> <a class="code" href="structcram__block.html#a8d2096320913845e375a9fd4bc7d3a3e">bit</a>;</div>
<div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;} <a class="code" href="structcram__block.html">cram_block</a>;</div>
<div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;</div>
<div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;<span class="keyword">struct </span><a class="code" href="structcram__codec.html">cram_codec</a>; <span class="comment">/* defined in cram_codecs.h */</span></div>
<div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;<span class="keyword">struct </span><a class="code" href="structcram__map.html">cram_map</a>;</div>
<div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;</div>
<div class="line"><a name="l00191"></a><span class="lineno"><a class="code" href="cram__structs_8h.html#a4000ef4e5246a3e9cc030c26ac1730d1">  191</a></span>&#160;<span class="preprocessor">#define CRAM_MAP_HASH 32</span></div>
<div class="line"><a name="l00192"></a><span class="lineno"><a class="code" href="cram__structs_8h.html#a57169b5d763076ed50f8c910d25bac4b">  192</a></span>&#160;<span class="preprocessor"></span><span class="preprocessor">#define CRAM_MAP(a,b) (((a)*3+(b))&amp;(CRAM_MAP_HASH-1))</span></div>
<div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;<span class="preprocessor"></span></div>
<div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;<span class="comment">/* Compression header block */</span></div>
<div class="line"><a name="l00195"></a><span class="lineno"><a class="code" href="structcram__block__compression__hdr.html">  195</a></span>&#160;<span class="keyword">typedef</span> <span class="keyword">struct </span>{</div>
<div class="line"><a name="l00196"></a><span class="lineno"><a class="code" href="structcram__block__compression__hdr.html#a8ec580454d5e5c68098fdb1adf3b8030">  196</a></span>&#160;    <a class="code" href="kstdint_8h.html#a2ba621978a511250f7250fb10e05ffbe">int32_t</a> <a class="code" href="structcram__block__compression__hdr.html#a8ec580454d5e5c68098fdb1adf3b8030">ref_seq_id</a>;</div>
<div class="line"><a name="l00197"></a><span class="lineno"><a class="code" href="structcram__block__compression__hdr.html#a09646eb28e62dcdd76d2043cb3586481">  197</a></span>&#160;    <a class="code" href="kstdint_8h.html#a2ba621978a511250f7250fb10e05ffbe">int32_t</a> <a class="code" href="structcram__block__compression__hdr.html#a09646eb28e62dcdd76d2043cb3586481">ref_seq_start</a>;</div>
<div class="line"><a name="l00198"></a><span class="lineno"><a class="code" href="structcram__block__compression__hdr.html#a25869f15e14d37c85a666fb827886647">  198</a></span>&#160;    <a class="code" href="kstdint_8h.html#a2ba621978a511250f7250fb10e05ffbe">int32_t</a> <a class="code" href="structcram__block__compression__hdr.html#a25869f15e14d37c85a666fb827886647">ref_seq_span</a>;</div>
<div class="line"><a name="l00199"></a><span class="lineno"><a class="code" href="structcram__block__compression__hdr.html#a2008dec90bd121c22141a28711b20ac4">  199</a></span>&#160;    <a class="code" href="kstdint_8h.html#a2ba621978a511250f7250fb10e05ffbe">int32_t</a> <a class="code" href="structcram__block__compression__hdr.html#a2008dec90bd121c22141a28711b20ac4">num_records</a>;</div>
<div class="line"><a name="l00200"></a><span class="lineno"><a class="code" href="structcram__block__compression__hdr.html#a5d51d9e1829141aeea22c9ed41d7397f">  200</a></span>&#160;    <a class="code" href="kstdint_8h.html#a2ba621978a511250f7250fb10e05ffbe">int32_t</a> <a class="code" href="structcram__block__compression__hdr.html#a5d51d9e1829141aeea22c9ed41d7397f">num_landmarks</a>;</div>
<div class="line"><a name="l00201"></a><span class="lineno"><a class="code" href="structcram__block__compression__hdr.html#a6e3673ac66a4a0ff35bc9251b73c840d">  201</a></span>&#160;    <a class="code" href="kstdint_8h.html#a2ba621978a511250f7250fb10e05ffbe">int32_t</a> *<a class="code" href="structcram__block__compression__hdr.html#a6e3673ac66a4a0ff35bc9251b73c840d">landmark</a>;</div>
<div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;</div>
<div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;    <span class="comment">/* Flags from preservation map */</span></div>
<div class="line"><a name="l00204"></a><span class="lineno"><a class="code" href="structcram__block__compression__hdr.html#a7b798e971979777ef44018aeb0534502">  204</a></span>&#160;    <span class="keywordtype">int</span> <a class="code" href="structcram__block__compression__hdr.html#a7b798e971979777ef44018aeb0534502">mapped_qs_included</a>;</div>
<div class="line"><a name="l00205"></a><span class="lineno"><a class="code" href="structcram__block__compression__hdr.html#a1a5ad0c956b8f209d04116f12a0416d1">  205</a></span>&#160;    <span class="keywordtype">int</span> <a class="code" href="structcram__block__compression__hdr.html#a1a5ad0c956b8f209d04116f12a0416d1">unmapped_qs_included</a>;</div>
<div class="line"><a name="l00206"></a><span class="lineno"><a class="code" href="structcram__block__compression__hdr.html#a8e44e082b4de132added3df5230324d9">  206</a></span>&#160;    <span class="keywordtype">int</span> <a class="code" href="structcram__block__compression__hdr.html#a8e44e082b4de132added3df5230324d9">unmapped_placed</a>;</div>
<div class="line"><a name="l00207"></a><span class="lineno"><a class="code" href="structcram__block__compression__hdr.html#ae9b65f35c1609c36b42b3747c209a382">  207</a></span>&#160;    <span class="keywordtype">int</span> <a class="code" href="structcram__block__compression__hdr.html#ae9b65f35c1609c36b42b3747c209a382">qs_included</a>;</div>
<div class="line"><a name="l00208"></a><span class="lineno"><a class="code" href="structcram__block__compression__hdr.html#a3b42444377b907fb24ae85fee919b521">  208</a></span>&#160;    <span class="keywordtype">int</span> <a class="code" href="structcram__block__compression__hdr.html#a3b42444377b907fb24ae85fee919b521">read_names_included</a>;</div>
<div class="line"><a name="l00209"></a><span class="lineno"><a class="code" href="structcram__block__compression__hdr.html#ab4f1faba4a3941aafa24e2b190dbe919">  209</a></span>&#160;    <span class="keywordtype">int</span> <a class="code" href="structcram__block__compression__hdr.html#ab4f1faba4a3941aafa24e2b190dbe919">AP_delta</a>;</div>
<div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;    <span class="comment">// indexed by ref-base and subst. code</span></div>
<div class="line"><a name="l00211"></a><span class="lineno"><a class="code" href="structcram__block__compression__hdr.html#aec394e27b082b9b27aa036d9d6b923b6">  211</a></span>&#160;    <span class="keywordtype">char</span> substitution_matrix[5][4];</div>
<div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;</div>
<div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;    <span class="comment">// TD Dictionary as a concatenated block</span></div>
<div class="line"><a name="l00214"></a><span class="lineno"><a class="code" href="structcram__block__compression__hdr.html#a5f0f342374a892aea862d681ef2a50ef">  214</a></span>&#160;    <a class="code" href="structcram__block.html">cram_block</a> *<a class="code" href="structcram__block__compression__hdr.html#a5f0f342374a892aea862d681ef2a50ef">TD_blk</a>;          <span class="comment">// Tag Dictionary</span></div>
<div class="line"><a name="l00215"></a><span class="lineno"><a class="code" href="structcram__block__compression__hdr.html#a258e97062f300fb30933a30873bd2557">  215</a></span>&#160;    <span class="keywordtype">int</span> <a class="code" href="structcram__block__compression__hdr.html#a258e97062f300fb30933a30873bd2557">nTL</a>;                     <span class="comment">// number of TL entries in TD</span></div>
<div class="line"><a name="l00216"></a><span class="lineno"><a class="code" href="structcram__block__compression__hdr.html#a34c40fbac1573238feca8a4ba265458b">  216</a></span>&#160;    <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> **<a class="code" href="structcram__block__compression__hdr.html#a34c40fbac1573238feca8a4ba265458b">TL</a>;          <span class="comment">// array of size nTL, pointer into TD_blk.</span></div>
<div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;    <a class="code" href="khash_8h.html#a918655286199787582304265cd9d4463">khash_t</a>(m_s2i) *TD_hash;     <span class="comment">// Keyed on TD strings, map to TL[] indices</span></div>
<div class="line"><a name="l00218"></a><span class="lineno"><a class="code" href="structcram__block__compression__hdr.html#a28d319baf7005fd77b649881b257be87">  218</a></span>&#160;    <a class="code" href="structstring__alloc__t.html">string_alloc_t</a> *<a class="code" href="structcram__block__compression__hdr.html#a28d319baf7005fd77b649881b257be87">TD_keys</a>;     <span class="comment">// Pooled keys for TD hash.</span></div>
<div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;    </div>
<div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;    <a class="code" href="khash_8h.html#a918655286199787582304265cd9d4463">khash_t</a>(<a class="code" href="group___mapping.html#gad30b05e1249763bbda8b4745c92a42ae">map</a>) *preservation_map;</div>
<div class="line"><a name="l00221"></a><span class="lineno"><a class="code" href="structcram__block__compression__hdr.html#ab46d7c9f316d3f555dc01240194f3c70">  221</a></span>&#160;    <span class="keyword">struct </span><a class="code" href="structcram__map.html">cram_map</a> *rec_encoding_map[<a class="code" href="cram__structs_8h.html#a4000ef4e5246a3e9cc030c26ac1730d1">CRAM_MAP_HASH</a>];</div>
<div class="line"><a name="l00222"></a><span class="lineno"><a class="code" href="structcram__block__compression__hdr.html#aef84c4931febc2ed9ad409bdc5fe7414">  222</a></span>&#160;    <span class="keyword">struct </span><a class="code" href="structcram__map.html">cram_map</a> *tag_encoding_map[<a class="code" href="cram__structs_8h.html#a4000ef4e5246a3e9cc030c26ac1730d1">CRAM_MAP_HASH</a>];</div>
<div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;</div>
<div class="line"><a name="l00224"></a><span class="lineno"><a class="code" href="structcram__block__compression__hdr.html#a82839bce324070e0f09b014a51ab217a">  224</a></span>&#160;    <span class="keyword">struct </span><a class="code" href="structcram__codec.html">cram_codec</a> *<a class="code" href="structcram__block__compression__hdr.html#a82839bce324070e0f09b014a51ab217a">BF_codec</a>; <span class="comment">// bam bit flags</span></div>
<div class="line"><a name="l00225"></a><span class="lineno"><a class="code" href="structcram__block__compression__hdr.html#ac9769072c8b032b760f16d62b8035865">  225</a></span>&#160;    <span class="keyword">struct </span><a class="code" href="structcram__codec.html">cram_codec</a> *<a class="code" href="structcram__block__compression__hdr.html#ac9769072c8b032b760f16d62b8035865">CF_codec</a>; <span class="comment">// compression flags</span></div>
<div class="line"><a name="l00226"></a><span class="lineno"><a class="code" href="structcram__block__compression__hdr.html#a98fdcebd8e258ff10b39658a1385b8a7">  226</a></span>&#160;    <span class="keyword">struct </span><a class="code" href="structcram__codec.html">cram_codec</a> *<a class="code" href="structcram__block__compression__hdr.html#a98fdcebd8e258ff10b39658a1385b8a7">RL_codec</a>; <span class="comment">// read length</span></div>
<div class="line"><a name="l00227"></a><span class="lineno"><a class="code" href="structcram__block__compression__hdr.html#aeef84d8e3bd8444b93ce0cbf3d568c70">  227</a></span>&#160;    <span class="keyword">struct </span><a class="code" href="structcram__codec.html">cram_codec</a> *<a class="code" href="structcram__block__compression__hdr.html#aeef84d8e3bd8444b93ce0cbf3d568c70">AP_codec</a>; <span class="comment">// alignment pos</span></div>
<div class="line"><a name="l00228"></a><span class="lineno"><a class="code" href="structcram__block__compression__hdr.html#a36d11272aee8114ef6543cfe883a0b77">  228</a></span>&#160;    <span class="keyword">struct </span><a class="code" href="structcram__codec.html">cram_codec</a> *<a class="code" href="structcram__block__compression__hdr.html#a36d11272aee8114ef6543cfe883a0b77">RG_codec</a>; <span class="comment">// read group</span></div>
<div class="line"><a name="l00229"></a><span class="lineno"><a class="code" href="structcram__block__compression__hdr.html#ae8f455c67210c6ba7e2dda6dca76cbea">  229</a></span>&#160;    <span class="keyword">struct </span><a class="code" href="structcram__codec.html">cram_codec</a> *<a class="code" href="structcram__block__compression__hdr.html#ae8f455c67210c6ba7e2dda6dca76cbea">MF_codec</a>; <span class="comment">// mate flags</span></div>
<div class="line"><a name="l00230"></a><span class="lineno"><a class="code" href="structcram__block__compression__hdr.html#aed0a319e976ef38ce94a003a8f9e5fbc">  230</a></span>&#160;    <span class="keyword">struct </span><a class="code" href="structcram__codec.html">cram_codec</a> *<a class="code" href="structcram__block__compression__hdr.html#aed0a319e976ef38ce94a003a8f9e5fbc">NS_codec</a>; <span class="comment">// next frag ref ID</span></div>
<div class="line"><a name="l00231"></a><span class="lineno"><a class="code" href="structcram__block__compression__hdr.html#a8ec34d109a7e6051f30c0f12e8d8f15f">  231</a></span>&#160;    <span class="keyword">struct </span><a class="code" href="structcram__codec.html">cram_codec</a> *<a class="code" href="structcram__block__compression__hdr.html#a8ec34d109a7e6051f30c0f12e8d8f15f">NP_codec</a>; <span class="comment">// next frag pos</span></div>
<div class="line"><a name="l00232"></a><span class="lineno"><a class="code" href="structcram__block__compression__hdr.html#a38b6cb02160b04eabb10c4ef6969f953">  232</a></span>&#160;    <span class="keyword">struct </span><a class="code" href="structcram__codec.html">cram_codec</a> *<a class="code" href="structcram__block__compression__hdr.html#a38b6cb02160b04eabb10c4ef6969f953">TS_codec</a>; <span class="comment">// template size</span></div>
<div class="line"><a name="l00233"></a><span class="lineno"><a class="code" href="structcram__block__compression__hdr.html#a702311b4d985a138d580a350b4d7d25d">  233</a></span>&#160;    <span class="keyword">struct </span><a class="code" href="structcram__codec.html">cram_codec</a> *<a class="code" href="structcram__block__compression__hdr.html#a702311b4d985a138d580a350b4d7d25d">NF_codec</a>; <span class="comment">// next frag distance</span></div>
<div class="line"><a name="l00234"></a><span class="lineno"><a class="code" href="structcram__block__compression__hdr.html#a3259edfc71e168c4204853a97594c52a">  234</a></span>&#160;    <span class="keyword">struct </span><a class="code" href="structcram__codec.html">cram_codec</a> *<a class="code" href="structcram__block__compression__hdr.html#a3259edfc71e168c4204853a97594c52a">TC_codec</a>; <span class="comment">// tag count      CRAM_1_VERS</span></div>
<div class="line"><a name="l00235"></a><span class="lineno"><a class="code" href="structcram__block__compression__hdr.html#a1534ef2e8ea623b5343a818af8af6b37">  235</a></span>&#160;    <span class="keyword">struct </span><a class="code" href="structcram__codec.html">cram_codec</a> *<a class="code" href="structcram__block__compression__hdr.html#a1534ef2e8ea623b5343a818af8af6b37">TN_codec</a>; <span class="comment">// tag name/type  CRAM_1_VERS</span></div>
<div class="line"><a name="l00236"></a><span class="lineno"><a class="code" href="structcram__block__compression__hdr.html#af4dac8cc4f3ea9c4f5d4304f750a2802">  236</a></span>&#160;    <span class="keyword">struct </span><a class="code" href="structcram__codec.html">cram_codec</a> *<a class="code" href="structcram__block__compression__hdr.html#af4dac8cc4f3ea9c4f5d4304f750a2802">TL_codec</a>; <span class="comment">// tag line       CRAM_2_VERS</span></div>
<div class="line"><a name="l00237"></a><span class="lineno"><a class="code" href="structcram__block__compression__hdr.html#af3e291d1397c7a39a2618780248cac87">  237</a></span>&#160;    <span class="keyword">struct </span><a class="code" href="structcram__codec.html">cram_codec</a> *<a class="code" href="structcram__block__compression__hdr.html#af3e291d1397c7a39a2618780248cac87">FN_codec</a>; <span class="comment">// no. features</span></div>
<div class="line"><a name="l00238"></a><span class="lineno"><a class="code" href="structcram__block__compression__hdr.html#a0c75a7a322163e24458edc6b420720b1">  238</a></span>&#160;    <span class="keyword">struct </span><a class="code" href="structcram__codec.html">cram_codec</a> *<a class="code" href="structcram__block__compression__hdr.html#a0c75a7a322163e24458edc6b420720b1">FC_codec</a>; <span class="comment">// feature code</span></div>
<div class="line"><a name="l00239"></a><span class="lineno"><a class="code" href="structcram__block__compression__hdr.html#a11d0da026ae06433c051faf967220144">  239</a></span>&#160;    <span class="keyword">struct </span><a class="code" href="structcram__codec.html">cram_codec</a> *<a class="code" href="structcram__block__compression__hdr.html#a11d0da026ae06433c051faf967220144">FP_codec</a>; <span class="comment">// feature pos</span></div>
<div class="line"><a name="l00240"></a><span class="lineno"><a class="code" href="structcram__block__compression__hdr.html#a3735a9db61d24c53a91276248c9082fd">  240</a></span>&#160;    <span class="keyword">struct </span><a class="code" href="structcram__codec.html">cram_codec</a> *<a class="code" href="structcram__block__compression__hdr.html#a3735a9db61d24c53a91276248c9082fd">BS_codec</a>; <span class="comment">// base subst feature</span></div>
<div class="line"><a name="l00241"></a><span class="lineno"><a class="code" href="structcram__block__compression__hdr.html#a58176b13f916c3d05c891e41d07ba35c">  241</a></span>&#160;    <span class="keyword">struct </span><a class="code" href="structcram__codec.html">cram_codec</a> *<a class="code" href="structcram__block__compression__hdr.html#a58176b13f916c3d05c891e41d07ba35c">IN_codec</a>; <span class="comment">// insertion feature</span></div>
<div class="line"><a name="l00242"></a><span class="lineno"><a class="code" href="structcram__block__compression__hdr.html#ad074dc90caf077397472cf1e41f2d55f">  242</a></span>&#160;    <span class="keyword">struct </span><a class="code" href="structcram__codec.html">cram_codec</a> *<a class="code" href="structcram__block__compression__hdr.html#ad074dc90caf077397472cf1e41f2d55f">SC_codec</a>; <span class="comment">// soft-clip feature</span></div>
<div class="line"><a name="l00243"></a><span class="lineno"><a class="code" href="structcram__block__compression__hdr.html#a5a4ae99148cdc17dff793f16cc6e99a1">  243</a></span>&#160;    <span class="keyword">struct </span><a class="code" href="structcram__codec.html">cram_codec</a> *<a class="code" href="structcram__block__compression__hdr.html#a5a4ae99148cdc17dff793f16cc6e99a1">DL_codec</a>; <span class="comment">// deletion len feature</span></div>
<div class="line"><a name="l00244"></a><span class="lineno"><a class="code" href="structcram__block__compression__hdr.html#a165136480ec95ff0e39a87d7bfb0a216">  244</a></span>&#160;    <span class="keyword">struct </span><a class="code" href="structcram__codec.html">cram_codec</a> *<a class="code" href="structcram__block__compression__hdr.html#a165136480ec95ff0e39a87d7bfb0a216">BA_codec</a>; <span class="comment">// base feature</span></div>
<div class="line"><a name="l00245"></a><span class="lineno"><a class="code" href="structcram__block__compression__hdr.html#a42c733fc5f78d18dee9ce16d5e642f92">  245</a></span>&#160;    <span class="keyword">struct </span><a class="code" href="structcram__codec.html">cram_codec</a> *<a class="code" href="structcram__block__compression__hdr.html#a42c733fc5f78d18dee9ce16d5e642f92">RS_codec</a>; <span class="comment">// ref skip length feature</span></div>
<div class="line"><a name="l00246"></a><span class="lineno"><a class="code" href="structcram__block__compression__hdr.html#a98bf2fc7936d09eb909fd081b90645c8">  246</a></span>&#160;    <span class="keyword">struct </span><a class="code" href="structcram__codec.html">cram_codec</a> *<a class="code" href="structcram__block__compression__hdr.html#a98bf2fc7936d09eb909fd081b90645c8">PD_codec</a>; <span class="comment">// padding length feature</span></div>
<div class="line"><a name="l00247"></a><span class="lineno"><a class="code" href="structcram__block__compression__hdr.html#ab48272e8c95de9b0ba1234605ff874f0">  247</a></span>&#160;    <span class="keyword">struct </span><a class="code" href="structcram__codec.html">cram_codec</a> *<a class="code" href="structcram__block__compression__hdr.html#ab48272e8c95de9b0ba1234605ff874f0">HC_codec</a>; <span class="comment">// hard clip length feature</span></div>
<div class="line"><a name="l00248"></a><span class="lineno"><a class="code" href="structcram__block__compression__hdr.html#a408ba4aef88bd63e1ada956d596566ec">  248</a></span>&#160;    <span class="keyword">struct </span><a class="code" href="structcram__codec.html">cram_codec</a> *<a class="code" href="structcram__block__compression__hdr.html#a408ba4aef88bd63e1ada956d596566ec">MQ_codec</a>; <span class="comment">// mapping quality</span></div>
<div class="line"><a name="l00249"></a><span class="lineno"><a class="code" href="structcram__block__compression__hdr.html#a471e0b0c6dc2850a9ed5dec6e7803b41">  249</a></span>&#160;    <span class="keyword">struct </span><a class="code" href="structcram__codec.html">cram_codec</a> *<a class="code" href="structcram__block__compression__hdr.html#a471e0b0c6dc2850a9ed5dec6e7803b41">RN_codec</a>; <span class="comment">// read names</span></div>
<div class="line"><a name="l00250"></a><span class="lineno"><a class="code" href="structcram__block__compression__hdr.html#a59624c5fea2eb5f6dfb10edc09fa03e8">  250</a></span>&#160;    <span class="keyword">struct </span><a class="code" href="structcram__codec.html">cram_codec</a> *<a class="code" href="structcram__block__compression__hdr.html#a59624c5fea2eb5f6dfb10edc09fa03e8">QS_codec</a>; <span class="comment">// quality value (single)</span></div>
<div class="line"><a name="l00251"></a><span class="lineno"><a class="code" href="structcram__block__compression__hdr.html#aedd66c3848d905ca752a0fcfb3735b32">  251</a></span>&#160;    <span class="keyword">struct </span><a class="code" href="structcram__codec.html">cram_codec</a> *<a class="code" href="structcram__block__compression__hdr.html#aedd66c3848d905ca752a0fcfb3735b32">Qs_codec</a>; <span class="comment">// quality values (string)</span></div>
<div class="line"><a name="l00252"></a><span class="lineno"><a class="code" href="structcram__block__compression__hdr.html#acc3321e3aebae2d117b34714453a6293">  252</a></span>&#160;    <span class="keyword">struct </span><a class="code" href="structcram__codec.html">cram_codec</a> *<a class="code" href="structcram__block__compression__hdr.html#acc3321e3aebae2d117b34714453a6293">RI_codec</a>; <span class="comment">// ref ID</span></div>
<div class="line"><a name="l00253"></a><span class="lineno"><a class="code" href="structcram__block__compression__hdr.html#ae5aa6b844c6617478a807f4933b8ea83">  253</a></span>&#160;    <span class="keyword">struct </span><a class="code" href="structcram__codec.html">cram_codec</a> *<a class="code" href="structcram__block__compression__hdr.html#ae5aa6b844c6617478a807f4933b8ea83">TM_codec</a>; <span class="comment">// ?</span></div>
<div class="line"><a name="l00254"></a><span class="lineno"><a class="code" href="structcram__block__compression__hdr.html#a2799f16cfbe8579f395a1423f241f8c7">  254</a></span>&#160;    <span class="keyword">struct </span><a class="code" href="structcram__codec.html">cram_codec</a> *<a class="code" href="structcram__block__compression__hdr.html#a2799f16cfbe8579f395a1423f241f8c7">TV_codec</a>; <span class="comment">// ?</span></div>
<div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;</div>
<div class="line"><a name="l00256"></a><span class="lineno"><a class="code" href="structcram__block__compression__hdr.html#a3a05b92b31cd076acc1953d8b9e09dbf">  256</a></span>&#160;    <span class="keywordtype">char</span> *<a class="code" href="structcram__block__compression__hdr.html#a3a05b92b31cd076acc1953d8b9e09dbf">uncomp</a>; <span class="comment">// A single block of uncompressed data</span></div>
<div class="line"><a name="l00257"></a><span class="lineno"><a class="code" href="structcram__block__compression__hdr.html#a43db9d23c369f725c278ba113e0dcf76">  257</a></span>&#160;    <span class="keywordtype">size_t</span> <a class="code" href="structcram__block__compression__hdr.html#a43db9d23c369f725c278ba113e0dcf76">uncomp_size</a>, uncomp_alloc;</div>
<div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;} <a class="code" href="structcram__block__compression__hdr.html">cram_block_compression_hdr</a>;</div>
<div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;</div>
<div class="line"><a name="l00260"></a><span class="lineno"><a class="code" href="structcram__map.html">  260</a></span>&#160;<span class="keyword">typedef</span> <span class="keyword">struct </span><a class="code" href="structcram__map.html">cram_map</a> {</div>
<div class="line"><a name="l00261"></a><span class="lineno"><a class="code" href="structcram__map.html#afa14b725584a0ff0467d01d0104f5b1b">  261</a></span>&#160;    <span class="keywordtype">int</span> <a class="code" href="structcram__map.html#afa14b725584a0ff0467d01d0104f5b1b">key</a>;    <span class="comment">/* 0xe0 + 3 bytes */</span></div>
<div class="line"><a name="l00262"></a><span class="lineno"><a class="code" href="structcram__map.html#a89c1d2a0e3cc2278340206ec3fc99a17">  262</a></span>&#160;    <span class="keyword">enum</span> <a class="code" href="cram__structs_8h.html#a2c60912ab219d52f6bf975af078eb4fa">cram_encoding</a> <a class="code" href="structcram__map.html#a89c1d2a0e3cc2278340206ec3fc99a17">encoding</a>;</div>
<div class="line"><a name="l00263"></a><span class="lineno"><a class="code" href="structcram__map.html#a787cc85f0b6e20470439022057bf3714">  263</a></span>&#160;    <span class="keywordtype">int</span> <a class="code" href="structcram__map.html#a787cc85f0b6e20470439022057bf3714">offset</a>; <span class="comment">/* Offset into a single block of memory */</span></div>
<div class="line"><a name="l00264"></a><span class="lineno"><a class="code" href="structcram__map.html#afb89c5bbaf94dfe963517d1be92f901e">  264</a></span>&#160;    <span class="keywordtype">int</span> <a class="code" href="structcram__map.html#afb89c5bbaf94dfe963517d1be92f901e">size</a>;   <span class="comment">/* Size */</span></div>
<div class="line"><a name="l00265"></a><span class="lineno"><a class="code" href="structcram__map.html#a398e14a14534e3ffe9b84889777b3e73">  265</a></span>&#160;    <span class="keyword">struct </span><a class="code" href="structcram__codec.html">cram_codec</a> *<a class="code" href="structcram__map.html#a398e14a14534e3ffe9b84889777b3e73">codec</a>;</div>
<div class="line"><a name="l00266"></a><span class="lineno"><a class="code" href="structcram__map.html#aeeb96b890de50ea014145a013f92fa7e">  266</a></span>&#160;    <span class="keyword">struct </span><a class="code" href="structcram__map.html">cram_map</a> *<a class="code" href="structcram__map.html#aeeb96b890de50ea014145a013f92fa7e">next</a>; <span class="comment">// for noddy internal hash</span></div>
<div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;} <a class="code" href="cram__structs_8h.html#abc73e1b7e70eeabd92201f4905cfe16d">cram_map</a>;</div>
<div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;</div>
<div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;<span class="comment">/* Mapped or unmapped slice header block */</span></div>
<div class="line"><a name="l00270"></a><span class="lineno"><a class="code" href="structcram__block__slice__hdr.html">  270</a></span>&#160;<span class="keyword">typedef</span> <span class="keyword">struct </span>{</div>
<div class="line"><a name="l00271"></a><span class="lineno"><a class="code" href="structcram__block__slice__hdr.html#ad3e94a85ee7a6448cbb1f430e5d8f724">  271</a></span>&#160;    <span class="keyword">enum</span> <a class="code" href="cram__structs_8h.html#af9934fb23b7763e058c4dfb074ce9a49">cram_content_type</a> content_type;</div>
<div class="line"><a name="l00272"></a><span class="lineno"><a class="code" href="structcram__block__slice__hdr.html#ab1bcef8dace23844dc476451534ea799">  272</a></span>&#160;    <a class="code" href="kstdint_8h.html#a2ba621978a511250f7250fb10e05ffbe">int32_t</a> <a class="code" href="structcram__block__slice__hdr.html#ab1bcef8dace23844dc476451534ea799">ref_seq_id</a>;     <span class="comment">/* if content_type == MAPPED_SLICE */</span></div>
<div class="line"><a name="l00273"></a><span class="lineno"><a class="code" href="structcram__block__slice__hdr.html#a596cf649b20df985c8f7a39fdf58593a">  273</a></span>&#160;    <a class="code" href="kstdint_8h.html#a2ba621978a511250f7250fb10e05ffbe">int32_t</a> <a class="code" href="structcram__block__slice__hdr.html#a596cf649b20df985c8f7a39fdf58593a">ref_seq_start</a>;  <span class="comment">/* if content_type == MAPPED_SLICE */</span></div>
<div class="line"><a name="l00274"></a><span class="lineno"><a class="code" href="structcram__block__slice__hdr.html#acf002fea922a57df9e78d3df243c29fa">  274</a></span>&#160;    <a class="code" href="kstdint_8h.html#a2ba621978a511250f7250fb10e05ffbe">int32_t</a> <a class="code" href="structcram__block__slice__hdr.html#acf002fea922a57df9e78d3df243c29fa">ref_seq_span</a>;   <span class="comment">/* if content_type == MAPPED_SLICE */</span></div>
<div class="line"><a name="l00275"></a><span class="lineno"><a class="code" href="structcram__block__slice__hdr.html#a0b721c91a98c4a806f565e015b762d43">  275</a></span>&#160;    <a class="code" href="kstdint_8h.html#a2ba621978a511250f7250fb10e05ffbe">int32_t</a> <a class="code" href="structcram__block__slice__hdr.html#a0b721c91a98c4a806f565e015b762d43">num_records</a>;</div>
<div class="line"><a name="l00276"></a><span class="lineno"><a class="code" href="structcram__block__slice__hdr.html#a7d119babc4285902cb7b3def83f48bde">  276</a></span>&#160;    <a class="code" href="kstdint_8h.html#a2ba621978a511250f7250fb10e05ffbe">int32_t</a> <a class="code" href="structcram__block__slice__hdr.html#a7d119babc4285902cb7b3def83f48bde">record_counter</a>;</div>
<div class="line"><a name="l00277"></a><span class="lineno"><a class="code" href="structcram__block__slice__hdr.html#af9a07ad7ec46085139a6731b198831e7">  277</a></span>&#160;    <a class="code" href="kstdint_8h.html#a2ba621978a511250f7250fb10e05ffbe">int32_t</a> <a class="code" href="structcram__block__slice__hdr.html#af9a07ad7ec46085139a6731b198831e7">num_blocks</a>;</div>
<div class="line"><a name="l00278"></a><span class="lineno"><a class="code" href="structcram__block__slice__hdr.html#ad50686035ee6215e383a97210cf01b42">  278</a></span>&#160;    <a class="code" href="kstdint_8h.html#a2ba621978a511250f7250fb10e05ffbe">int32_t</a> <a class="code" href="structcram__block__slice__hdr.html#ad50686035ee6215e383a97210cf01b42">num_content_ids</a>;</div>
<div class="line"><a name="l00279"></a><span class="lineno"><a class="code" href="structcram__block__slice__hdr.html#a76097cfe20f1388d464f968c89ba1d25">  279</a></span>&#160;    <a class="code" href="kstdint_8h.html#a2ba621978a511250f7250fb10e05ffbe">int32_t</a> *<a class="code" href="structcram__block__slice__hdr.html#a76097cfe20f1388d464f968c89ba1d25">block_content_ids</a>;</div>
<div class="line"><a name="l00280"></a><span class="lineno"><a class="code" href="structcram__block__slice__hdr.html#ab5b0cf6b40365e0c6c21403c8c6feb4a">  280</a></span>&#160;    <a class="code" href="kstdint_8h.html#a2ba621978a511250f7250fb10e05ffbe">int32_t</a> <a class="code" href="structcram__block__slice__hdr.html#ab5b0cf6b40365e0c6c21403c8c6feb4a">ref_base_id</a>;    <span class="comment">/* if content_type == MAPPED_SLICE */</span></div>
<div class="line"><a name="l00281"></a><span class="lineno"><a class="code" href="structcram__block__slice__hdr.html#ac000d1f8278296d5553a6f63e7e048df">  281</a></span>&#160;    <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> md5[16];</div>
<div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;} <a class="code" href="structcram__block__slice__hdr.html">cram_block_slice_hdr</a>;</div>
<div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;</div>
<div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;<span class="keyword">struct </span><a class="code" href="structref__entry.html">ref_entry</a>;</div>
<div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;</div>
<div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;<span class="comment">/*</span></div>
<div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;<span class="comment"> * Container.</span></div>
<div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;<span class="comment"> *</span></div>
<div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;<span class="comment"> * Conceptually a container is split into slices, and slices into blocks.</span></div>
<div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;<span class="comment"> * However on disk it&#39;s just a list of blocks and we need to query the</span></div>
<div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;<span class="comment"> * block types to identify the start/end points of the slices.</span></div>
<div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;<span class="comment"> *</span></div>
<div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;<span class="comment"> * OR... are landmarks the start/end points of slices?</span></div>
<div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;<span class="comment"> */</span></div>
<div class="line"><a name="l00295"></a><span class="lineno"><a class="code" href="structcram__container.html">  295</a></span>&#160;<span class="keyword">typedef</span> <span class="keyword">struct </span>{</div>
<div class="line"><a name="l00296"></a><span class="lineno"><a class="code" href="structcram__container.html#a7ef533d624862973464c520eed64f026">  296</a></span>&#160;    <a class="code" href="kstdint_8h.html#a2ba621978a511250f7250fb10e05ffbe">int32_t</a>  <a class="code" href="structcram__container.html#a7ef533d624862973464c520eed64f026">length</a>;</div>
<div class="line"><a name="l00297"></a><span class="lineno"><a class="code" href="structcram__container.html#a2b4d85df4e0894df50758d6b9ed27c14">  297</a></span>&#160;    <a class="code" href="kstdint_8h.html#a2ba621978a511250f7250fb10e05ffbe">int32_t</a>  <a class="code" href="structcram__container.html#a2b4d85df4e0894df50758d6b9ed27c14">ref_seq_id</a>;</div>
<div class="line"><a name="l00298"></a><span class="lineno"><a class="code" href="structcram__container.html#ac990c370f74af8570773942a7a409d44">  298</a></span>&#160;    <a class="code" href="kstdint_8h.html#a2ba621978a511250f7250fb10e05ffbe">int32_t</a>  <a class="code" href="structcram__container.html#ac990c370f74af8570773942a7a409d44">ref_seq_start</a>;</div>
<div class="line"><a name="l00299"></a><span class="lineno"><a class="code" href="structcram__container.html#a7a40d3970f80db307dd1fd79735d7182">  299</a></span>&#160;    <a class="code" href="kstdint_8h.html#a2ba621978a511250f7250fb10e05ffbe">int32_t</a>  <a class="code" href="structcram__container.html#a7a40d3970f80db307dd1fd79735d7182">ref_seq_span</a>;</div>
<div class="line"><a name="l00300"></a><span class="lineno"><a class="code" href="structcram__container.html#a95c0bc4eb96dd3a57254dd4b597683be">  300</a></span>&#160;    <a class="code" href="kstdint_8h.html#a2ba621978a511250f7250fb10e05ffbe">int32_t</a>  <a class="code" href="structcram__container.html#a95c0bc4eb96dd3a57254dd4b597683be">record_counter</a>;</div>
<div class="line"><a name="l00301"></a><span class="lineno"><a class="code" href="structcram__container.html#a0880099a90f576b8afb083bc048366e5">  301</a></span>&#160;    <a class="code" href="kstdint_8h.html#adec1df1b8b51cb32b77e5b86fff46471">int64_t</a>  <a class="code" href="structcram__container.html#a0880099a90f576b8afb083bc048366e5">num_bases</a>;</div>
<div class="line"><a name="l00302"></a><span class="lineno"><a class="code" href="structcram__container.html#a412a8b925470ebf4729e564056eac6a1">  302</a></span>&#160;    <a class="code" href="kstdint_8h.html#a2ba621978a511250f7250fb10e05ffbe">int32_t</a>  <a class="code" href="structcram__container.html#a412a8b925470ebf4729e564056eac6a1">num_records</a>;</div>
<div class="line"><a name="l00303"></a><span class="lineno"><a class="code" href="structcram__container.html#a44194e61ed36272d4edfab41cb9a1944">  303</a></span>&#160;    <a class="code" href="kstdint_8h.html#a2ba621978a511250f7250fb10e05ffbe">int32_t</a>  <a class="code" href="structcram__container.html#a44194e61ed36272d4edfab41cb9a1944">num_blocks</a>;</div>
<div class="line"><a name="l00304"></a><span class="lineno"><a class="code" href="structcram__container.html#a8ee5e5d225ed9d60d8d270a52943ff7d">  304</a></span>&#160;    <a class="code" href="kstdint_8h.html#a2ba621978a511250f7250fb10e05ffbe">int32_t</a>  <a class="code" href="structcram__container.html#a8ee5e5d225ed9d60d8d270a52943ff7d">num_landmarks</a>;</div>
<div class="line"><a name="l00305"></a><span class="lineno"><a class="code" href="structcram__container.html#a4ce67eaf6d7e317799b1f80a562543f6">  305</a></span>&#160;    <a class="code" href="kstdint_8h.html#a2ba621978a511250f7250fb10e05ffbe">int32_t</a> *<a class="code" href="structcram__container.html#a4ce67eaf6d7e317799b1f80a562543f6">landmark</a>;</div>
<div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;</div>
<div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;    <span class="comment">/* Size of container header above */</span></div>
<div class="line"><a name="l00308"></a><span class="lineno"><a class="code" href="structcram__container.html#a7a1eb412a5885f89b8d7b187072c6120">  308</a></span>&#160;    <span class="keywordtype">size_t</span>   <a class="code" href="structcram__container.html#a7a1eb412a5885f89b8d7b187072c6120">offset</a>;</div>
<div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160;    </div>
<div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;    <span class="comment">/* Compression header is always the first block? */</span></div>
<div class="line"><a name="l00311"></a><span class="lineno"><a class="code" href="structcram__container.html#a6394a0a19d212178dfdcab614e63f871">  311</a></span>&#160;    <a class="code" href="structcram__block__compression__hdr.html">cram_block_compression_hdr</a> *<a class="code" href="structcram__container.html#a6394a0a19d212178dfdcab614e63f871">comp_hdr</a>;</div>
<div class="line"><a name="l00312"></a><span class="lineno"><a class="code" href="structcram__container.html#a515a1d78cecd0ee0b5e49cac82ef3b24">  312</a></span>&#160;    <a class="code" href="structcram__block.html">cram_block</a> *<a class="code" href="structcram__container.html#a515a1d78cecd0ee0b5e49cac82ef3b24">comp_hdr_block</a>;</div>
<div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160;</div>
<div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160;    <span class="comment">/* For construction purposes */</span></div>
<div class="line"><a name="l00315"></a><span class="lineno"><a class="code" href="structcram__container.html#afbe93ab149487896d5eb08e1bf74cbef">  315</a></span>&#160;    <span class="keywordtype">int</span> <a class="code" href="structcram__container.html#afbe93ab149487896d5eb08e1bf74cbef">max_slice</a>, curr_slice;   <span class="comment">// maximum number of slices</span></div>
<div class="line"><a name="l00316"></a><span class="lineno"><a class="code" href="structcram__container.html#a7800c75b299d4f2c24ac2cce89df3efb">  316</a></span>&#160;    <span class="keywordtype">int</span> <a class="code" href="structcram__container.html#a7800c75b299d4f2c24ac2cce89df3efb">max_rec</a>, curr_rec;       <span class="comment">// current and max recs per slice</span></div>
<div class="line"><a name="l00317"></a><span class="lineno"><a class="code" href="structcram__container.html#ab27199eb29c7868da9ce55353fd5a432">  317</a></span>&#160;    <span class="keywordtype">int</span> <a class="code" href="structcram__container.html#ab27199eb29c7868da9ce55353fd5a432">max_c_rec</a>, curr_c_rec;   <span class="comment">// current and max recs per container</span></div>
<div class="line"><a name="l00318"></a><span class="lineno"><a class="code" href="structcram__container.html#a2ce3cc8d300a41c4a4366240355ed902">  318</a></span>&#160;    <span class="keywordtype">int</span> <a class="code" href="structcram__container.html#a2ce3cc8d300a41c4a4366240355ed902">slice_rec</a>;               <span class="comment">// rec no. for start of this slice</span></div>
<div class="line"><a name="l00319"></a><span class="lineno"><a class="code" href="structcram__container.html#a1ca8bdb2a01eaf19cc436a0b7c5a099a">  319</a></span>&#160;    <span class="keywordtype">int</span> <a class="code" href="structcram__container.html#a1ca8bdb2a01eaf19cc436a0b7c5a099a">curr_ref</a>;                <span class="comment">// current ref ID. -2 for no previous</span></div>
<div class="line"><a name="l00320"></a><span class="lineno"><a class="code" href="structcram__container.html#a02c2366eb9ee45489d772f8e1618f31d">  320</a></span>&#160;    <span class="keywordtype">int</span> <a class="code" href="structcram__container.html#a02c2366eb9ee45489d772f8e1618f31d">last_pos</a>;                <span class="comment">// last record position</span></div>
<div class="line"><a name="l00321"></a><span class="lineno"><a class="code" href="structcram__container.html#ad6d880581bc1c0e0c42283c3e5e47257">  321</a></span>&#160;    <span class="keyword">struct </span><a class="code" href="structcram__slice.html">cram_slice</a> **<a class="code" href="structcram__container.html#ad6d880581bc1c0e0c42283c3e5e47257">slices</a>, *slice;</div>
<div class="line"><a name="l00322"></a><span class="lineno"><a class="code" href="structcram__container.html#ac7cadba7a2616099355520d44a29eb22">  322</a></span>&#160;    <span class="keywordtype">int</span> <a class="code" href="structcram__container.html#ac7cadba7a2616099355520d44a29eb22">pos_sorted</a>;              <span class="comment">// boolean, 1=&gt;position sorted data</span></div>
<div class="line"><a name="l00323"></a><span class="lineno"><a class="code" href="structcram__container.html#a3b06ee22c564d71d927ff8ab528f7914">  323</a></span>&#160;    <span class="keywordtype">int</span> <a class="code" href="structcram__container.html#a3b06ee22c564d71d927ff8ab528f7914">max_apos</a>;                <span class="comment">// maximum position, used if pos_sorted==0</span></div>
<div class="line"><a name="l00324"></a><span class="lineno"><a class="code" href="structcram__container.html#a5fccd7c6d71b8864d84c7c1519e362fa">  324</a></span>&#160;    <span class="keywordtype">int</span> <a class="code" href="structcram__container.html#a5fccd7c6d71b8864d84c7c1519e362fa">last_slice</a>;              <span class="comment">// number of reads in last slice (0 for 1st)</span></div>
<div class="line"><a name="l00325"></a><span class="lineno"><a class="code" href="structcram__container.html#a4e0c67ac9c24adbc066a891863b1cc38">  325</a></span>&#160;    <span class="keywordtype">int</span> <a class="code" href="structcram__container.html#a4e0c67ac9c24adbc066a891863b1cc38">multi_seq</a>;               <span class="comment">// true if packing multi seqs per cont/slice</span></div>
<div class="line"><a name="l00326"></a><span class="lineno"><a class="code" href="structcram__container.html#a4164aa1e3f05cea1eb2834b7f46c3e1e">  326</a></span>&#160;    <span class="keywordtype">int</span> <a class="code" href="structcram__container.html#a4164aa1e3f05cea1eb2834b7f46c3e1e">unsorted</a>;                <span class="comment">// true is AP_delta is 0.</span></div>
<div class="line"><a name="l00327"></a><span class="lineno">  327</span>&#160;</div>
<div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160;    <span class="comment">/* Copied from fd before encoding, to allow multi-threading */</span></div>
<div class="line"><a name="l00329"></a><span class="lineno"><a class="code" href="structcram__container.html#a99d51f9b4dc0617573b8058cdcb44ad5">  329</a></span>&#160;    <span class="keywordtype">int</span> <a class="code" href="structcram__container.html#a99d51f9b4dc0617573b8058cdcb44ad5">ref_start</a>, first_base, last_base, <a class="code" href="structcram__slice.html#a08ae48585403a24df38a90241b698b8f">ref_id</a>, <a class="code" href="structcram__slice.html#ad04b00928bb9f827362a3cf262cda5ce">ref_end</a>;</div>
<div class="line"><a name="l00330"></a><span class="lineno"><a class="code" href="structcram__container.html#a2c0c5470a5c7c0ce95075c984518864c">  330</a></span>&#160;    <span class="keywordtype">char</span> *<a class="code" href="structcram__container.html#a2c0c5470a5c7c0ce95075c984518864c">ref</a>;</div>
<div class="line"><a name="l00331"></a><span class="lineno">  331</span>&#160;    <span class="comment">//struct ref_entry *ref;</span></div>
<div class="line"><a name="l00332"></a><span class="lineno">  332</span>&#160;</div>
<div class="line"><a name="l00333"></a><span class="lineno">  333</span>&#160;    <span class="comment">/* For multi-threading */</span></div>
<div class="line"><a name="l00334"></a><span class="lineno"><a class="code" href="structcram__container.html#a6fb1f981b14906001b8164bff4e469d7">  334</a></span>&#160;    <a class="code" href="structbam1__t.html">bam_seq_t</a> **<a class="code" href="structcram__container.html#a6fb1f981b14906001b8164bff4e469d7">bams</a>;</div>
<div class="line"><a name="l00335"></a><span class="lineno">  335</span>&#160;</div>
<div class="line"><a name="l00336"></a><span class="lineno">  336</span>&#160;    <span class="comment">/* Statistics for encoding */</span></div>
<div class="line"><a name="l00337"></a><span class="lineno"><a class="code" href="structcram__container.html#a55e842d06cdac9edc556ef71db538108">  337</a></span>&#160;    <a class="code" href="structcram__stats.html">cram_stats</a> *<a class="code" href="structcram__container.html#a55e842d06cdac9edc556ef71db538108">TS_stats</a>;</div>
<div class="line"><a name="l00338"></a><span class="lineno"><a class="code" href="structcram__container.html#a1bee53e4d2d2721bf4224d417ea3a5e1">  338</a></span>&#160;    <a class="code" href="structcram__stats.html">cram_stats</a> *<a class="code" href="structcram__container.html#a1bee53e4d2d2721bf4224d417ea3a5e1">RG_stats</a>;</div>
<div class="line"><a name="l00339"></a><span class="lineno"><a class="code" href="structcram__container.html#a6a3764a46a249b01aa5e5a7b00e8daaa">  339</a></span>&#160;    <a class="code" href="structcram__stats.html">cram_stats</a> *<a class="code" href="structcram__container.html#a6a3764a46a249b01aa5e5a7b00e8daaa">FP_stats</a>;</div>
<div class="line"><a name="l00340"></a><span class="lineno"><a class="code" href="structcram__container.html#a00b5b609a3d05de2f455a19a71758269">  340</a></span>&#160;    <a class="code" href="structcram__stats.html">cram_stats</a> *<a class="code" href="structcram__container.html#a00b5b609a3d05de2f455a19a71758269">NS_stats</a>;</div>
<div class="line"><a name="l00341"></a><span class="lineno"><a class="code" href="structcram__container.html#ad00c1ebe7ad8fe14e14e1c9dcca07f14">  341</a></span>&#160;    <a class="code" href="structcram__stats.html">cram_stats</a> *<a class="code" href="structcram__container.html#ad00c1ebe7ad8fe14e14e1c9dcca07f14">RN_stats</a>;</div>
<div class="line"><a name="l00342"></a><span class="lineno"><a class="code" href="structcram__container.html#a4cdc45a943499715e1104c479a09a4b6">  342</a></span>&#160;    <a class="code" href="structcram__stats.html">cram_stats</a> *<a class="code" href="structcram__container.html#a4cdc45a943499715e1104c479a09a4b6">CF_stats</a>;</div>
<div class="line"><a name="l00343"></a><span class="lineno"><a class="code" href="structcram__container.html#abd12acf928c1c2a6a5b10e11d1b7ffe9">  343</a></span>&#160;    <a class="code" href="structcram__stats.html">cram_stats</a> *<a class="code" href="structcram__container.html#abd12acf928c1c2a6a5b10e11d1b7ffe9">TN_stats</a>;</div>
<div class="line"><a name="l00344"></a><span class="lineno"><a class="code" href="structcram__container.html#aeed0b7504c06d94fedb7e216e826ed97">  344</a></span>&#160;    <a class="code" href="structcram__stats.html">cram_stats</a> *<a class="code" href="structcram__container.html#aeed0b7504c06d94fedb7e216e826ed97">BA_stats</a>;</div>
<div class="line"><a name="l00345"></a><span class="lineno"><a class="code" href="structcram__container.html#a0530dfeaa8d817ceb72a6fbd78870452">  345</a></span>&#160;    <a class="code" href="structcram__stats.html">cram_stats</a> *<a class="code" href="structcram__container.html#a0530dfeaa8d817ceb72a6fbd78870452">TV_stats</a>;</div>
<div class="line"><a name="l00346"></a><span class="lineno"><a class="code" href="structcram__container.html#af663195439cace7995b02d8b82f2a721">  346</a></span>&#160;    <a class="code" href="structcram__stats.html">cram_stats</a> *<a class="code" href="structcram__container.html#af663195439cace7995b02d8b82f2a721">BS_stats</a>;</div>
<div class="line"><a name="l00347"></a><span class="lineno"><a class="code" href="structcram__container.html#aa2c31251fe1187f54b8526d76379cc5b">  347</a></span>&#160;    <a class="code" href="structcram__stats.html">cram_stats</a> *<a class="code" href="structcram__container.html#aa2c31251fe1187f54b8526d76379cc5b">FC_stats</a>;</div>
<div class="line"><a name="l00348"></a><span class="lineno"><a class="code" href="structcram__container.html#a1c671b0e2925e765b00ca43424e98a09">  348</a></span>&#160;    <a class="code" href="structcram__stats.html">cram_stats</a> *<a class="code" href="structcram__container.html#a1c671b0e2925e765b00ca43424e98a09">BF_stats</a>;</div>
<div class="line"><a name="l00349"></a><span class="lineno"><a class="code" href="structcram__container.html#a61a27a5ff5c04471e81a402499545458">  349</a></span>&#160;    <a class="code" href="structcram__stats.html">cram_stats</a> *<a class="code" href="structcram__container.html#a61a27a5ff5c04471e81a402499545458">AP_stats</a>;</div>
<div class="line"><a name="l00350"></a><span class="lineno"><a class="code" href="structcram__container.html#aca69c9f58dd83f0a7df8e77c08e82931">  350</a></span>&#160;    <a class="code" href="structcram__stats.html">cram_stats</a> *<a class="code" href="structcram__container.html#aca69c9f58dd83f0a7df8e77c08e82931">NF_stats</a>;</div>
<div class="line"><a name="l00351"></a><span class="lineno"><a class="code" href="structcram__container.html#a25161882f52fb2335fc187d4ca94eb15">  351</a></span>&#160;    <a class="code" href="structcram__stats.html">cram_stats</a> *<a class="code" href="structcram__container.html#a25161882f52fb2335fc187d4ca94eb15">MF_stats</a>;</div>
<div class="line"><a name="l00352"></a><span class="lineno"><a class="code" href="structcram__container.html#adb169bcfa31ae890f3cd742b4394af86">  352</a></span>&#160;    <a class="code" href="structcram__stats.html">cram_stats</a> *<a class="code" href="structcram__container.html#adb169bcfa31ae890f3cd742b4394af86">FN_stats</a>;</div>
<div class="line"><a name="l00353"></a><span class="lineno"><a class="code" href="structcram__container.html#ae01d0c2e50835b2030788022f65df573">  353</a></span>&#160;    <a class="code" href="structcram__stats.html">cram_stats</a> *<a class="code" href="structcram__container.html#ae01d0c2e50835b2030788022f65df573">RL_stats</a>;</div>
<div class="line"><a name="l00354"></a><span class="lineno"><a class="code" href="structcram__container.html#a81c36cc10d33139f0a48eb1a3cd255d6">  354</a></span>&#160;    <a class="code" href="structcram__stats.html">cram_stats</a> *<a class="code" href="structcram__container.html#a81c36cc10d33139f0a48eb1a3cd255d6">DL_stats</a>;</div>
<div class="line"><a name="l00355"></a><span class="lineno"><a class="code" href="structcram__container.html#a2e7163eafaf4728852672f3bb77169c6">  355</a></span>&#160;    <a class="code" href="structcram__stats.html">cram_stats</a> *<a class="code" href="structcram__container.html#a2e7163eafaf4728852672f3bb77169c6">TC_stats</a>;</div>
<div class="line"><a name="l00356"></a><span class="lineno"><a class="code" href="structcram__container.html#aa8bee20f060f6fb3805a9893486a48c1">  356</a></span>&#160;    <a class="code" href="structcram__stats.html">cram_stats</a> *<a class="code" href="structcram__container.html#aa8bee20f060f6fb3805a9893486a48c1">TL_stats</a>;</div>
<div class="line"><a name="l00357"></a><span class="lineno"><a class="code" href="structcram__container.html#a0cf1ed9255c3dcd74ceb09153e5992a8">  357</a></span>&#160;    <a class="code" href="structcram__stats.html">cram_stats</a> *<a class="code" href="structcram__container.html#a0cf1ed9255c3dcd74ceb09153e5992a8">MQ_stats</a>;</div>
<div class="line"><a name="l00358"></a><span class="lineno"><a class="code" href="structcram__container.html#ac9aee21d3011a4c120fb89494caaf08a">  358</a></span>&#160;    <a class="code" href="structcram__stats.html">cram_stats</a> *<a class="code" href="structcram__container.html#ac9aee21d3011a4c120fb89494caaf08a">TM_stats</a>;</div>
<div class="line"><a name="l00359"></a><span class="lineno"><a class="code" href="structcram__container.html#a51869cdbc3a4274a7e7a5f2d28300150">  359</a></span>&#160;    <a class="code" href="structcram__stats.html">cram_stats</a> *<a class="code" href="structcram__container.html#a51869cdbc3a4274a7e7a5f2d28300150">QS_stats</a>;</div>
<div class="line"><a name="l00360"></a><span class="lineno"><a class="code" href="structcram__container.html#aaa8a8736a3f71f1b821150ff9f7ced42">  360</a></span>&#160;    <a class="code" href="structcram__stats.html">cram_stats</a> *<a class="code" href="structcram__container.html#aaa8a8736a3f71f1b821150ff9f7ced42">NP_stats</a>;</div>
<div class="line"><a name="l00361"></a><span class="lineno"><a class="code" href="structcram__container.html#a4fc4ed18609e05385bee5d95a7a295bc">  361</a></span>&#160;    <a class="code" href="structcram__stats.html">cram_stats</a> *<a class="code" href="structcram__container.html#a4fc4ed18609e05385bee5d95a7a295bc">RI_stats</a>;</div>
<div class="line"><a name="l00362"></a><span class="lineno"><a class="code" href="structcram__container.html#a5b2743a68a9741b7c269ca0c985a2aca">  362</a></span>&#160;    <a class="code" href="structcram__stats.html">cram_stats</a> *<a class="code" href="structcram__container.html#a5b2743a68a9741b7c269ca0c985a2aca">RS_stats</a>;</div>
<div class="line"><a name="l00363"></a><span class="lineno"><a class="code" href="structcram__container.html#abf0f273cbe199d6c6cad00955bf2de78">  363</a></span>&#160;    <a class="code" href="structcram__stats.html">cram_stats</a> *<a class="code" href="structcram__container.html#abf0f273cbe199d6c6cad00955bf2de78">PD_stats</a>;</div>
<div class="line"><a name="l00364"></a><span class="lineno"><a class="code" href="structcram__container.html#af8dcbaba44026b35fecbc235cafdfea8">  364</a></span>&#160;    <a class="code" href="structcram__stats.html">cram_stats</a> *<a class="code" href="structcram__container.html#af8dcbaba44026b35fecbc235cafdfea8">HC_stats</a>;</div>
<div class="line"><a name="l00365"></a><span class="lineno">  365</span>&#160;</div>
<div class="line"><a name="l00366"></a><span class="lineno">  366</span>&#160;    <a class="code" href="khash_8h.html#a918655286199787582304265cd9d4463">khash_t</a>(s_i2i) *tags_used; <span class="comment">// set of tag types in use, for tag encoding map</span></div>
<div class="line"><a name="l00367"></a><span class="lineno"><a class="code" href="structcram__container.html#acbee32a2fc81492a589b0b92c8e3ddb8">  367</a></span>&#160;    <span class="keywordtype">int</span> *<a class="code" href="structcram__container.html#acbee32a2fc81492a589b0b92c8e3ddb8">refs_used</a>;       <span class="comment">// array of frequency of ref seq IDs</span></div>
<div class="line"><a name="l00368"></a><span class="lineno">  368</span>&#160;} <a class="code" href="structcram__container.html">cram_container</a>;</div>
<div class="line"><a name="l00369"></a><span class="lineno">  369</span>&#160;</div>
<div class="line"><a name="l00370"></a><span class="lineno">  370</span>&#160;<span class="comment">/*</span></div>
<div class="line"><a name="l00371"></a><span class="lineno">  371</span>&#160;<span class="comment"> * A single cram record</span></div>
<div class="line"><a name="l00372"></a><span class="lineno">  372</span>&#160;<span class="comment"> */</span></div>
<div class="line"><a name="l00373"></a><span class="lineno"><a class="code" href="structcram__record.html">  373</a></span>&#160;<span class="keyword">typedef</span> <span class="keyword">struct </span>{</div>
<div class="line"><a name="l00374"></a><span class="lineno"><a class="code" href="structcram__record.html#af057c39da340804e58ec95f650ab5269">  374</a></span>&#160;    <span class="keyword">struct </span><a class="code" href="structcram__slice.html">cram_slice</a> *<a class="code" href="structcram__record.html#af057c39da340804e58ec95f650ab5269">s</a>; <span class="comment">// Filled out by cram_decode only</span></div>
<div class="line"><a name="l00375"></a><span class="lineno">  375</span>&#160;</div>
<div class="line"><a name="l00376"></a><span class="lineno"><a class="code" href="structcram__record.html#acfe1554637568bf6eb50eb588c1facd0">  376</a></span>&#160;    <a class="code" href="kstdint_8h.html#a2ba621978a511250f7250fb10e05ffbe">int32_t</a> <a class="code" href="structcram__record.html#acfe1554637568bf6eb50eb588c1facd0">ref_id</a>;       <span class="comment">// fixed for all recs in slice?</span></div>
<div class="line"><a name="l00377"></a><span class="lineno"><a class="code" href="structcram__record.html#aaa40424bf813940ef02f74e60f7b2810">  377</a></span>&#160;    <a class="code" href="kstdint_8h.html#a2ba621978a511250f7250fb10e05ffbe">int32_t</a> <a class="code" href="structcram__record.html#aaa40424bf813940ef02f74e60f7b2810">flags</a>;        <span class="comment">// BF</span></div>
<div class="line"><a name="l00378"></a><span class="lineno"><a class="code" href="structcram__record.html#a16b1cb980a95334f7853b1f40c95225a">  378</a></span>&#160;    <a class="code" href="kstdint_8h.html#a2ba621978a511250f7250fb10e05ffbe">int32_t</a> <a class="code" href="structcram__record.html#a16b1cb980a95334f7853b1f40c95225a">cram_flags</a>;   <span class="comment">// CF</span></div>
<div class="line"><a name="l00379"></a><span class="lineno"><a class="code" href="structcram__record.html#a453050ce405c322df2ec9e9c5857e5d3">  379</a></span>&#160;    <a class="code" href="kstdint_8h.html#a2ba621978a511250f7250fb10e05ffbe">int32_t</a> <a class="code" href="structcram__record.html#a453050ce405c322df2ec9e9c5857e5d3">len</a>;          <span class="comment">// RL</span></div>
<div class="line"><a name="l00380"></a><span class="lineno"><a class="code" href="structcram__record.html#a9446033659f27741fb5432ad18958113">  380</a></span>&#160;    <a class="code" href="kstdint_8h.html#a2ba621978a511250f7250fb10e05ffbe">int32_t</a> <a class="code" href="structcram__record.html#a9446033659f27741fb5432ad18958113">apos</a>;         <span class="comment">// AP</span></div>
<div class="line"><a name="l00381"></a><span class="lineno"><a class="code" href="structcram__record.html#a2e602e5cf66053e47f500e0300e3b23a">  381</a></span>&#160;    <a class="code" href="kstdint_8h.html#a2ba621978a511250f7250fb10e05ffbe">int32_t</a> <a class="code" href="structcram__record.html#a2e602e5cf66053e47f500e0300e3b23a">rg</a>;           <span class="comment">// RG</span></div>
<div class="line"><a name="l00382"></a><span class="lineno"><a class="code" href="structcram__record.html#a13448af98754487935ec60cc5cf78147">  382</a></span>&#160;    <a class="code" href="kstdint_8h.html#a2ba621978a511250f7250fb10e05ffbe">int32_t</a> <a class="code" href="structcram__record.html#a13448af98754487935ec60cc5cf78147">name</a>;         <span class="comment">// RN; idx to s-&gt;names_blk</span></div>
<div class="line"><a name="l00383"></a><span class="lineno"><a class="code" href="structcram__record.html#a5ffb6933f54517443783cb34cf45a097">  383</a></span>&#160;    <a class="code" href="kstdint_8h.html#a2ba621978a511250f7250fb10e05ffbe">int32_t</a> <a class="code" href="structcram__record.html#a5ffb6933f54517443783cb34cf45a097">name_len</a>;</div>
<div class="line"><a name="l00384"></a><span class="lineno"><a class="code" href="structcram__record.html#a9f5a19bad17aa8d9cc81d13d2dcd294d">  384</a></span>&#160;    <a class="code" href="kstdint_8h.html#a2ba621978a511250f7250fb10e05ffbe">int32_t</a> <a class="code" href="structcram__record.html#a9f5a19bad17aa8d9cc81d13d2dcd294d">mate_line</a>;    <span class="comment">// index to another cram_record</span></div>
<div class="line"><a name="l00385"></a><span class="lineno"><a class="code" href="structcram__record.html#a6d7f9918068ec5d42894d6d78b79b3f0">  385</a></span>&#160;    <a class="code" href="kstdint_8h.html#a2ba621978a511250f7250fb10e05ffbe">int32_t</a> <a class="code" href="structcram__record.html#a6d7f9918068ec5d42894d6d78b79b3f0">mate_ref_id</a>;</div>
<div class="line"><a name="l00386"></a><span class="lineno"><a class="code" href="structcram__record.html#a065f906f83f6ffb5e0e48fd10c34da5c">  386</a></span>&#160;    <a class="code" href="kstdint_8h.html#a2ba621978a511250f7250fb10e05ffbe">int32_t</a> <a class="code" href="structcram__record.html#a065f906f83f6ffb5e0e48fd10c34da5c">mate_pos</a>;     <span class="comment">// NP</span></div>
<div class="line"><a name="l00387"></a><span class="lineno"><a class="code" href="structcram__record.html#a7187fea0605dffc91ad2bd1be3aac6eb">  387</a></span>&#160;    <a class="code" href="kstdint_8h.html#a2ba621978a511250f7250fb10e05ffbe">int32_t</a> <a class="code" href="structcram__record.html#a7187fea0605dffc91ad2bd1be3aac6eb">tlen</a>;         <span class="comment">// TS</span></div>
<div class="line"><a name="l00388"></a><span class="lineno">  388</span>&#160;</div>
<div class="line"><a name="l00389"></a><span class="lineno">  389</span>&#160;    <span class="comment">// Auxiliary data</span></div>
<div class="line"><a name="l00390"></a><span class="lineno"><a class="code" href="structcram__record.html#aa970039d903b256892f91fb4cd297c7e">  390</a></span>&#160;    <a class="code" href="kstdint_8h.html#a2ba621978a511250f7250fb10e05ffbe">int32_t</a> <a class="code" href="structcram__record.html#aa970039d903b256892f91fb4cd297c7e">ntags</a>;        <span class="comment">// TC</span></div>
<div class="line"><a name="l00391"></a><span class="lineno"><a class="code" href="structcram__record.html#acf0313bec7295440a6da99545349d491">  391</a></span>&#160;    <a class="code" href="kstdint_8h.html#a2ba621978a511250f7250fb10e05ffbe">int32_t</a> <a class="code" href="structcram__record.html#acf0313bec7295440a6da99545349d491">aux</a>;          <span class="comment">// idx to s-&gt;aux_blk</span></div>
<div class="line"><a name="l00392"></a><span class="lineno"><a class="code" href="structcram__record.html#a9b71507ad77a2e246e1cd75ccd02299c">  392</a></span>&#160;    <a class="code" href="kstdint_8h.html#a2ba621978a511250f7250fb10e05ffbe">int32_t</a> <a class="code" href="structcram__record.html#a9b71507ad77a2e246e1cd75ccd02299c">aux_size</a>;     <span class="comment">// total size of packed ntags in aux_blk</span></div>
<div class="line"><a name="l00393"></a><span class="lineno">  393</span>&#160;<span class="preprocessor">#ifndef TN_external</span></div>
<div class="line"><a name="l00394"></a><span class="lineno">  394</span>&#160;<span class="preprocessor"></span>    <a class="code" href="kstdint_8h.html#a2ba621978a511250f7250fb10e05ffbe">int32_t</a> TN_idx;       <span class="comment">// TN; idx to s-&gt;TN;</span></div>
<div class="line"><a name="l00395"></a><span class="lineno">  395</span>&#160;<span class="preprocessor">#else</span></div>
<div class="line"><a name="l00396"></a><span class="lineno"><a class="code" href="structcram__record.html#a6d02a888c46b7be6060a4f37416aef6b">  396</a></span>&#160;<span class="preprocessor"></span>    <a class="code" href="kstdint_8h.html#a2ba621978a511250f7250fb10e05ffbe">int32_t</a> <a class="code" href="structcram__record.html#a6d02a888c46b7be6060a4f37416aef6b">tn</a>;           <span class="comment">// idx to s-&gt;tn_blk</span></div>
<div class="line"><a name="l00397"></a><span class="lineno">  397</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00398"></a><span class="lineno"><a class="code" href="structcram__record.html#acfeaf8efe70088ddf8306a499bbcb1ad">  398</a></span>&#160;<span class="preprocessor"></span>    <span class="keywordtype">int</span>     <a class="code" href="structcram__record.html#acfeaf8efe70088ddf8306a499bbcb1ad">TL</a>;</div>
<div class="line"><a name="l00399"></a><span class="lineno">  399</span>&#160;</div>
<div class="line"><a name="l00400"></a><span class="lineno"><a class="code" href="structcram__record.html#af75c71bc34a82618ca1080d15200336e">  400</a></span>&#160;    <a class="code" href="kstdint_8h.html#a2ba621978a511250f7250fb10e05ffbe">int32_t</a> <a class="code" href="structcram__record.html#af75c71bc34a82618ca1080d15200336e">seq</a>;          <span class="comment">// idx to s-&gt;seqs_blk</span></div>
<div class="line"><a name="l00401"></a><span class="lineno"><a class="code" href="structcram__record.html#a13043c094dd69933494f7bd7565bc163">  401</a></span>&#160;    <a class="code" href="kstdint_8h.html#a2ba621978a511250f7250fb10e05ffbe">int32_t</a> <a class="code" href="structcram__record.html#a13043c094dd69933494f7bd7565bc163">qual</a>;         <span class="comment">// idx to s-&gt;qual_blk</span></div>
<div class="line"><a name="l00402"></a><span class="lineno"><a class="code" href="structcram__record.html#abaf5170430e54b579a7cf6953ff2fc24">  402</a></span>&#160;    <a class="code" href="kstdint_8h.html#a2ba621978a511250f7250fb10e05ffbe">int32_t</a> <a class="code" href="structcram__record.html#abaf5170430e54b579a7cf6953ff2fc24">cigar</a>;        <span class="comment">// idx to s-&gt;cigar</span></div>
<div class="line"><a name="l00403"></a><span class="lineno"><a class="code" href="structcram__record.html#a171e572c60025244e064b66a0b581b27">  403</a></span>&#160;    <a class="code" href="kstdint_8h.html#a2ba621978a511250f7250fb10e05ffbe">int32_t</a> <a class="code" href="structcram__record.html#a171e572c60025244e064b66a0b581b27">ncigar</a>;</div>
<div class="line"><a name="l00404"></a><span class="lineno"><a class="code" href="structcram__record.html#a8923adc16b50a31fa6dfa95d483ae555">  404</a></span>&#160;    <a class="code" href="kstdint_8h.html#a2ba621978a511250f7250fb10e05ffbe">int32_t</a> <a class="code" href="structcram__record.html#a8923adc16b50a31fa6dfa95d483ae555">aend</a>;         <span class="comment">// alignment end</span></div>
<div class="line"><a name="l00405"></a><span class="lineno"><a class="code" href="structcram__record.html#a5edced3d09e8cac527b83e737ff00726">  405</a></span>&#160;    <a class="code" href="kstdint_8h.html#a2ba621978a511250f7250fb10e05ffbe">int32_t</a> <a class="code" href="structcram__record.html#a5edced3d09e8cac527b83e737ff00726">mqual</a>;        <span class="comment">// MQ</span></div>
<div class="line"><a name="l00406"></a><span class="lineno">  406</span>&#160;</div>
<div class="line"><a name="l00407"></a><span class="lineno"><a class="code" href="structcram__record.html#a35fb9d08cd3c678d3ce3a081b9661e3d">  407</a></span>&#160;    <a class="code" href="kstdint_8h.html#a2ba621978a511250f7250fb10e05ffbe">int32_t</a> <a class="code" href="structcram__record.html#a35fb9d08cd3c678d3ce3a081b9661e3d">feature</a>;      <span class="comment">// idx to s-&gt;feature</span></div>
<div class="line"><a name="l00408"></a><span class="lineno"><a class="code" href="structcram__record.html#af6687b90ec621dd3c873c7bf570004bc">  408</a></span>&#160;    <a class="code" href="kstdint_8h.html#a2ba621978a511250f7250fb10e05ffbe">int32_t</a> <a class="code" href="structcram__record.html#af6687b90ec621dd3c873c7bf570004bc">nfeature</a>;     <span class="comment">// number of features</span></div>
<div class="line"><a name="l00409"></a><span class="lineno"><a class="code" href="structcram__record.html#a19bc0814c56fd02bb223fda28b7bade5">  409</a></span>&#160;    <a class="code" href="kstdint_8h.html#a2ba621978a511250f7250fb10e05ffbe">int32_t</a> <a class="code" href="structcram__record.html#a19bc0814c56fd02bb223fda28b7bade5">mate_flags</a>;   <span class="comment">// MF</span></div>
<div class="line"><a name="l00410"></a><span class="lineno">  410</span>&#160;} <a class="code" href="structcram__record.html">cram_record</a>;</div>
<div class="line"><a name="l00411"></a><span class="lineno">  411</span>&#160;</div>
<div class="line"><a name="l00412"></a><span class="lineno">  412</span>&#160;<span class="comment">// Accessor macros as an analogue of the bam ones</span></div>
<div class="line"><a name="l00413"></a><span class="lineno"><a class="code" href="cram__structs_8h.html#a061dbaced0a448526fae1d1516571a35">  413</a></span>&#160;<span class="preprocessor">#define cram_qname(c)    (&amp;(c)-&gt;s-&gt;name_blk-&gt;data[(c)-&gt;name])</span></div>
<div class="line"><a name="l00414"></a><span class="lineno"><a class="code" href="cram__structs_8h.html#af0e896de5d590b2d79911a0d128f05a9">  414</a></span>&#160;<span class="preprocessor"></span><span class="preprocessor">#define cram_seq(c)      (&amp;(c)-&gt;s-&gt;seqs_blk-&gt;data[(c)-&gt;seq])</span></div>
<div class="line"><a name="l00415"></a><span class="lineno"><a class="code" href="cram__structs_8h.html#a9eeb5702c876068ba263248c77d192f6">  415</a></span>&#160;<span class="preprocessor"></span><span class="preprocessor">#define cram_qual(c)     (&amp;(c)-&gt;s-&gt;qual_blk-&gt;data[(c)-&gt;qual])</span></div>
<div class="line"><a name="l00416"></a><span class="lineno"><a class="code" href="cram__structs_8h.html#aed2d86341111adc4b9307d0a15ba18fb">  416</a></span>&#160;<span class="preprocessor"></span><span class="preprocessor">#define cram_aux(c)      (&amp;(c)-&gt;s-&gt;aux_blk-&gt;data[(c)-&gt;aux])</span></div>
<div class="line"><a name="l00417"></a><span class="lineno"><a class="code" href="cram__structs_8h.html#a00000380dbac8fbdb18d65b5689b17f3">  417</a></span>&#160;<span class="preprocessor"></span><span class="preprocessor">#define cram_seqi(c,i)   (cram_seq((c))[(i)])</span></div>
<div class="line"><a name="l00418"></a><span class="lineno"><a class="code" href="cram__structs_8h.html#a0124579a05f55fa9c9c7dc4079121a97">  418</a></span>&#160;<span class="preprocessor"></span><span class="preprocessor">#define cram_name_len(c) ((c)-&gt;name_len)</span></div>
<div class="line"><a name="l00419"></a><span class="lineno"><a class="code" href="cram__structs_8h.html#a1d2a06bd361c3ec58fc552f424ac9dcc">  419</a></span>&#160;<span class="preprocessor"></span><span class="preprocessor">#define cram_strand(c)   (((c)-&gt;flags &amp; BAM_FREVERSE) != 0)</span></div>
<div class="line"><a name="l00420"></a><span class="lineno"><a class="code" href="cram__structs_8h.html#a80294d70d0e9d667345988c61123c7d2">  420</a></span>&#160;<span class="preprocessor"></span><span class="preprocessor">#define cram_mstrand(c)  (((c)-&gt;flags &amp; BAM_FMREVERSE) != 0)</span></div>
<div class="line"><a name="l00421"></a><span class="lineno"><a class="code" href="cram__structs_8h.html#ad9f6d0b9144fb9908a1cf9388fb7d457">  421</a></span>&#160;<span class="preprocessor"></span><span class="preprocessor">#define cram_cigar(c)    (&amp;((cr)-&gt;s-&gt;cigar)[(c)-&gt;cigar])</span></div>
<div class="line"><a name="l00422"></a><span class="lineno">  422</span>&#160;<span class="preprocessor"></span></div>
<div class="line"><a name="l00423"></a><span class="lineno">  423</span>&#160;<span class="comment">/*</span></div>
<div class="line"><a name="l00424"></a><span class="lineno">  424</span>&#160;<span class="comment"> * A feature is a base difference, used for the sequence reference encoding.</span></div>
<div class="line"><a name="l00425"></a><span class="lineno">  425</span>&#160;<span class="comment"> * (We generate these internally when writing CRAM.)</span></div>
<div class="line"><a name="l00426"></a><span class="lineno">  426</span>&#160;<span class="comment"> */</span></div>
<div class="line"><a name="l00427"></a><span class="lineno"><a class="code" href="structcram__feature.html">  427</a></span>&#160;<span class="keyword">typedef</span> <span class="keyword">struct </span>{</div>
<div class="line"><a name="l00428"></a><span class="lineno">  428</span>&#160;    <span class="keyword">union </span>{</div>
<div class="line"><a name="l00429"></a><span class="lineno">  429</span>&#160;        <span class="keyword">struct </span>{</div>
<div class="line"><a name="l00430"></a><span class="lineno"><a class="code" href="structcram__feature.html#a1610f76184555253cfd9dbe8ec1c410a">  430</a></span>&#160;            <span class="keywordtype">int</span> <a class="code" href="structcram__feature.html#a1610f76184555253cfd9dbe8ec1c410a">pos</a>;</div>
<div class="line"><a name="l00431"></a><span class="lineno"><a class="code" href="structcram__feature.html#aa0e2cd8c09f036478910ed4cf5ee523a">  431</a></span>&#160;            <span class="keywordtype">int</span> <a class="code" href="structcram__feature.html#aa0e2cd8c09f036478910ed4cf5ee523a">code</a>;</div>
<div class="line"><a name="l00432"></a><span class="lineno"><a class="code" href="structcram__feature.html#abb3c456a1938f3d373b5b32a897ff089">  432</a></span>&#160;            <span class="keywordtype">int</span> <a class="code" href="structcram__feature.html#abb3c456a1938f3d373b5b32a897ff089">base</a>;    <span class="comment">// substitution code</span></div>
<div class="line"><a name="l00433"></a><span class="lineno">  433</span>&#160;        } X;</div>
<div class="line"><a name="l00434"></a><span class="lineno">  434</span>&#160;        <span class="keyword">struct </span>{</div>
<div class="line"><a name="l00435"></a><span class="lineno">  435</span>&#160;            <span class="keywordtype">int</span> pos;</div>
<div class="line"><a name="l00436"></a><span class="lineno">  436</span>&#160;            <span class="keywordtype">int</span> <a class="code" href="structcode.html">code</a>;</div>
<div class="line"><a name="l00437"></a><span class="lineno">  437</span>&#160;            <span class="keywordtype">int</span> base;    <span class="comment">// actual base &amp; qual</span></div>
<div class="line"><a name="l00438"></a><span class="lineno"><a class="code" href="structcram__feature.html#a1bcdab2def664d89888f1e365fad8c97">  438</a></span>&#160;            <span class="keywordtype">int</span> <a class="code" href="structcram__feature.html#a1bcdab2def664d89888f1e365fad8c97">qual</a>;</div>
<div class="line"><a name="l00439"></a><span class="lineno">  439</span>&#160;        } B;</div>
<div class="line"><a name="l00440"></a><span class="lineno">  440</span>&#160;        <span class="keyword">struct </span>{</div>
<div class="line"><a name="l00441"></a><span class="lineno">  441</span>&#160;            <span class="keywordtype">int</span> pos;</div>
<div class="line"><a name="l00442"></a><span class="lineno">  442</span>&#160;            <span class="keywordtype">int</span> <a class="code" href="structcode.html">code</a>;</div>
<div class="line"><a name="l00443"></a><span class="lineno">  443</span>&#160;            <span class="keywordtype">int</span> qual;</div>
<div class="line"><a name="l00444"></a><span class="lineno">  444</span>&#160;        } Q;</div>
<div class="line"><a name="l00445"></a><span class="lineno">  445</span>&#160;        <span class="keyword">struct </span>{</div>
<div class="line"><a name="l00446"></a><span class="lineno">  446</span>&#160;            <span class="keywordtype">int</span> pos;</div>
<div class="line"><a name="l00447"></a><span class="lineno">  447</span>&#160;            <span class="keywordtype">int</span> <a class="code" href="structcode.html">code</a>;</div>
<div class="line"><a name="l00448"></a><span class="lineno"><a class="code" href="structcram__feature.html#aa2a938fe5081ccbfaea5a52029592761">  448</a></span>&#160;            <span class="keywordtype">int</span> <a class="code" href="structcram__feature.html#aa2a938fe5081ccbfaea5a52029592761">len</a>;</div>
<div class="line"><a name="l00449"></a><span class="lineno"><a class="code" href="structcram__feature.html#a98b55ad32acc34b98a055ed3b2dfea6e">  449</a></span>&#160;            <span class="keywordtype">int</span> <a class="code" href="structcram__feature.html#a98b55ad32acc34b98a055ed3b2dfea6e">seq_idx</a>; <span class="comment">// soft-clip multiple bases</span></div>
<div class="line"><a name="l00450"></a><span class="lineno">  450</span>&#160;        } S;</div>
<div class="line"><a name="l00451"></a><span class="lineno">  451</span>&#160;        <span class="keyword">struct </span>{</div>
<div class="line"><a name="l00452"></a><span class="lineno">  452</span>&#160;            <span class="keywordtype">int</span> pos;</div>
<div class="line"><a name="l00453"></a><span class="lineno">  453</span>&#160;            <span class="keywordtype">int</span> <a class="code" href="structcode.html">code</a>;</div>
<div class="line"><a name="l00454"></a><span class="lineno">  454</span>&#160;            <span class="keywordtype">int</span> len;</div>
<div class="line"><a name="l00455"></a><span class="lineno">  455</span>&#160;            <span class="keywordtype">int</span> seq_idx; <span class="comment">// insertion multiple bases</span></div>
<div class="line"><a name="l00456"></a><span class="lineno">  456</span>&#160;        } <a class="code" href="md5_8c.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>;</div>
<div class="line"><a name="l00457"></a><span class="lineno">  457</span>&#160;        <span class="keyword">struct </span>{</div>
<div class="line"><a name="l00458"></a><span class="lineno">  458</span>&#160;            <span class="keywordtype">int</span> pos;</div>
<div class="line"><a name="l00459"></a><span class="lineno">  459</span>&#160;            <span class="keywordtype">int</span> <a class="code" href="structcode.html">code</a>;</div>
<div class="line"><a name="l00460"></a><span class="lineno">  460</span>&#160;            <span class="keywordtype">int</span> base; <span class="comment">// insertion single base</span></div>
<div class="line"><a name="l00461"></a><span class="lineno">  461</span>&#160;        } i;</div>
<div class="line"><a name="l00462"></a><span class="lineno">  462</span>&#160;        <span class="keyword">struct </span>{</div>
<div class="line"><a name="l00463"></a><span class="lineno">  463</span>&#160;            <span class="keywordtype">int</span> pos;</div>
<div class="line"><a name="l00464"></a><span class="lineno">  464</span>&#160;            <span class="keywordtype">int</span> <a class="code" href="structcode.html">code</a>;</div>
<div class="line"><a name="l00465"></a><span class="lineno">  465</span>&#160;            <span class="keywordtype">int</span> len;</div>
<div class="line"><a name="l00466"></a><span class="lineno">  466</span>&#160;        } D;</div>
<div class="line"><a name="l00467"></a><span class="lineno">  467</span>&#160;        <span class="keyword">struct </span>{</div>
<div class="line"><a name="l00468"></a><span class="lineno">  468</span>&#160;            <span class="keywordtype">int</span> pos;</div>
<div class="line"><a name="l00469"></a><span class="lineno">  469</span>&#160;            <span class="keywordtype">int</span> <a class="code" href="structcode.html">code</a>;</div>
<div class="line"><a name="l00470"></a><span class="lineno">  470</span>&#160;            <span class="keywordtype">int</span> len;</div>
<div class="line"><a name="l00471"></a><span class="lineno">  471</span>&#160;        } N;</div>
<div class="line"><a name="l00472"></a><span class="lineno">  472</span>&#160;        <span class="keyword">struct </span>{</div>
<div class="line"><a name="l00473"></a><span class="lineno">  473</span>&#160;            <span class="keywordtype">int</span> pos;</div>
<div class="line"><a name="l00474"></a><span class="lineno">  474</span>&#160;            <span class="keywordtype">int</span> <a class="code" href="structcode.html">code</a>;</div>
<div class="line"><a name="l00475"></a><span class="lineno">  475</span>&#160;            <span class="keywordtype">int</span> len;</div>
<div class="line"><a name="l00476"></a><span class="lineno">  476</span>&#160;        } P;</div>
<div class="line"><a name="l00477"></a><span class="lineno">  477</span>&#160;        <span class="keyword">struct </span>{</div>
<div class="line"><a name="l00478"></a><span class="lineno">  478</span>&#160;            <span class="keywordtype">int</span> pos;</div>
<div class="line"><a name="l00479"></a><span class="lineno">  479</span>&#160;            <span class="keywordtype">int</span> <a class="code" href="structcode.html">code</a>;</div>
<div class="line"><a name="l00480"></a><span class="lineno">  480</span>&#160;            <span class="keywordtype">int</span> len;</div>
<div class="line"><a name="l00481"></a><span class="lineno">  481</span>&#160;        } <a class="code" href="md5_8c.html#ae42219072d798876e6b08e6b78614ff6">H</a>;</div>
<div class="line"><a name="l00482"></a><span class="lineno">  482</span>&#160;    };</div>
<div class="line"><a name="l00483"></a><span class="lineno">  483</span>&#160;} <a class="code" href="structcram__feature.html">cram_feature</a>;</div>
<div class="line"><a name="l00484"></a><span class="lineno">  484</span>&#160;</div>
<div class="line"><a name="l00485"></a><span class="lineno">  485</span>&#160;<span class="comment">/*</span></div>
<div class="line"><a name="l00486"></a><span class="lineno">  486</span>&#160;<span class="comment"> * A slice is really just a set of blocks, but it</span></div>
<div class="line"><a name="l00487"></a><span class="lineno">  487</span>&#160;<span class="comment"> * is the logical unit for decoding a number of</span></div>
<div class="line"><a name="l00488"></a><span class="lineno">  488</span>&#160;<span class="comment"> * sequences.</span></div>
<div class="line"><a name="l00489"></a><span class="lineno">  489</span>&#160;<span class="comment"> */</span></div>
<div class="line"><a name="l00490"></a><span class="lineno"><a class="code" href="structcram__slice.html">  490</a></span>&#160;<span class="keyword">typedef</span> <span class="keyword">struct </span><a class="code" href="structcram__slice.html">cram_slice</a> {</div>
<div class="line"><a name="l00491"></a><span class="lineno"><a class="code" href="structcram__slice.html#a923f4e3eab3fcb30dbc4332332d9c54e">  491</a></span>&#160;    <a class="code" href="structcram__block__slice__hdr.html">cram_block_slice_hdr</a> *<a class="code" href="structcram__slice.html#a923f4e3eab3fcb30dbc4332332d9c54e">hdr</a>;</div>
<div class="line"><a name="l00492"></a><span class="lineno"><a class="code" href="structcram__slice.html#ac1e147d2ae1ba4dd7a1146a131234fc5">  492</a></span>&#160;    <a class="code" href="structcram__block.html">cram_block</a> *<a class="code" href="structcram__slice.html#ac1e147d2ae1ba4dd7a1146a131234fc5">hdr_block</a>;</div>
<div class="line"><a name="l00493"></a><span class="lineno"><a class="code" href="structcram__slice.html#ac120a12dd125b3d5d347094d383eecba">  493</a></span>&#160;    <a class="code" href="structcram__block.html">cram_block</a> **<a class="code" href="structcram__slice.html#ac120a12dd125b3d5d347094d383eecba">block</a>;</div>
<div class="line"><a name="l00494"></a><span class="lineno"><a class="code" href="structcram__slice.html#ac720c573904897802c190c7f16ba6515">  494</a></span>&#160;    <a class="code" href="structcram__block.html">cram_block</a> **<a class="code" href="structcram__slice.html#ac720c573904897802c190c7f16ba6515">block_by_id</a>;</div>
<div class="line"><a name="l00495"></a><span class="lineno">  495</span>&#160;</div>
<div class="line"><a name="l00496"></a><span class="lineno">  496</span>&#160;    <span class="comment">/* State used during encoding/decoding */</span></div>
<div class="line"><a name="l00497"></a><span class="lineno"><a class="code" href="structcram__slice.html#a44c78212fa8229caba0af33f4676faa6">  497</a></span>&#160;    <span class="keywordtype">int</span> <a class="code" href="structcram__slice.html#a212b7f99319aa92e1f41223d2754ef92">last_apos</a>, <a class="code" href="structcram__slice.html#a44c78212fa8229caba0af33f4676faa6">max_apos</a>;</div>
<div class="line"><a name="l00498"></a><span class="lineno">  498</span>&#160;</div>
<div class="line"><a name="l00499"></a><span class="lineno">  499</span>&#160;    <span class="comment">/* Identifier used for auto-assigning read names */</span></div>
<div class="line"><a name="l00500"></a><span class="lineno"><a class="code" href="structcram__slice.html#a429f6dd69e45c2b0a2479d71c6999c6a">  500</a></span>&#160;    <a class="code" href="kstdint_8h.html#aaa5d1cd013383c889537491c3cfd9aad">uint64_t</a> <a class="code" href="structcram__slice.html#a429f6dd69e45c2b0a2479d71c6999c6a">id</a>;</div>
<div class="line"><a name="l00501"></a><span class="lineno">  501</span>&#160;</div>
<div class="line"><a name="l00502"></a><span class="lineno">  502</span>&#160;    <span class="comment">/* Array of decoded cram records */</span></div>
<div class="line"><a name="l00503"></a><span class="lineno"><a class="code" href="structcram__slice.html#ad9fb01394f18b8b1db0b45e94ca03162">  503</a></span>&#160;    <a class="code" href="structcram__record.html">cram_record</a> *<a class="code" href="structcram__slice.html#ad9fb01394f18b8b1db0b45e94ca03162">crecs</a>;</div>
<div class="line"><a name="l00504"></a><span class="lineno">  504</span>&#160;</div>
<div class="line"><a name="l00505"></a><span class="lineno">  505</span>&#160;    <span class="comment">/* An dynamically growing buffers for data pointed</span></div>
<div class="line"><a name="l00506"></a><span class="lineno">  506</span>&#160;<span class="comment">     * to by crecs[] array.</span></div>
<div class="line"><a name="l00507"></a><span class="lineno">  507</span>&#160;<span class="comment">     */</span></div>
<div class="line"><a name="l00508"></a><span class="lineno"><a class="code" href="structcram__slice.html#aebff4e0822c1938f2f6d7127397fdb26">  508</a></span>&#160;    <a class="code" href="kstdint_8h.html#a06896e8c53f721507066c079052171f8">uint32_t</a>  *<a class="code" href="structcram__slice.html#aebff4e0822c1938f2f6d7127397fdb26">cigar</a>;</div>
<div class="line"><a name="l00509"></a><span class="lineno"><a class="code" href="structcram__slice.html#a538ebbf51e2dc4cad49472d75a6ceec2">  509</a></span>&#160;    <a class="code" href="kstdint_8h.html#a06896e8c53f721507066c079052171f8">uint32_t</a>   <a class="code" href="structcram__slice.html#a538ebbf51e2dc4cad49472d75a6ceec2">cigar_alloc</a>;</div>
<div class="line"><a name="l00510"></a><span class="lineno"><a class="code" href="structcram__slice.html#a3a2097915f9eab6fe5f70cf4515ab0fe">  510</a></span>&#160;    <a class="code" href="kstdint_8h.html#a06896e8c53f721507066c079052171f8">uint32_t</a>   <a class="code" href="structcram__slice.html#a3a2097915f9eab6fe5f70cf4515ab0fe">ncigar</a>;</div>
<div class="line"><a name="l00511"></a><span class="lineno"><a class="code" href="structcram__slice.html#ab559e07acc3b333f4a6c26fd6f14dfeb">  511</a></span>&#160;    <a class="code" href="structcram__block.html">cram_block</a> *<a class="code" href="structcram__slice.html#ab559e07acc3b333f4a6c26fd6f14dfeb">name_blk</a>;</div>
<div class="line"><a name="l00512"></a><span class="lineno"><a class="code" href="structcram__slice.html#a272dc54bcd163aa51b2f5f4caee29b7d">  512</a></span>&#160;    <a class="code" href="structcram__block.html">cram_block</a> *<a class="code" href="structcram__slice.html#a272dc54bcd163aa51b2f5f4caee29b7d">seqs_blk</a>;</div>
<div class="line"><a name="l00513"></a><span class="lineno"><a class="code" href="structcram__slice.html#a1a1a5896a637b6b757e123b360715e4a">  513</a></span>&#160;    <a class="code" href="structcram__block.html">cram_block</a> *<a class="code" href="structcram__slice.html#a1a1a5896a637b6b757e123b360715e4a">qual_blk</a>;</div>
<div class="line"><a name="l00514"></a><span class="lineno"><a class="code" href="structcram__slice.html#a746b28d998d119fbe8efd01ca4c2a93e">  514</a></span>&#160;    <a class="code" href="structcram__block.html">cram_block</a> *<a class="code" href="structcram__slice.html#a746b28d998d119fbe8efd01ca4c2a93e">aux_blk</a>;</div>
<div class="line"><a name="l00515"></a><span class="lineno"><a class="code" href="structcram__slice.html#a3ab55e7648e1f6f40fa5e5966c8c18ee">  515</a></span>&#160;    <a class="code" href="structcram__block.html">cram_block</a> *<a class="code" href="structcram__slice.html#a3ab55e7648e1f6f40fa5e5966c8c18ee">base_blk</a>; <span class="comment">// substitutions (soft-clips for 1.0)</span></div>
<div class="line"><a name="l00516"></a><span class="lineno"><a class="code" href="structcram__slice.html#abf9778dcb7661e1f75aace9084363bff">  516</a></span>&#160;    <a class="code" href="structcram__block.html">cram_block</a> *<a class="code" href="structcram__slice.html#abf9778dcb7661e1f75aace9084363bff">soft_blk</a>; <span class="comment">// soft-clips</span></div>
<div class="line"><a name="l00517"></a><span class="lineno">  517</span>&#160;</div>
<div class="line"><a name="l00518"></a><span class="lineno"><a class="code" href="structcram__slice.html#a80e707ddb404b493d5a927e3a247da42">  518</a></span>&#160;    <a class="code" href="structcram__feature.html">cram_feature</a> *<a class="code" href="structcram__slice.html#a80e707ddb404b493d5a927e3a247da42">features</a>;</div>
<div class="line"><a name="l00519"></a><span class="lineno"><a class="code" href="structcram__slice.html#af36a906059f4ba8cc853524e06ff79dc">  519</a></span>&#160;    <span class="keywordtype">int</span>           <a class="code" href="structcram__slice.html#af36a906059f4ba8cc853524e06ff79dc">nfeatures</a>;</div>
<div class="line"><a name="l00520"></a><span class="lineno"><a class="code" href="structcram__slice.html#a91b1946888b116cc74689ce7001235fd">  520</a></span>&#160;    <span class="keywordtype">int</span>           <a class="code" href="structcram__slice.html#a91b1946888b116cc74689ce7001235fd">afeatures</a>; <span class="comment">// allocated size of features</span></div>
<div class="line"><a name="l00521"></a><span class="lineno">  521</span>&#160;</div>
<div class="line"><a name="l00522"></a><span class="lineno">  522</span>&#160;<span class="preprocessor">#ifndef TN_external</span></div>
<div class="line"><a name="l00523"></a><span class="lineno">  523</span>&#160;<span class="preprocessor"></span>    <span class="comment">// TN field (Tag Name)</span></div>
<div class="line"><a name="l00524"></a><span class="lineno">  524</span>&#160;    <a class="code" href="kstdint_8h.html#a06896e8c53f721507066c079052171f8">uint32_t</a>      *TN;</div>
<div class="line"><a name="l00525"></a><span class="lineno">  525</span>&#160;    <span class="keywordtype">int</span>           nTN, aTN;  <span class="comment">// used and allocated size for TN[]</span></div>
<div class="line"><a name="l00526"></a><span class="lineno">  526</span>&#160;<span class="preprocessor">#else</span></div>
<div class="line"><a name="l00527"></a><span class="lineno"><a class="code" href="structcram__slice.html#a03de760f0c0d0f5664fba8374f06a16c">  527</a></span>&#160;<span class="preprocessor"></span>    <a class="code" href="structcram__block.html">cram_block</a> *<a class="code" href="structcram__slice.html#a03de760f0c0d0f5664fba8374f06a16c">tn_blk</a>;</div>
<div class="line"><a name="l00528"></a><span class="lineno"><a class="code" href="structcram__slice.html#ad3e0c7a730fb68d32dcd6008821836da">  528</a></span>&#160;    <span class="keywordtype">int</span> <a class="code" href="structcram__slice.html#ad3e0c7a730fb68d32dcd6008821836da">tn_id</a>;</div>
<div class="line"><a name="l00529"></a><span class="lineno">  529</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00530"></a><span class="lineno">  530</span>&#160;<span class="preprocessor"></span></div>
<div class="line"><a name="l00531"></a><span class="lineno"><a class="code" href="structcram__slice.html#ab9a1ab0c3fe90dfd924434b09b288958">  531</a></span>&#160;    <a class="code" href="structstring__alloc__t.html">string_alloc_t</a> *<a class="code" href="structcram__slice.html#ab9a1ab0c3fe90dfd924434b09b288958">pair_keys</a>; <span class="comment">// Pooled keys for pair hash.</span></div>
<div class="line"><a name="l00532"></a><span class="lineno">  532</span>&#160;    <a class="code" href="structcram__slice.html#aae2eba105267cc786d360df160ef24ef">khash_t</a>(m_s2i) *pair;      <span class="comment">// for identifying read-pairs in this slice.</span></div>
<div class="line"><a name="l00533"></a><span class="lineno">  533</span>&#160;</div>
<div class="line"><a name="l00534"></a><span class="lineno"><a class="code" href="structcram__slice.html#a19c475e6123ca5ab4f02cfbd64dfb7eb">  534</a></span>&#160;    <span class="keywordtype">char</span> *<a class="code" href="structcram__slice.html#a19c475e6123ca5ab4f02cfbd64dfb7eb">ref</a>;               <span class="comment">// slice of current reference</span></div>
<div class="line"><a name="l00535"></a><span class="lineno"><a class="code" href="structcram__slice.html#a578aad831c961ab4c01cf7d9e1665a4f">  535</a></span>&#160;    <span class="keywordtype">int</span> <a class="code" href="structcram__slice.html#a578aad831c961ab4c01cf7d9e1665a4f">ref_start</a>;           <span class="comment">// start position of current reference;</span></div>
<div class="line"><a name="l00536"></a><span class="lineno"><a class="code" href="structcram__slice.html#ad04b00928bb9f827362a3cf262cda5ce">  536</a></span>&#160;    <span class="keywordtype">int</span> <a class="code" href="structcram__slice.html#ad04b00928bb9f827362a3cf262cda5ce">ref_end</a>;             <span class="comment">// end position of current reference;</span></div>
<div class="line"><a name="l00537"></a><span class="lineno">  537</span>&#160;</div>
<div class="line"><a name="l00538"></a><span class="lineno">  538</span>&#160;<span class="preprocessor">#ifdef BA_external</span></div>
<div class="line"><a name="l00539"></a><span class="lineno">  539</span>&#160;<span class="preprocessor"></span>    <span class="keywordtype">int</span> BA_len;</div>
<div class="line"><a name="l00540"></a><span class="lineno">  540</span>&#160;    <span class="keywordtype">int</span> ba_id;</div>
<div class="line"><a name="l00541"></a><span class="lineno">  541</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00542"></a><span class="lineno"><a class="code" href="structcram__slice.html#a08ae48585403a24df38a90241b698b8f">  542</a></span>&#160;<span class="preprocessor"></span>    <span class="keywordtype">int</span> <a class="code" href="structcram__slice.html#a08ae48585403a24df38a90241b698b8f">ref_id</a>;</div>
<div class="line"><a name="l00543"></a><span class="lineno">  543</span>&#160;} <a class="code" href="cram__structs_8h.html#a83fe72953994ec8e38284f7b0b1b78fc">cram_slice</a>;</div>
<div class="line"><a name="l00544"></a><span class="lineno">  544</span>&#160;</div>
<div class="line"><a name="l00545"></a><span class="lineno">  545</span>&#160;<span class="comment">/*-----------------------------------------------------------------------------</span></div>
<div class="line"><a name="l00546"></a><span class="lineno">  546</span>&#160;<span class="comment"> * Consider moving reference handling to cram_refs.[ch]</span></div>
<div class="line"><a name="l00547"></a><span class="lineno">  547</span>&#160;<span class="comment"> */</span></div>
<div class="line"><a name="l00548"></a><span class="lineno">  548</span>&#160;<span class="comment">// from fa.fai / samtools faidx files</span></div>
<div class="line"><a name="l00549"></a><span class="lineno"><a class="code" href="structref__entry.html">  549</a></span>&#160;<span class="keyword">typedef</span> <span class="keyword">struct </span><a class="code" href="structref__entry.html">ref_entry</a> {</div>
<div class="line"><a name="l00550"></a><span class="lineno"><a class="code" href="structref__entry.html#a1b3a3ea8c8e4d24b0e896047a5359fd3">  550</a></span>&#160;    <span class="keywordtype">char</span> *<a class="code" href="structref__entry.html#a1b3a3ea8c8e4d24b0e896047a5359fd3">name</a>;</div>
<div class="line"><a name="l00551"></a><span class="lineno"><a class="code" href="structref__entry.html#a6547799512e6588b5559dcc6bcfcb8ca">  551</a></span>&#160;    <span class="keywordtype">char</span> *<a class="code" href="structref__entry.html#a6547799512e6588b5559dcc6bcfcb8ca">fn</a>;</div>
<div class="line"><a name="l00552"></a><span class="lineno"><a class="code" href="structref__entry.html#a0b1d84a140fba2de76fd3dc071837a73">  552</a></span>&#160;    <a class="code" href="kstdint_8h.html#adec1df1b8b51cb32b77e5b86fff46471">int64_t</a> <a class="code" href="structref__entry.html#a0b1d84a140fba2de76fd3dc071837a73">length</a>;</div>
<div class="line"><a name="l00553"></a><span class="lineno"><a class="code" href="structref__entry.html#a041f8e06fba189940f0b27c0e0c80c52">  553</a></span>&#160;    <a class="code" href="kstdint_8h.html#adec1df1b8b51cb32b77e5b86fff46471">int64_t</a> <a class="code" href="structref__entry.html#a041f8e06fba189940f0b27c0e0c80c52">offset</a>;</div>
<div class="line"><a name="l00554"></a><span class="lineno"><a class="code" href="structref__entry.html#a0f9dc01c8feb55c0420f5e7303fcd0fa">  554</a></span>&#160;    <span class="keywordtype">int</span> <a class="code" href="structref__entry.html#a0f9dc01c8feb55c0420f5e7303fcd0fa">bases_per_line</a>;</div>
<div class="line"><a name="l00555"></a><span class="lineno"><a class="code" href="structref__entry.html#a101093e66ecb762584e35bff37e07dc9">  555</a></span>&#160;    <span class="keywordtype">int</span> <a class="code" href="structref__entry.html#a101093e66ecb762584e35bff37e07dc9">line_length</a>;</div>
<div class="line"><a name="l00556"></a><span class="lineno"><a class="code" href="structref__entry.html#a93c76b30d2cdc521a5179b8678c7cc89">  556</a></span>&#160;    <a class="code" href="kstdint_8h.html#adec1df1b8b51cb32b77e5b86fff46471">int64_t</a> <a class="code" href="structref__entry.html#a93c76b30d2cdc521a5179b8678c7cc89">count</a>;         <span class="comment">// for shared references so we know to dealloc seq</span></div>
<div class="line"><a name="l00557"></a><span class="lineno"><a class="code" href="structref__entry.html#a3d71405402d35e5430d745e4120f7c25">  557</a></span>&#160;    <span class="keywordtype">char</span> *<a class="code" href="structref__entry.html#a3d71405402d35e5430d745e4120f7c25">seq</a>;</div>
<div class="line"><a name="l00558"></a><span class="lineno">  558</span>&#160;} <a class="code" href="cram__structs_8h.html#af33c86d5b2854e32ba280e5e038cd7be">ref_entry</a>;</div>
<div class="line"><a name="l00559"></a><span class="lineno">  559</span>&#160;</div>
<div class="line"><a name="l00560"></a><span class="lineno">  560</span>&#160;<a class="code" href="khash_8h.html#a296c6de6bacb01ad7565979ac15a68c2">KHASH_MAP_INIT_STR</a>(refs, <a class="code" href="structref__entry.html">ref_entry</a>*)</div>
<div class="line"><a name="l00561"></a><span class="lineno">  561</span>&#160;</div>
<div class="line"><a name="l00562"></a><span class="lineno">  562</span>&#160;<span class="comment">// References structure.</span></div>
<div class="line"><a name="l00563"></a><span class="lineno"><a class="code" href="structrefs__t.html">  563</a></span>&#160;typedef struct {</div>
<div class="line"><a name="l00564"></a><span class="lineno"><a class="code" href="structrefs__t.html#a842f40e9fb5bbfa181b7674a98f27d64">  564</a></span>&#160;    <a class="code" href="structstring__alloc__t.html">string_alloc_t</a> *<a class="code" href="structrefs__t.html#a842f40e9fb5bbfa181b7674a98f27d64">pool</a>;  <span class="comment">// String pool for holding filenames and SN vals</span></div>
<div class="line"><a name="l00565"></a><span class="lineno">  565</span>&#160;</div>
<div class="line"><a name="l00566"></a><span class="lineno">  566</span>&#160;    <a class="code" href="khash_8h.html#a918655286199787582304265cd9d4463">khash_t</a>(refs) *h_meta; <span class="comment">// ref_entry*, index by name</span></div>
<div class="line"><a name="l00567"></a><span class="lineno"><a class="code" href="structrefs__t.html#aeaeb248d29ada1f0caa035a8d315ed79">  567</a></span>&#160;    <a class="code" href="structref__entry.html">ref_entry</a> **<a class="code" href="structrefs__t.html#aeaeb248d29ada1f0caa035a8d315ed79">ref_id</a>;    <span class="comment">// ref_entry*, index by ID</span></div>
<div class="line"><a name="l00568"></a><span class="lineno"><a class="code" href="structrefs__t.html#ac8e153272127ab3d2634fbf6c51c1a75">  568</a></span>&#160;    <span class="keywordtype">int</span> <a class="code" href="structrefs__t.html#ac8e153272127ab3d2634fbf6c51c1a75">nref</a>;              <span class="comment">// number of ref_entry</span></div>
<div class="line"><a name="l00569"></a><span class="lineno">  569</span>&#160;</div>
<div class="line"><a name="l00570"></a><span class="lineno"><a class="code" href="structrefs__t.html#a84a0e822c1e618c4216733b18bc0e2c3">  570</a></span>&#160;    <span class="keywordtype">char</span> *<a class="code" href="structrefs__t.html#a84a0e822c1e618c4216733b18bc0e2c3">fn</a>;              <span class="comment">// current file opened</span></div>
<div class="line"><a name="l00571"></a><span class="lineno"><a class="code" href="structrefs__t.html#a40f77ef8eb5109e845a0a9fbd0bdef9a">  571</a></span>&#160;    FILE *<a class="code" href="structrefs__t.html#a40f77ef8eb5109e845a0a9fbd0bdef9a">fp</a>;              <span class="comment">// and the FILE* to go with it.</span></div>
<div class="line"><a name="l00572"></a><span class="lineno">  572</span>&#160;</div>
<div class="line"><a name="l00573"></a><span class="lineno"><a class="code" href="structrefs__t.html#af53c9d706fb4734716466096c01e5298">  573</a></span>&#160;    <span class="keywordtype">int</span> <a class="code" href="structrefs__t.html#af53c9d706fb4734716466096c01e5298">count</a>;             <span class="comment">// how many cram_fd sharing this refs struct</span></div>
<div class="line"><a name="l00574"></a><span class="lineno">  574</span>&#160;</div>
<div class="line"><a name="l00575"></a><span class="lineno"><a class="code" href="structrefs__t.html#a0bec1eba888bfee6972ef5c1ddf366ee">  575</a></span>&#160;    pthread_mutex_t <a class="code" href="structrefs__t.html#a0bec1eba888bfee6972ef5c1ddf366ee">lock</a>;  <span class="comment">// Mutex for multi-threaded updating</span></div>
<div class="line"><a name="l00576"></a><span class="lineno"><a class="code" href="structrefs__t.html#adcb09c8a8fc714044b824dd3470ccf41">  576</a></span>&#160;    <a class="code" href="structref__entry.html">ref_entry</a> *<a class="code" href="structrefs__t.html#adcb09c8a8fc714044b824dd3470ccf41">last</a>;       <span class="comment">// Last queried sequence</span></div>
<div class="line"><a name="l00577"></a><span class="lineno"><a class="code" href="structrefs__t.html#a49594c39defd1045e1e53d5c8458aaa8">  577</a></span>&#160;    <span class="keywordtype">int</span> <a class="code" href="structrefs__t.html#a49594c39defd1045e1e53d5c8458aaa8">last_id</a>;           <span class="comment">// Used in cram_ref_decr_locked to delay free</span></div>
<div class="line"><a name="l00578"></a><span class="lineno">  578</span>&#160;} <a class="code" href="structrefs__t.html">refs_t</a>;</div>
<div class="line"><a name="l00579"></a><span class="lineno">  579</span>&#160;</div>
<div class="line"><a name="l00580"></a><span class="lineno">  580</span>&#160;<span class="comment">/*-----------------------------------------------------------------------------</span></div>
<div class="line"><a name="l00581"></a><span class="lineno">  581</span>&#160;<span class="comment"> * CRAM index</span></div>
<div class="line"><a name="l00582"></a><span class="lineno">  582</span>&#160;<span class="comment"> *</span></div>
<div class="line"><a name="l00583"></a><span class="lineno">  583</span>&#160;<span class="comment"> * Detect format by number of entries per line.</span></div>
<div class="line"><a name="l00584"></a><span class="lineno">  584</span>&#160;<span class="comment"> * 5 =&gt; 1.0 (refid, start, nseq, C offset, slice)</span></div>
<div class="line"><a name="l00585"></a><span class="lineno">  585</span>&#160;<span class="comment"> * 6 =&gt; 1.1 (refid, start, span, C offset, S offset, S size)</span></div>
<div class="line"><a name="l00586"></a><span class="lineno">  586</span>&#160;<span class="comment"> *</span></div>
<div class="line"><a name="l00587"></a><span class="lineno">  587</span>&#160;<span class="comment"> * Indices are stored in a nested containment list, which is trivial to set</span></div>
<div class="line"><a name="l00588"></a><span class="lineno">  588</span>&#160;<span class="comment"> * up as the indices are on sorted data so we&#39;re appending to the nclist</span></div>
<div class="line"><a name="l00589"></a><span class="lineno">  589</span>&#160;<span class="comment"> * in sorted order. Basically if a slice entirely fits within a previous</span></div>
<div class="line"><a name="l00590"></a><span class="lineno">  590</span>&#160;<span class="comment"> * slice then we append to that slices list. This is done recursively.</span></div>
<div class="line"><a name="l00591"></a><span class="lineno">  591</span>&#160;<span class="comment"> *</span></div>
<div class="line"><a name="l00592"></a><span class="lineno">  592</span>&#160;<span class="comment"> * Lists are sorted on two dimensions: ref id + slice coords.</span></div>
<div class="line"><a name="l00593"></a><span class="lineno">  593</span>&#160;<span class="comment"> */</span></div>
<div class="line"><a name="l00594"></a><span class="lineno"><a class="code" href="structcram__index.html">  594</a></span>&#160;<span class="keyword">typedef</span> <span class="keyword">struct </span><a class="code" href="structcram__index.html">cram_index</a> {</div>
<div class="line"><a name="l00595"></a><span class="lineno"><a class="code" href="structcram__index.html#aa8c84e57d55e82ef8f2f88d24fc2cb3e">  595</a></span>&#160;    <span class="keywordtype">int</span> <a class="code" href="structcram__index.html#aa8c84e57d55e82ef8f2f88d24fc2cb3e">nslice</a>, <a class="code" href="structcram__index.html#a3d838317d4cefb519c77717edee0cd02">nalloc</a>;   <span class="comment">// total number of slices</span></div>
<div class="line"><a name="l00596"></a><span class="lineno"><a class="code" href="structcram__index.html#a68a89e7f5a7ab27c8685cf73b01dfede">  596</a></span>&#160;    <span class="keyword">struct </span><a class="code" href="structcram__index.html">cram_index</a> *<a class="code" href="structcram__index.html#a68a89e7f5a7ab27c8685cf73b01dfede">e</a>; <span class="comment">// array of size nslice</span></div>
<div class="line"><a name="l00597"></a><span class="lineno">  597</span>&#160;</div>
<div class="line"><a name="l00598"></a><span class="lineno"><a class="code" href="structcram__index.html#a5af90f008f565eb6a0bcd74eb945a921">  598</a></span>&#160;    <span class="keywordtype">int</span>     <a class="code" href="structcram__index.html#a5af90f008f565eb6a0bcd74eb945a921">refid</a>;  <span class="comment">// 1.0                 1.1</span></div>
<div class="line"><a name="l00599"></a><span class="lineno"><a class="code" href="structcram__index.html#ad5b41da83e58b88991eddc6049561ce8">  599</a></span>&#160;    <span class="keywordtype">int</span>     <a class="code" href="structcram__index.html#ad5b41da83e58b88991eddc6049561ce8">start</a>;  <span class="comment">// 1.0                 1.1</span></div>
<div class="line"><a name="l00600"></a><span class="lineno"><a class="code" href="structcram__index.html#aecab637c26a28be07c835eaa556a14ef">  600</a></span>&#160;    <span class="keywordtype">int</span>     <a class="code" href="structcram__index.html#aecab637c26a28be07c835eaa556a14ef">end</a>;    <span class="comment">//                     1.1</span></div>
<div class="line"><a name="l00601"></a><span class="lineno"><a class="code" href="structcram__index.html#a241896ca0623a9f29e56b93f92fd7607">  601</a></span>&#160;    <span class="keywordtype">int</span>     <a class="code" href="structcram__index.html#a241896ca0623a9f29e56b93f92fd7607">nseq</a>;   <span class="comment">// 1.0 - undocumented</span></div>
<div class="line"><a name="l00602"></a><span class="lineno"><a class="code" href="structcram__index.html#a9c441d17a95462490eec18d59c5ecde8">  602</a></span>&#160;    <span class="keywordtype">int</span>     <a class="code" href="structcram__index.html#a9c441d17a95462490eec18d59c5ecde8">slice</a>;  <span class="comment">// 1.0 landmark index, 1.1 landmark value</span></div>
<div class="line"><a name="l00603"></a><span class="lineno"><a class="code" href="structcram__index.html#ac92b0603da9105c63b8d0a7cde91c046">  603</a></span>&#160;    <span class="keywordtype">int</span>     <a class="code" href="structcram__index.html#ac92b0603da9105c63b8d0a7cde91c046">len</a>;    <span class="comment">//                     1.1 - size of slice in bytes</span></div>
<div class="line"><a name="l00604"></a><span class="lineno"><a class="code" href="structcram__index.html#aacc016129087164afc141557e541f205">  604</a></span>&#160;    <a class="code" href="kstdint_8h.html#adec1df1b8b51cb32b77e5b86fff46471">int64_t</a> <a class="code" href="structcram__index.html#aacc016129087164afc141557e541f205">offset</a>; <span class="comment">// 1.0                 1.1</span></div>
<div class="line"><a name="l00605"></a><span class="lineno">  605</span>&#160;} <a class="code" href="cram__structs_8h.html#a111764495fb5cc0c1ecbe619c2489c2b">cram_index</a>;</div>
<div class="line"><a name="l00606"></a><span class="lineno">  606</span>&#160;</div>
<div class="line"><a name="l00607"></a><span class="lineno"><a class="code" href="structcram__range.html">  607</a></span>&#160;<span class="keyword">typedef</span> <span class="keyword">struct </span>{</div>
<div class="line"><a name="l00608"></a><span class="lineno"><a class="code" href="structcram__range.html#a20a4b0a2b0d2189bce931cc3c3f456d3">  608</a></span>&#160;    <span class="keywordtype">int</span> <a class="code" href="structcram__range.html#a20a4b0a2b0d2189bce931cc3c3f456d3">refid</a>;</div>
<div class="line"><a name="l00609"></a><span class="lineno"><a class="code" href="structcram__range.html#ac3f5205756db4e6de9a76e520eedd07a">  609</a></span>&#160;    <span class="keywordtype">int</span> <a class="code" href="structcram__range.html#ac3f5205756db4e6de9a76e520eedd07a">start</a>;</div>
<div class="line"><a name="l00610"></a><span class="lineno"><a class="code" href="structcram__range.html#aad0c69ed9d04a143edadd2083d8620b5">  610</a></span>&#160;    <span class="keywordtype">int</span> <a class="code" href="structcram__range.html#aad0c69ed9d04a143edadd2083d8620b5">end</a>;</div>
<div class="line"><a name="l00611"></a><span class="lineno">  611</span>&#160;} <a class="code" href="structcram__range.html">cram_range</a>;</div>
<div class="line"><a name="l00612"></a><span class="lineno">  612</span>&#160;</div>
<div class="line"><a name="l00613"></a><span class="lineno">  613</span>&#160;<span class="comment">/*-----------------------------------------------------------------------------</span></div>
<div class="line"><a name="l00614"></a><span class="lineno">  614</span>&#160;<span class="comment"> */</span></div>
<div class="line"><a name="l00615"></a><span class="lineno">  615</span>&#160;<span class="comment">/* CRAM File handle */</span></div>
<div class="line"><a name="l00616"></a><span class="lineno">  616</span>&#160;</div>
<div class="line"><a name="l00617"></a><span class="lineno"><a class="code" href="structspare__bams.html">  617</a></span>&#160;<span class="keyword">typedef</span> <span class="keyword">struct </span><a class="code" href="structspare__bams.html">spare_bams</a> {</div>
<div class="line"><a name="l00618"></a><span class="lineno"><a class="code" href="structspare__bams.html#ac53c53e231e050b01166c0f72f5bd8b2">  618</a></span>&#160;    <a class="code" href="structbam1__t.html">bam_seq_t</a> **<a class="code" href="structspare__bams.html#ac53c53e231e050b01166c0f72f5bd8b2">bams</a>;</div>
<div class="line"><a name="l00619"></a><span class="lineno"><a class="code" href="structspare__bams.html#a156d5c014fc8076af55678f670306137">  619</a></span>&#160;    <span class="keyword">struct </span><a class="code" href="structspare__bams.html">spare_bams</a> *<a class="code" href="structspare__bams.html#a156d5c014fc8076af55678f670306137">next</a>;</div>
<div class="line"><a name="l00620"></a><span class="lineno">  620</span>&#160;} <a class="code" href="cram__structs_8h.html#aed92695177214c8c93e1f8dcfb7885fe">spare_bams</a>;</div>
<div class="line"><a name="l00621"></a><span class="lineno">  621</span>&#160;</div>
<div class="line"><a name="l00622"></a><span class="lineno"><a class="code" href="structcram__fd.html">  622</a></span>&#160;<span class="keyword">typedef</span> <span class="keyword">struct </span><a class="code" href="structcram__fd.html">cram_fd</a> {</div>
<div class="line"><a name="l00623"></a><span class="lineno"><a class="code" href="structcram__fd.html#ac23aac1aa333b143f20845e93e744176">  623</a></span>&#160;    cram_FILE     *<a class="code" href="structcram__fd.html#ac23aac1aa333b143f20845e93e744176">fp</a>;</div>
<div class="line"><a name="l00624"></a><span class="lineno"><a class="code" href="structcram__fd.html#afdb562fb0446186855cf3882438eba46">  624</a></span>&#160;    <span class="keywordtype">int</span>            <a class="code" href="structcram__fd.html#afdb562fb0446186855cf3882438eba46">mode</a>;     <span class="comment">// &#39;r&#39; or &#39;w&#39;</span></div>
<div class="line"><a name="l00625"></a><span class="lineno"><a class="code" href="structcram__fd.html#a3ab0e73d202910db3fd6cbc0596190b4">  625</a></span>&#160;    <span class="keywordtype">int</span>            <a class="code" href="structcram__fd.html#a3ab0e73d202910db3fd6cbc0596190b4">version</a>;</div>
<div class="line"><a name="l00626"></a><span class="lineno"><a class="code" href="structcram__fd.html#a39e6811bd07f97471be540651ebe713a">  626</a></span>&#160;    <a class="code" href="structcram__file__def.html">cram_file_def</a> *<a class="code" href="structcram__fd.html#a39e6811bd07f97471be540651ebe713a">file_def</a>;</div>
<div class="line"><a name="l00627"></a><span class="lineno"><a class="code" href="structcram__fd.html#a7bb1003fb1ae824d3678fc008d361e33">  627</a></span>&#160;    <a class="code" href="struct_s_a_m__hdr.html">SAM_hdr</a>       *<a class="code" href="structcram__fd.html#a7bb1003fb1ae824d3678fc008d361e33">header</a>;</div>
<div class="line"><a name="l00628"></a><span class="lineno">  628</span>&#160;</div>
<div class="line"><a name="l00629"></a><span class="lineno"><a class="code" href="structcram__fd.html#aedd8e2b42960a4bd7efcf8ef7c17836b">  629</a></span>&#160;    <span class="keywordtype">char</span>          *<a class="code" href="structcram__fd.html#aedd8e2b42960a4bd7efcf8ef7c17836b">prefix</a>;</div>
<div class="line"><a name="l00630"></a><span class="lineno"><a class="code" href="structcram__fd.html#ace4e5d8483fe4fea9986d40e90776ccc">  630</a></span>&#160;    <span class="keywordtype">int</span>            <a class="code" href="structcram__fd.html#ace4e5d8483fe4fea9986d40e90776ccc">record_counter</a>;</div>
<div class="line"><a name="l00631"></a><span class="lineno"><a class="code" href="structcram__fd.html#adfbcc9a0e274cc0847f87c62510a53d4">  631</a></span>&#160;    <span class="keywordtype">int</span>            <a class="code" href="structcram__fd.html#adfbcc9a0e274cc0847f87c62510a53d4">slice_num</a>;</div>
<div class="line"><a name="l00632"></a><span class="lineno"><a class="code" href="structcram__fd.html#abafffa3476646d730376b66b081accfb">  632</a></span>&#160;    <span class="keywordtype">int</span>            <a class="code" href="structcram__fd.html#abafffa3476646d730376b66b081accfb">err</a>;</div>
<div class="line"><a name="l00633"></a><span class="lineno">  633</span>&#160;</div>
<div class="line"><a name="l00634"></a><span class="lineno">  634</span>&#160;    <span class="comment">// Most recent compression header decoded</span></div>
<div class="line"><a name="l00635"></a><span class="lineno">  635</span>&#160;    <span class="comment">//cram_block_compression_hdr *comp_hdr;</span></div>
<div class="line"><a name="l00636"></a><span class="lineno">  636</span>&#160;    <span class="comment">//cram_block_slice_hdr       *slice_hdr;</span></div>
<div class="line"><a name="l00637"></a><span class="lineno">  637</span>&#160;</div>
<div class="line"><a name="l00638"></a><span class="lineno">  638</span>&#160;    <span class="comment">// Current container being processed.</span></div>
<div class="line"><a name="l00639"></a><span class="lineno"><a class="code" href="structcram__fd.html#ae6f47a751fe7a205d52c49d30bae2f19">  639</a></span>&#160;    <a class="code" href="structcram__container.html">cram_container</a> *<a class="code" href="structcram__fd.html#ae6f47a751fe7a205d52c49d30bae2f19">ctr</a>;</div>
<div class="line"><a name="l00640"></a><span class="lineno">  640</span>&#160;</div>
<div class="line"><a name="l00641"></a><span class="lineno">  641</span>&#160;    <span class="comment">// positions for encoding or decoding</span></div>
<div class="line"><a name="l00642"></a><span class="lineno"><a class="code" href="structcram__fd.html#a6ee67d4093f49a71258d10d7b0073acf">  642</a></span>&#160;    <span class="keywordtype">int</span> <a class="code" href="structcram__fd.html#af03fa85716c77bc696c66761688c0b50">first_base</a>, <a class="code" href="structcram__fd.html#a6ee67d4093f49a71258d10d7b0073acf">last_base</a>;</div>
<div class="line"><a name="l00643"></a><span class="lineno">  643</span>&#160;</div>
<div class="line"><a name="l00644"></a><span class="lineno">  644</span>&#160;    <span class="comment">// cached reference portion</span></div>
<div class="line"><a name="l00645"></a><span class="lineno"><a class="code" href="structcram__fd.html#a47e112c31ed07fbb7405622dc76ed5e1">  645</a></span>&#160;    <a class="code" href="structrefs__t.html">refs_t</a> *<a class="code" href="structcram__fd.html#a47e112c31ed07fbb7405622dc76ed5e1">refs</a>;              <span class="comment">// ref meta-data structure</span></div>
<div class="line"><a name="l00646"></a><span class="lineno"><a class="code" href="structcram__fd.html#a587ab9223b049eb48f5017726dc9f8ca">  646</a></span>&#160;    <span class="keywordtype">char</span> *<a class="code" href="structcram__fd.html#a0de2d20b5775071d9f826ccd80088676">ref</a>, *<a class="code" href="structcram__fd.html#a587ab9223b049eb48f5017726dc9f8ca">ref_free</a>;      <span class="comment">// current portion held in memory</span></div>
<div class="line"><a name="l00647"></a><span class="lineno"><a class="code" href="structcram__fd.html#ad621dd14102836fada5730986f491ed2">  647</a></span>&#160;    <span class="keywordtype">int</span>   <a class="code" href="structcram__fd.html#ad621dd14102836fada5730986f491ed2">ref_id</a>;</div>
<div class="line"><a name="l00648"></a><span class="lineno"><a class="code" href="structcram__fd.html#ac0478813dcc2ffe7d0318b9f4a26b1cf">  648</a></span>&#160;    <span class="keywordtype">int</span>   <a class="code" href="structcram__fd.html#ac0478813dcc2ffe7d0318b9f4a26b1cf">ref_start</a>;</div>
<div class="line"><a name="l00649"></a><span class="lineno"><a class="code" href="structcram__fd.html#a12697ee7480a8f040e03b1e315b5255d">  649</a></span>&#160;    <span class="keywordtype">int</span>   <a class="code" href="structcram__fd.html#a12697ee7480a8f040e03b1e315b5255d">ref_end</a>;</div>
<div class="line"><a name="l00650"></a><span class="lineno"><a class="code" href="structcram__fd.html#a2f97919b6186875db84322f5dec37fd4">  650</a></span>&#160;    <span class="keywordtype">char</span> *<a class="code" href="structcram__fd.html#a2f97919b6186875db84322f5dec37fd4">ref_fn</a>;   <span class="comment">// reference fasta filename</span></div>
<div class="line"><a name="l00651"></a><span class="lineno">  651</span>&#160;</div>
<div class="line"><a name="l00652"></a><span class="lineno">  652</span>&#160;    <span class="comment">// compression level and metrics</span></div>
<div class="line"><a name="l00653"></a><span class="lineno"><a class="code" href="structcram__fd.html#aa4a2e807729cc3fea20d5bbfa7723401">  653</a></span>&#160;    <span class="keywordtype">int</span> <a class="code" href="structcram__fd.html#aa4a2e807729cc3fea20d5bbfa7723401">level</a>;</div>
<div class="line"><a name="l00654"></a><span class="lineno"><a class="code" href="structcram__fd.html#a43fb229359c7e908542b8cbe98a31af0">  654</a></span>&#160;    <a class="code" href="structcram__metrics.html">cram_metrics</a> *<a class="code" href="structcram__fd.html#a43fb229359c7e908542b8cbe98a31af0">m</a>[7];</div>
<div class="line"><a name="l00655"></a><span class="lineno">  655</span>&#160;</div>
<div class="line"><a name="l00656"></a><span class="lineno">  656</span>&#160;    <span class="comment">// options</span></div>
<div class="line"><a name="l00657"></a><span class="lineno"><a class="code" href="structcram__fd.html#a367de0b6486e35c884a69fd2dc105736">  657</a></span>&#160;    <span class="keywordtype">int</span> <a class="code" href="structcram__fd.html#a367de0b6486e35c884a69fd2dc105736">decode_md</a>; <span class="comment">// Whether to export MD and NM tags</span></div>
<div class="line"><a name="l00658"></a><span class="lineno"><a class="code" href="structcram__fd.html#a75d820ae9b3c36b168436988d44d667c">  658</a></span>&#160;    <span class="keywordtype">int</span> <a class="code" href="structcram__fd.html#a75d820ae9b3c36b168436988d44d667c">verbose</a>;</div>
<div class="line"><a name="l00659"></a><span class="lineno"><a class="code" href="structcram__fd.html#a10e634b3a17bd976f8e1df456356c812">  659</a></span>&#160;    <span class="keywordtype">int</span> <a class="code" href="structcram__fd.html#a10e634b3a17bd976f8e1df456356c812">seqs_per_slice</a>;</div>
<div class="line"><a name="l00660"></a><span class="lineno"><a class="code" href="structcram__fd.html#a977f80843b9afddebc0a943b6b9ba1b8">  660</a></span>&#160;    <span class="keywordtype">int</span> <a class="code" href="structcram__fd.html#a977f80843b9afddebc0a943b6b9ba1b8">slices_per_container</a>;</div>
<div class="line"><a name="l00661"></a><span class="lineno"><a class="code" href="structcram__fd.html#adcb9507fe33e5e78c685f8d491345dec">  661</a></span>&#160;    <span class="keywordtype">int</span> <a class="code" href="structcram__fd.html#adcb9507fe33e5e78c685f8d491345dec">embed_ref</a>;</div>
<div class="line"><a name="l00662"></a><span class="lineno"><a class="code" href="structcram__fd.html#ab35cffc3ef094ee8c4e2d29a79d712e0">  662</a></span>&#160;    <span class="keywordtype">int</span> <a class="code" href="structcram__fd.html#ab35cffc3ef094ee8c4e2d29a79d712e0">no_ref</a>;</div>
<div class="line"><a name="l00663"></a><span class="lineno"><a class="code" href="structcram__fd.html#a7ce6b3276751ed5818df0c8bdc6b3833">  663</a></span>&#160;    <span class="keywordtype">int</span> <a class="code" href="structcram__fd.html#a7ce6b3276751ed5818df0c8bdc6b3833">ignore_md5</a>;</div>
<div class="line"><a name="l00664"></a><span class="lineno"><a class="code" href="structcram__fd.html#a3e6e79688b55abff9c9c046e6fbe6e33">  664</a></span>&#160;    <span class="keywordtype">int</span> <a class="code" href="structcram__fd.html#a3e6e79688b55abff9c9c046e6fbe6e33">use_bz2</a>;</div>
<div class="line"><a name="l00665"></a><span class="lineno"><a class="code" href="structcram__fd.html#a62f4ab339eaea85425f84c5e39c7c3ab">  665</a></span>&#160;    <span class="keywordtype">int</span> <a class="code" href="structcram__fd.html#a62f4ab339eaea85425f84c5e39c7c3ab">shared_ref</a>;</div>
<div class="line"><a name="l00666"></a><span class="lineno"><a class="code" href="structcram__fd.html#aa4d4cea4090c7bec94f25250ab810c5d">  666</a></span>&#160;    <a class="code" href="structcram__range.html">cram_range</a> <a class="code" href="structcram__fd.html#aa4d4cea4090c7bec94f25250ab810c5d">range</a>;</div>
<div class="line"><a name="l00667"></a><span class="lineno">  667</span>&#160;</div>
<div class="line"><a name="l00668"></a><span class="lineno">  668</span>&#160;    <span class="comment">// lookup tables, stored here so we can be trivially multi-threaded</span></div>
<div class="line"><a name="l00669"></a><span class="lineno"><a class="code" href="structcram__fd.html#a2d2d4a9577a6253ce8493256f9ecaeff">  669</a></span>&#160;    <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="structcram__fd.html#a2d2d4a9577a6253ce8493256f9ecaeff">bam_flag_swap</a>[0x1000]; <span class="comment">// cram -&gt; bam flags</span></div>
<div class="line"><a name="l00670"></a><span class="lineno"><a class="code" href="structcram__fd.html#a460261428bca39cc399d6b3f0d6e89a4">  670</a></span>&#160;    <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="structcram__fd.html#a460261428bca39cc399d6b3f0d6e89a4">cram_flag_swap</a>[0x1000];<span class="comment">// bam -&gt; cram flags</span></div>
<div class="line"><a name="l00671"></a><span class="lineno"><a class="code" href="structcram__fd.html#acb665aabda24afabec12fb7ff46f71d9">  671</a></span>&#160;    <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> <a class="code" href="structcram__fd.html#acb665aabda24afabec12fb7ff46f71d9">L1</a>[256];              <span class="comment">// ACGT{*} -&gt;0123{4}</span></div>
<div class="line"><a name="l00672"></a><span class="lineno"><a class="code" href="structcram__fd.html#a98142a2d43172b10d3d10865b018a5ac">  672</a></span>&#160;    <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> <a class="code" href="structcram__fd.html#a98142a2d43172b10d3d10865b018a5ac">L2</a>[256];              <span class="comment">// ACGTN{*}-&gt;01234{5}</span></div>
<div class="line"><a name="l00673"></a><span class="lineno"><a class="code" href="structcram__fd.html#aa0ba14505df32b8a9fee64440073903a">  673</a></span>&#160;    <span class="keywordtype">char</span> <a class="code" href="structcram__fd.html#aa0ba14505df32b8a9fee64440073903a">cram_sub_matrix</a>[32][32];       <span class="comment">// base substituion codes</span></div>
<div class="line"><a name="l00674"></a><span class="lineno">  674</span>&#160;</div>
<div class="line"><a name="l00675"></a><span class="lineno"><a class="code" href="structcram__fd.html#a29d82428fde43cf49bd38d5963f2b192">  675</a></span>&#160;    <span class="keywordtype">int</span>         <a class="code" href="structcram__fd.html#a29d82428fde43cf49bd38d5963f2b192">index_sz</a>;</div>
<div class="line"><a name="l00676"></a><span class="lineno"><a class="code" href="structcram__fd.html#af99692ad4c7756e92de4b33a45c4f46d">  676</a></span>&#160;    <a class="code" href="structcram__index.html">cram_index</a> *<a class="code" href="structcram__fd.html#af99692ad4c7756e92de4b33a45c4f46d">index</a>;                  <span class="comment">// array, sizeof index_sz</span></div>
<div class="line"><a name="l00677"></a><span class="lineno"><a class="code" href="structcram__fd.html#a03be317a13069b155f7e153f1ce4c251">  677</a></span>&#160;    off_t <a class="code" href="structcram__fd.html#a03be317a13069b155f7e153f1ce4c251">first_container</a>;</div>
<div class="line"><a name="l00678"></a><span class="lineno"><a class="code" href="structcram__fd.html#aa80795fb619f6e007de7cf60e4ffd27a">  678</a></span>&#160;    <span class="keywordtype">int</span> <a class="code" href="structcram__fd.html#aa80795fb619f6e007de7cf60e4ffd27a">eof</a>;</div>
<div class="line"><a name="l00679"></a><span class="lineno"><a class="code" href="structcram__fd.html#a600c0ae3245f9a1855071607faad0de5">  679</a></span>&#160;    <span class="keywordtype">int</span> <a class="code" href="structcram__fd.html#a600c0ae3245f9a1855071607faad0de5">last_slice</a>;                     <span class="comment">// number of recs encoded in last slice</span></div>
<div class="line"><a name="l00680"></a><span class="lineno"><a class="code" href="structcram__fd.html#a5f415b831281b33ba617c6e8cc128044">  680</a></span>&#160;    <span class="keywordtype">int</span> <a class="code" href="structcram__fd.html#a5f415b831281b33ba617c6e8cc128044">multi_seq</a>;</div>
<div class="line"><a name="l00681"></a><span class="lineno"><a class="code" href="structcram__fd.html#a9e9d80c2c1f621137de814701bf43d6f">  681</a></span>&#160;    <span class="keywordtype">int</span> <a class="code" href="structcram__fd.html#a9e9d80c2c1f621137de814701bf43d6f">unsorted</a>;</div>
<div class="line"><a name="l00682"></a><span class="lineno"><a class="code" href="structcram__fd.html#a3513f4417f61ad048fb73ba7ad1b5844">  682</a></span>&#160;    <span class="keywordtype">int</span> <a class="code" href="structcram__fd.html#a3513f4417f61ad048fb73ba7ad1b5844">empty_container</a>;                <span class="comment">// Marker for EOF block</span></div>
<div class="line"><a name="l00683"></a><span class="lineno">  683</span>&#160;    </div>
<div class="line"><a name="l00684"></a><span class="lineno">  684</span>&#160;    <span class="comment">// thread pool</span></div>
<div class="line"><a name="l00685"></a><span class="lineno"><a class="code" href="structcram__fd.html#a891a01b8136db42c2a2a5ec0a1ce84ef">  685</a></span>&#160;    <span class="keywordtype">int</span> <a class="code" href="structcram__fd.html#a891a01b8136db42c2a2a5ec0a1ce84ef">own_pool</a>;</div>
<div class="line"><a name="l00686"></a><span class="lineno"><a class="code" href="structcram__fd.html#a22bbe22d2364bbfacf0b261757b42a89">  686</a></span>&#160;    <a class="code" href="structt__pool.html">t_pool</a> *<a class="code" href="structcram__fd.html#a22bbe22d2364bbfacf0b261757b42a89">pool</a>;</div>
<div class="line"><a name="l00687"></a><span class="lineno"><a class="code" href="structcram__fd.html#a445fd6b42abe08306d7d25a4f619eace">  687</a></span>&#160;    <a class="code" href="structt__results__queue.html">t_results_queue</a> *<a class="code" href="structcram__fd.html#a445fd6b42abe08306d7d25a4f619eace">rqueue</a>;</div>
<div class="line"><a name="l00688"></a><span class="lineno"><a class="code" href="structcram__fd.html#accbeefced0e59b9297f9d3a12351cb13">  688</a></span>&#160;    pthread_mutex_t <a class="code" href="structcram__fd.html#accbeefced0e59b9297f9d3a12351cb13">metrics_lock</a>;</div>
<div class="line"><a name="l00689"></a><span class="lineno"><a class="code" href="structcram__fd.html#a818fa26d1d70c046fc4e7a2564f9e54b">  689</a></span>&#160;    pthread_mutex_t <a class="code" href="structcram__fd.html#a818fa26d1d70c046fc4e7a2564f9e54b">ref_lock</a>;</div>
<div class="line"><a name="l00690"></a><span class="lineno"><a class="code" href="structcram__fd.html#ac77fa0bb896dc61dd746df6ac083d7eb">  690</a></span>&#160;    <a class="code" href="structspare__bams.html">spare_bams</a> *<a class="code" href="structcram__fd.html#ac77fa0bb896dc61dd746df6ac083d7eb">bl</a>;</div>
<div class="line"><a name="l00691"></a><span class="lineno"><a class="code" href="structcram__fd.html#a45cd1dd7c75ad66920375b18701e9fd0">  691</a></span>&#160;    pthread_mutex_t <a class="code" href="structcram__fd.html#a45cd1dd7c75ad66920375b18701e9fd0">bam_list_lock</a>;</div>
<div class="line"><a name="l00692"></a><span class="lineno"><a class="code" href="structcram__fd.html#af5a24ff45fa57db976c26024bef33aed">  692</a></span>&#160;    <span class="keywordtype">void</span> *<a class="code" href="structcram__fd.html#af5a24ff45fa57db976c26024bef33aed">job_pending</a>;</div>
<div class="line"><a name="l00693"></a><span class="lineno"><a class="code" href="structcram__fd.html#a4107abf25d79d8c1817556fb6ae078a9">  693</a></span>&#160;    <span class="keywordtype">int</span> <a class="code" href="structcram__fd.html#a4107abf25d79d8c1817556fb6ae078a9">ooc</a>;                            <span class="comment">// out of containers.</span></div>
<div class="line"><a name="l00694"></a><span class="lineno">  694</span>&#160;} <a class="code" href="cram__structs_8h.html#af682fe424937c33037a2d5329f267d3e">cram_fd</a>;</div>
<div class="line"><a name="l00695"></a><span class="lineno">  695</span>&#160;</div>
<div class="line"><a name="l00696"></a><span class="lineno"><a class="code" href="cram__structs_8h.html#a1d696a356430013cc14a2ba5cda07220">  696</a></span>&#160;<span class="keyword">enum</span> <a class="code" href="cram__structs_8h.html#a1d696a356430013cc14a2ba5cda07220">cram_option</a> {</div>
<div class="line"><a name="l00697"></a><span class="lineno"><a class="code" href="cram__structs_8h.html#a1d696a356430013cc14a2ba5cda07220a806e8698dd75a711ab2abe0ded521b75">  697</a></span>&#160;    <a class="code" href="cram__structs_8h.html#a1d696a356430013cc14a2ba5cda07220a806e8698dd75a711ab2abe0ded521b75">CRAM_OPT_DECODE_MD</a>,</div>
<div class="line"><a name="l00698"></a><span class="lineno"><a class="code" href="cram__structs_8h.html#a1d696a356430013cc14a2ba5cda07220a4226b3979ec3cbfe0d204293c5a9e466">  698</a></span>&#160;    <a class="code" href="cram__structs_8h.html#a1d696a356430013cc14a2ba5cda07220a4226b3979ec3cbfe0d204293c5a9e466">CRAM_OPT_PREFIX</a>,</div>
<div class="line"><a name="l00699"></a><span class="lineno"><a class="code" href="cram__structs_8h.html#a1d696a356430013cc14a2ba5cda07220a03db69db5f23fd8099c8e28552ab609d">  699</a></span>&#160;    <a class="code" href="cram__structs_8h.html#a1d696a356430013cc14a2ba5cda07220a03db69db5f23fd8099c8e28552ab609d">CRAM_OPT_VERBOSITY</a>,</div>
<div class="line"><a name="l00700"></a><span class="lineno"><a class="code" href="cram__structs_8h.html#a1d696a356430013cc14a2ba5cda07220a1508b9c7b0407e64ca4c30043fb87c77">  700</a></span>&#160;    <a class="code" href="cram__structs_8h.html#a1d696a356430013cc14a2ba5cda07220a1508b9c7b0407e64ca4c30043fb87c77">CRAM_OPT_SEQS_PER_SLICE</a>,</div>
<div class="line"><a name="l00701"></a><span class="lineno"><a class="code" href="cram__structs_8h.html#a1d696a356430013cc14a2ba5cda07220a794a06895570107d89a5419c29afca84">  701</a></span>&#160;    <a class="code" href="cram__structs_8h.html#a1d696a356430013cc14a2ba5cda07220a794a06895570107d89a5419c29afca84">CRAM_OPT_SLICES_PER_CONTAINER</a>,</div>
<div class="line"><a name="l00702"></a><span class="lineno"><a class="code" href="cram__structs_8h.html#a1d696a356430013cc14a2ba5cda07220a1ae2b82782377b17623d6b90cbab4168">  702</a></span>&#160;    <a class="code" href="cram__structs_8h.html#a1d696a356430013cc14a2ba5cda07220a1ae2b82782377b17623d6b90cbab4168">CRAM_OPT_RANGE</a>,</div>
<div class="line"><a name="l00703"></a><span class="lineno"><a class="code" href="cram__structs_8h.html#a1d696a356430013cc14a2ba5cda07220a440a111f5d295c477df9c04f840d7d7f">  703</a></span>&#160;    <a class="code" href="cram__structs_8h.html#a1d696a356430013cc14a2ba5cda07220a440a111f5d295c477df9c04f840d7d7f">CRAM_OPT_VERSION</a>,</div>
<div class="line"><a name="l00704"></a><span class="lineno"><a class="code" href="cram__structs_8h.html#a1d696a356430013cc14a2ba5cda07220a7a150d6e323c794cdacafaef55ce1a7e">  704</a></span>&#160;    <a class="code" href="cram__structs_8h.html#a1d696a356430013cc14a2ba5cda07220a7a150d6e323c794cdacafaef55ce1a7e">CRAM_OPT_EMBED_REF</a>,</div>
<div class="line"><a name="l00705"></a><span class="lineno"><a class="code" href="cram__structs_8h.html#a1d696a356430013cc14a2ba5cda07220a92657751927887736bfd83cebc6df43d">  705</a></span>&#160;    <a class="code" href="cram__structs_8h.html#a1d696a356430013cc14a2ba5cda07220a92657751927887736bfd83cebc6df43d">CRAM_OPT_IGNORE_MD5</a>,</div>
<div class="line"><a name="l00706"></a><span class="lineno"><a class="code" href="cram__structs_8h.html#a1d696a356430013cc14a2ba5cda07220a231032367ca9a8d6bd15b5ec0bf22617">  706</a></span>&#160;    <a class="code" href="cram__structs_8h.html#a1d696a356430013cc14a2ba5cda07220a231032367ca9a8d6bd15b5ec0bf22617">CRAM_OPT_REFERENCE</a>,</div>
<div class="line"><a name="l00707"></a><span class="lineno"><a class="code" href="cram__structs_8h.html#a1d696a356430013cc14a2ba5cda07220a18c1ed671da86021cef143693ef2409d">  707</a></span>&#160;    <a class="code" href="cram__structs_8h.html#a1d696a356430013cc14a2ba5cda07220a18c1ed671da86021cef143693ef2409d">CRAM_OPT_MULTI_SEQ_PER_SLICE</a>,</div>
<div class="line"><a name="l00708"></a><span class="lineno"><a class="code" href="cram__structs_8h.html#a1d696a356430013cc14a2ba5cda07220a20b0754ed7366fe347d143fa9ace400c">  708</a></span>&#160;    <a class="code" href="cram__structs_8h.html#a1d696a356430013cc14a2ba5cda07220a20b0754ed7366fe347d143fa9ace400c">CRAM_OPT_NO_REF</a>,</div>
<div class="line"><a name="l00709"></a><span class="lineno"><a class="code" href="cram__structs_8h.html#a1d696a356430013cc14a2ba5cda07220a1d9403ecb8bb3d443f34a61133439478">  709</a></span>&#160;    <a class="code" href="cram__structs_8h.html#a1d696a356430013cc14a2ba5cda07220a1d9403ecb8bb3d443f34a61133439478">CRAM_OPT_USE_BZIP2</a>,</div>
<div class="line"><a name="l00710"></a><span class="lineno"><a class="code" href="cram__structs_8h.html#a1d696a356430013cc14a2ba5cda07220a6e37cc55657a32097166047308a500af">  710</a></span>&#160;    <a class="code" href="cram__structs_8h.html#a1d696a356430013cc14a2ba5cda07220a6e37cc55657a32097166047308a500af">CRAM_OPT_SHARED_REF</a>,</div>
<div class="line"><a name="l00711"></a><span class="lineno"><a class="code" href="cram__structs_8h.html#a1d696a356430013cc14a2ba5cda07220a673b60fda6afddbc708460deef53e5d0">  711</a></span>&#160;    <a class="code" href="cram__structs_8h.html#a1d696a356430013cc14a2ba5cda07220a673b60fda6afddbc708460deef53e5d0">CRAM_OPT_NTHREADS</a>,</div>
<div class="line"><a name="l00712"></a><span class="lineno"><a class="code" href="cram__structs_8h.html#a1d696a356430013cc14a2ba5cda07220a7add3b78aa5a76014d8a86cdac38b243">  712</a></span>&#160;    <a class="code" href="cram__structs_8h.html#a1d696a356430013cc14a2ba5cda07220a7add3b78aa5a76014d8a86cdac38b243">CRAM_OPT_THREAD_POOL</a>,</div>
<div class="line"><a name="l00713"></a><span class="lineno">  713</span>&#160;};</div>
<div class="line"><a name="l00714"></a><span class="lineno">  714</span>&#160;</div>
<div class="line"><a name="l00715"></a><span class="lineno">  715</span>&#160;<span class="comment">/* BF bitfields */</span></div>
<div class="line"><a name="l00716"></a><span class="lineno">  716</span>&#160;<span class="comment">/* Corrected in 1.1. Use bam_flag_swap[bf] and BAM_* macros for 1.0 &amp; 1.1 */</span></div>
<div class="line"><a name="l00717"></a><span class="lineno"><a class="code" href="cram__structs_8h.html#ab262b48c6f3f6e05d4c3e5f3434e0c9e">  717</a></span>&#160;<span class="preprocessor">#define CRAM_FPAIRED      256</span></div>
<div class="line"><a name="l00718"></a><span class="lineno"><a class="code" href="cram__structs_8h.html#aaee2f656100413024a72d5cf239a80f3">  718</a></span>&#160;<span class="preprocessor"></span><span class="preprocessor">#define CRAM_FPROPER_PAIR 128</span></div>
<div class="line"><a name="l00719"></a><span class="lineno"><a class="code" href="cram__structs_8h.html#aaa99a26317ba42d7cf09978c9df6d096">  719</a></span>&#160;<span class="preprocessor"></span><span class="preprocessor">#define CRAM_FUNMAP        64</span></div>
<div class="line"><a name="l00720"></a><span class="lineno"><a class="code" href="cram__structs_8h.html#a8616eab3283bd265e3cebb3fef153f29">  720</a></span>&#160;<span class="preprocessor"></span><span class="preprocessor">#define CRAM_FREVERSE      32</span></div>
<div class="line"><a name="l00721"></a><span class="lineno"><a class="code" href="cram__structs_8h.html#a54f111aba35200bece411bb8f937a14f">  721</a></span>&#160;<span class="preprocessor"></span><span class="preprocessor">#define CRAM_FREAD1        16</span></div>
<div class="line"><a name="l00722"></a><span class="lineno"><a class="code" href="cram__structs_8h.html#a0635582c09f7582092491faf4dd43e08">  722</a></span>&#160;<span class="preprocessor"></span><span class="preprocessor">#define CRAM_FREAD2         8</span></div>
<div class="line"><a name="l00723"></a><span class="lineno"><a class="code" href="cram__structs_8h.html#a55a27712f0ad81050d2e550250f5eea4">  723</a></span>&#160;<span class="preprocessor"></span><span class="preprocessor">#define CRAM_FSECONDARY     4</span></div>
<div class="line"><a name="l00724"></a><span class="lineno"><a class="code" href="cram__structs_8h.html#acf043cc39b763fdbfcd5e117732ac759">  724</a></span>&#160;<span class="preprocessor"></span><span class="preprocessor">#define CRAM_FQCFAIL        2</span></div>
<div class="line"><a name="l00725"></a><span class="lineno"><a class="code" href="cram__structs_8h.html#a0272d7577bb65b8b918173132f911f22">  725</a></span>&#160;<span class="preprocessor"></span><span class="preprocessor">#define CRAM_FDUP           1</span></div>
<div class="line"><a name="l00726"></a><span class="lineno">  726</span>&#160;<span class="preprocessor"></span></div>
<div class="line"><a name="l00727"></a><span class="lineno"><a class="code" href="cram__structs_8h.html#ae65f980b8bd6a6a3a5503a1c77523a65">  727</a></span>&#160;<span class="preprocessor">#define CRAM_M_REVERSE  1</span></div>
<div class="line"><a name="l00728"></a><span class="lineno"><a class="code" href="cram__structs_8h.html#ace999c516e4b86b409cf2d39859647ba">  728</a></span>&#160;<span class="preprocessor"></span><span class="preprocessor">#define CRAM_M_UNMAP    2</span></div>
<div class="line"><a name="l00729"></a><span class="lineno">  729</span>&#160;<span class="preprocessor"></span></div>
<div class="line"><a name="l00730"></a><span class="lineno">  730</span>&#160;</div>
<div class="line"><a name="l00731"></a><span class="lineno">  731</span>&#160;<span class="comment">/* CF bitfields */</span></div>
<div class="line"><a name="l00732"></a><span class="lineno"><a class="code" href="cram__structs_8h.html#a5e191a54fac6e74e1767dabc26e2f13a">  732</a></span>&#160;<span class="preprocessor">#define CRAM_FLAG_PRESERVE_QUAL_SCORES (1&lt;&lt;0)</span></div>
<div class="line"><a name="l00733"></a><span class="lineno"><a class="code" href="cram__structs_8h.html#ac9bb3103e0140f6f37b32f3cbe3ca316">  733</a></span>&#160;<span class="preprocessor"></span><span class="preprocessor">#define CRAM_FLAG_DETACHED             (1&lt;&lt;1)</span></div>
<div class="line"><a name="l00734"></a><span class="lineno"><a class="code" href="cram__structs_8h.html#afa373b7aa76b6922ea856c0aae4e234d">  734</a></span>&#160;<span class="preprocessor"></span><span class="preprocessor">#define CRAM_FLAG_MATE_DOWNSTREAM      (1&lt;&lt;2)</span></div>
<div class="line"><a name="l00735"></a><span class="lineno">  735</span>&#160;<span class="preprocessor"></span></div>
<div class="line"><a name="l00736"></a><span class="lineno">  736</span>&#160;<span class="comment">/* External IDs used by this implementation (only assumed during writing) */</span></div>
<div class="line"><a name="l00737"></a><span class="lineno"><a class="code" href="cram__structs_8h.html#a34b2f7842f7342dd746464b2dca1518d">  737</a></span>&#160;<span class="preprocessor">#define CRAM_EXT_IN     0</span></div>
<div class="line"><a name="l00738"></a><span class="lineno"><a class="code" href="cram__structs_8h.html#aa514de09eb4c84462ebae99e90604e69">  738</a></span>&#160;<span class="preprocessor"></span><span class="preprocessor">#define CRAM_EXT_QUAL   1</span></div>
<div class="line"><a name="l00739"></a><span class="lineno"><a class="code" href="cram__structs_8h.html#a9fa358f75055353f385120383b8b4e2c">  739</a></span>&#160;<span class="preprocessor"></span><span class="preprocessor">#define CRAM_EXT_NAME   2</span></div>
<div class="line"><a name="l00740"></a><span class="lineno"><a class="code" href="cram__structs_8h.html#a794cc7a1b35b91ed91a1133d8b46f51a">  740</a></span>&#160;<span class="preprocessor"></span><span class="preprocessor">#define CRAM_EXT_TS_NP  3</span></div>
<div class="line"><a name="l00741"></a><span class="lineno"><a class="code" href="cram__structs_8h.html#a7ddf7026b255e8c2c796563580ba77d8">  741</a></span>&#160;<span class="preprocessor"></span><span class="preprocessor">#define CRAM_EXT_TAG    4</span></div>
<div class="line"><a name="l00742"></a><span class="lineno"><a class="code" href="cram__structs_8h.html#ae61de3c70ebed340fdced918154e9d01">  742</a></span>&#160;<span class="preprocessor"></span><span class="preprocessor">#define CRAM_EXT_TAG_S  &quot;\004&quot;</span></div>
<div class="line"><a name="l00743"></a><span class="lineno"><a class="code" href="cram__structs_8h.html#af5d06ea34c1db25c9ac9c3bae50896de">  743</a></span>&#160;<span class="preprocessor"></span><span class="preprocessor">#define CRAM_EXT_BA     5</span></div>
<div class="line"><a name="l00744"></a><span class="lineno"><a class="code" href="cram__structs_8h.html#a229809e7edc7b2fa72630b2b312e9b56">  744</a></span>&#160;<span class="preprocessor"></span><span class="preprocessor">#define CRAM_EXT_TN     6</span></div>
<div class="line"><a name="l00745"></a><span class="lineno"><a class="code" href="cram__structs_8h.html#a880ccb6fd23ce58be980bb55bec923b0">  745</a></span>&#160;<span class="preprocessor"></span><span class="preprocessor">#define CRAM_EXT_SC     7</span></div>
<div class="line"><a name="l00746"></a><span class="lineno"><a class="code" href="cram__structs_8h.html#a33046412ecd645cfb2900770fcaff18c">  746</a></span>&#160;<span class="preprocessor"></span><span class="preprocessor">#define CRAM_EXT_REF    8</span></div>
<div class="line"><a name="l00747"></a><span class="lineno">  747</span>&#160;<span class="preprocessor"></span></div>
<div class="line"><a name="l00748"></a><span class="lineno">  748</span>&#160;<span class="preprocessor">#ifdef __cplusplus</span></div>
<div class="line"><a name="l00749"></a><span class="lineno">  749</span>&#160;<span class="preprocessor"></span>}</div>
<div class="line"><a name="l00750"></a><span class="lineno">  750</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00751"></a><span class="lineno">  751</span>&#160;<span class="preprocessor"></span></div>
<div class="line"><a name="l00752"></a><span class="lineno">  752</span>&#160;<span class="preprocessor">#endif </span><span class="comment">/* _CRAM_STRUCTS_H_ */</span><span class="preprocessor"></span></div>
</div><!-- fragment --></div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Fri Jan 23 2015 23:39:22 for NVBIO by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.4
</small></address>
</body>
</html>
