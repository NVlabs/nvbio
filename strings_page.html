<!-- HTML header for doxygen 1.8.4-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.4"/>
<title>NVBIO: Strings Module</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="extra_stylesheet.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript">
    (function(i, s, o, g, r, a, m) {
        i['GoogleAnalyticsObject'] = r; i[r] = i[r] || function() {
            (i[r].q = i[r].q || []).push(arguments)
        }, i[r].l = 1 * new Date(); a = s.createElement(o),
  m = s.getElementsByTagName(o)[0]; a.async = 1; a.src = g; m.parentNode.insertBefore(a, m)
    })(window, document, 'script', '//www.google-analytics.com/analytics.js', 'ga');
    ga('create', 'UA-47310325-1', 'nvlabs.github.io');
    ga('send', 'pageview');
</script>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">NVBIO
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.4 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="modules.html"><span>Modules</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li><a href="examples.html"><span>Examples</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Classes</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Namespaces</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&#160;</span>Typedefs</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(7)"><span class="SelectionMark">&#160;</span>Enumerations</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(8)"><span class="SelectionMark">&#160;</span>Enumerator</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(9)"><span class="SelectionMark">&#160;</span>Friends</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(10)"><span class="SelectionMark">&#160;</span>Macros</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(11)"><span class="SelectionMark">&#160;</span>Groups</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(12)"><span class="SelectionMark">&#160;</span>Pages</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="index.html">NVBIO</a></li><li class="navelem"><a class="el" href="nvbio_page.html">NVBIO</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="headertitle">
<div class="title">Strings Module </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><dl class="section user"><dt></dt><dd>This module provides generic constructs to work with strings and string-sets. A string-set is a collection of strings. As there's many ways to encode a string, there's even more ways to represent a string set. For example, one might want to store the strings into a single concatenated array, and store offsets to the beginning of each one. Or he might want to build a small string set out of a sparse subset of a big string (for example, to carve a few isolated regions out of a genome). And the support string might be either encoded with ascii characters, or packed using a few bits per symbol.</dd></dl>
<h1><a class="anchor" id="AlphabetsSection"></a>
Alphabets</h1>
<dl class="section user"><dt></dt><dd>This module provides a set of operators to work with various alphabets: </dd></dl>
<dl class="section user"><dt></dt><dd><ul>
<li><a class="el" href="group___alphabets_module.html#gacd06da18687b2a345bef56a9fdad1a48">Alphabet</a> = { DNA, DNA_N, DNA_IUPAC, RNA, RNA_N, PROTEIN }</li>
<li><a class="el" href="group___alphabets_module.html#ga831617ecf9b4dcee4e6d76ae34d6bdaf">to_char</a></li>
<li><a class="el" href="group___alphabets_module.html#gadf1c681232268ab1a7e4fd76575b9a50">from_char</a></li>
<li><a class="el" href="group___alphabets_module.html#ga56996291b8389b36b17864d378057739">to_string</a></li>
<li><a class="el" href="group___alphabets_module.html#gab1c60079a56884c68f618cf3549f3704">from_string</a> </li>
</ul>
</dd></dl>
<dl class="section user"><dt></dt><dd>The list of all available operators is available in the <a class="el" href="group___alphabets_module.html">Alphabet Module</a>.</dd></dl>
<h1><a class="anchor" id="StringSetInterface"></a>
String-Set Interfaces</h1>
<dl class="section user"><dt></dt><dd>String sets are generic, interchangeable containers that expose the same interface: <a class="anchor" id="StringSetAnchor"></a><div class="fragment"><div class="line"><span class="keyword">interface </span>StringSet</div>
<div class="line">{</div>
<div class="line">    <span class="comment">// specify the type of the strings</span></div>
<div class="line">    <span class="keyword">typedef</span> ... string_type;</div>
<div class="line"></div>
<div class="line">    <span class="comment">// return the size of the set</span></div>
<div class="line">    <a class="code" href="group___basic.html#gac34ecd066ef3371643ada1f73d9a2e96">uint32</a> size() <span class="keyword">const</span>;</div>
<div class="line"></div>
<div class="line">    <span class="comment">// return the i-th string in the set</span></div>
<div class="line">    string_type operator[] (<span class="keyword">const</span> <a class="code" href="group___basic.html#gac34ecd066ef3371643ada1f73d9a2e96">uint32</a>) [<span class="keyword">const</span>];</div>
<div class="line">}</div>
</div><!-- fragment --> </dd></dl>
<dl class="section user"><dt></dt><dd>This module provides a few generic string set adaptors that can be "configured" by means of the underlying template iterators. The philosophy behind all of these containers is that they are just <em>shallow representations</em>, holding no storage. Hence they can be used both in host and device code. </dd></dl>
<dl class="section user"><dt></dt><dd><ul>
<li><a class="el" href="structnvbio_1_1_concatenated_string_set.html">ConcatenatedStringSet</a></li>
<li><a class="el" href="structnvbio_1_1_sparse_string_set.html">SparseStringSet</a></li>
<li><a class="el" href="structnvbio_1_1_strided_packed_string_set.html">StridedPackedStringSet</a></li>
<li><a class="el" href="structnvbio_1_1_strided_string_set.html">StridedStringSet</a></li>
<li><a class="el" href="structnvbio_1_1_infix_set.html">InfixSet</a></li>
<li><a class="el" href="structnvbio_1_1_prefix_set.html">PrefixSet</a></li>
<li><a class="el" href="structnvbio_1_1_suffix_set.html">SuffixSet</a> </li>
</ul>
</dd></dl>
<dl class="section user"><dt></dt><dd>Furthermore, the module provides efficient generic <a class="el" href="namespacenvbio.html#a34d9d5d8887ce8bb60887a0a86ce687b">copy()</a> (resp. <a class="el" href="namespacenvbio_1_1cuda.html#a14fff628aa09cc0400eee8f4e158686c">cuda::copy()</a>) implementations to copy a given host (resp. device) string set from a given layout into another with a different layout.</dd></dl>
<h1><a class="anchor" id="SeedingSection"></a>
Seeding</h1>
<dl class="section user"><dt></dt><dd>Many bioinformatics applications need to extract short <em>seeds</em> out of strings and string-sets: such seeds are nothing but <a class="el" href="structnvbio_1_1_infix_set.html">infixes</a>. This module provides a few convenience functions to enumerate all seeds resulting by applying a <a class="el" href="group___string_sets_module.html#SeedFunctor">Seeding Functor</a> to a string or string-set. Internally, these simple functions employ massively parallel algorithms, which run either on the host or on the bound cuda device, depending on whether the output is a host or device vector. </dd></dl>
<dl class="section user"><dt></dt><dd><a class="anchor" id="SeedingAnchor"></a><ul>
<li><a class="el" href="group___string_sets_module.html#ga4267e15bcaeb5194447728a8377f0c79">enumerate_string_seeds()</a></li>
<li><a class="el" href="group___string_sets_module.html#ga26375e5ce59fadcb3952faa10035a90c">enumerate_string_set_seeds()</a></li>
<li><a class="el" href="structnvbio_1_1uniform__seeds__functor.html">uniform_seeds_functor</a></li>
</ul>
</dd></dl>
<dl class="section user"><dt></dt><dd>The following is a sample showing how to extract uniformly sampled seeds from a host or device string-set, and construct an <a class="el" href="structnvbio_1_1_infix_set.html">InfixSet</a> to represent them: <div class="fragment"><div class="line"><span class="comment">// extract a set of uniformly spaced seeds from a string-set and return it as an InfixSet</span></div>
<div class="line"><span class="comment">//</span></div>
<div class="line"><span class="keyword">template</span> &lt;<span class="keyword">typename</span> system_tag, <span class="keyword">typename</span> <span class="keywordtype">string</span>_set_type&gt;</div>
<div class="line">InfixSet&lt;string_set_type, const string_set_infix_coord_type*&gt;</div>
<div class="line">extract_seeds(</div>
<div class="line">    <span class="keyword">const</span> string_set_type                                   string_set,</div>
<div class="line">    <span class="keyword">const</span> <a class="code" href="group___basic.html#gac34ecd066ef3371643ada1f73d9a2e96">uint32</a>                                            seed_len,</div>
<div class="line">    <span class="keyword">const</span> <a class="code" href="group___basic.html#gac34ecd066ef3371643ada1f73d9a2e96">uint32</a>                                            seed_interval,</div>
<div class="line">    <a class="code" href="structnvbio_1_1vector.html">nvbio::vector&lt;system_tag,string_set_infix_coord_type&gt;</a>&amp;  seed_coords)</div>
<div class="line">{</div>
<div class="line">    <span class="comment">// enumerate all seeds</span></div>
<div class="line">    <span class="keyword">const</span> <a class="code" href="group___basic.html#gac34ecd066ef3371643ada1f73d9a2e96">uint32</a> n_seeds = <a class="code" href="group___string_sets_module.html#ga26375e5ce59fadcb3952faa10035a90c">enumerate_string_set_seeds</a>(</div>
<div class="line">        string_set,</div>
<div class="line">        uniform_seeds_functor&lt;&gt;( seed_len, seed_interval ),</div>
<div class="line">        seed_coords );</div>
<div class="line"></div>
<div class="line">    <span class="comment">// and build the output infix-set</span></div>
<div class="line">    <span class="keywordflow">return</span> InfixSet&lt;string_set_type, const string_set_infix_coord_type*&gt;(</div>
<div class="line">        n_seeds,</div>
<div class="line">        string_set,</div>
<div class="line">        <a class="code" href="group___packed_streams.html#gaa8a57b67f0319432f01a849df6699bfe">nvbio::plain_view</a>( seed_coords ) );</div>
<div class="line">}</div>
</div><!-- fragment --> See examples/seeding/seeding.cu for more details.</dd></dl>
<h1><a class="anchor" id="WaveletTreeSection"></a>
Wavelet Trees</h1>
<dl class="section user"><dt></dt><dd>A <em>Wavelet Tree</em> is a data structure that can be used to encode a string T of <em>n</em> symbols from an alphabet of <em>s</em> characters in space O(n log(s)), allowing both symbol access and ranking in O(log(s)) time, i.e: </dd></dl>
<dl class="section user"><dt></dt><dd><ul>
<li>each character T[i] can be recovered in O(log(s)) time</li>
<li>the number of occurrences of a character c in the substring T[0,i] can be counted in O(log(s)) time </li>
</ul>
</dd></dl>
<dl class="section user"><dt></dt><dd>In other words, a Wavelet Tree is both an alternative string representation (often more amenable to compression), <em>and</em> a storage-efficient <a class="el" href="fmindex_page.html#RankDictionarySection">rank dictionary</a>. For the sake of comparison, notice that the <a class="el" href="structnvbio_1_1rank__dictionary.html">rank_dictionary</a> class, which is based on a standard sampled occurrence table built directly on top of the original string T, needs O(s) storage - exponentially more in the number of bits per symbol <em>b = log(s)</em>. </dd></dl>
<dl class="section user"><dt></dt><dd>NVBIO provides two classes: </dd></dl>
<dl class="section user"><dt></dt><dd><ul>
<li><a class="el" href="structnvbio_1_1_wavelet_tree_storage.html">WaveletTreeStorage</a> : a proper wavelet tree implementation, which can instanced using either <em>host</em> or <em>device</em> memory</li>
<li><a class="el" href="structnvbio_1_1_wavelet_tree.html">WaveletTree</a> : a shallow, <em>storage-less</em> representation, which can be instanced on arbitrary user supplied iterators to the actual data containers </li>
</ul>
</dd></dl>
<dl class="section user"><dt></dt><dd>as well as parallel host and device construction and lookup functions. See the <a class="el" href="group___wavelet_tree_module.html">Wavelet Trees</a> module for further documentation. </dd></dl>
<dl class="section user"><dt></dt><dd>The following is a sample showing how to build a <a class="el" href="structnvbio_1_1_wavelet_tree.html">WaveletTree</a> and query it: <div class="fragment"><div class="line"><span class="keywordtype">void</span> test_wavelet_tree()</div>
<div class="line">{</div>
<div class="line">    <span class="keyword">const</span> <span class="keywordtype">char</span>* text = <span class="stringliteral">&quot;This is a test String&quot;</span>;</div>
<div class="line">    <span class="keyword">const</span> <a class="code" href="group___basic.html#gac34ecd066ef3371643ada1f73d9a2e96">uint32</a> text_len = <a class="code" href="group___basic.html#gac34ecd066ef3371643ada1f73d9a2e96">uint32</a>( <a class="code" href="group___basic.html#gae962be09940c267ce467e74a160a542a">nvbio::length</a>( text ) );</div>
<div class="line"></div>
<div class="line">    <span class="comment">// copy the text string onto the device, reinterpreting as uint8 as the WaveletTree</span></div>
<div class="line">    <span class="comment">// expects symbols to be encoded using unsigned integral types</span></div>
<div class="line">    <a class="code" href="structnvbio_1_1vector.html">nvbio::vector&lt;device_tag,uint8&gt;</a> d_text( text_len );</div>
<div class="line">    <a class="code" href="namespacenvbio_1_1cuda.html#a14fff628aa09cc0400eee8f4e158686c">thrust::copy</a>( (<span class="keyword">const</span> <a class="code" href="group___basic.html#gaec56d52d6a3fb4ac8fbbbe2db73f683d">uint8</a>*)text, (<span class="keyword">const</span> <a class="code" href="group___basic.html#gaec56d52d6a3fb4ac8fbbbe2db73f683d">uint8</a>*)text + text_len, d_text );</div>
<div class="line"></div>
<div class="line">    <span class="comment">// instantiate a wavelet tree</span></div>
<div class="line">    WaveletTreeStorage&lt;device_tag&gt; wavelet_tree;</div>
<div class="line"></div>
<div class="line">    <span class="comment">// setup the wavelet tree</span></div>
<div class="line">    <a class="code" href="namespacenvbio.html#a38ab43e80dd4fcdad0cff15c96f25037">setup</a>( text_len, d_text.begin(), wavelet_tree );</div>
<div class="line"></div>
<div class="line">    <span class="comment">// extract the text in parallel using the WaveletTree&#39;s unary functor operator()</span></div>
<div class="line">    <span class="comment">// to transform the sequence of indices [0,text_len) into the sequence of</span></div>
<div class="line">    <span class="comment">// corresponding characters</span></div>
<div class="line">    nvbio::transform&lt;device_tag&gt;(</div>
<div class="line">        text_len,                                       <span class="comment">// number of characters to extract</span></div>
<div class="line">        thrust::make_counting_iterator&lt;uint32&gt;(0),      <span class="comment">// list of character indices</span></div>
<div class="line">        d_text.begin(),                                 <span class="comment">// output sequence</span></div>
<div class="line">        <a class="code" href="group___packed_streams.html#gaa8a57b67f0319432f01a849df6699bfe">plain_view</a>( wavelet_tree ) );                   <span class="comment">// plain_view of the WaveletTreeStorage class</span></div>
<div class="line"></div>
<div class="line">    <span class="comment">// copy the results back to the host</span></div>
<div class="line">    <a class="code" href="structnvbio_1_1vector.html">nvbio::vector&lt;host_tag,uint8&gt;</a> h_extracted_text( d_text );</div>
<div class="line"></div>
<div class="line">    <span class="comment">// check we extracted the right string...</span></div>
<div class="line">    printf(<span class="stringliteral">&quot;extracted \&quot;%s\&quot;&quot;</span>, (<span class="keyword">const</span> <span class="keywordtype">char</span>*)<a class="code" href="namespacenvbio.html#a8ad991c39278eb9e0d0000f2b12031da">raw_pointer</a>( h_extracted_text ));</div>
<div class="line"></div>
<div class="line">    <span class="comment">// check that in position 0 there should be exactly one &#39;T&#39;</span></div>
<div class="line">    printf(<span class="stringliteral">&quot;rank(0,T) = %u\n&quot;</span>, <a class="code" href="namespacenvbio.html#a8cac81743120b36275cee02d66137fdd">rank</a>( <a class="code" href="group___packed_streams.html#gaa8a57b67f0319432f01a849df6699bfe">plain_view</a>( wavelet_tree ), 0, (<a class="code" href="group___basic.html#gaec56d52d6a3fb4ac8fbbbe2db73f683d">uint8</a>)<span class="charliteral">&#39;T&#39;</span> ));</div>
<div class="line"></div>
<div class="line">    <span class="comment">// check that the range [0,6] contains exactly two &#39;s&#39;</span></div>
<div class="line">    printf(<span class="stringliteral">&quot;rank(6,s) = %u\n&quot;</span>, <a class="code" href="namespacenvbio.html#a8cac81743120b36275cee02d66137fdd">rank</a>( <a class="code" href="group___packed_streams.html#gaa8a57b67f0319432f01a849df6699bfe">plain_view</a>( wavelet_tree ), 6, (<a class="code" href="group___basic.html#gaec56d52d6a3fb4ac8fbbbe2db73f683d">uint8</a>)<span class="charliteral">&#39;s&#39;</span> ));</div>
<div class="line">}</div>
</div><!-- fragment --></dd></dl>
<h1><a class="anchor" id="TechnicalOverviewSection"></a>
Technical Overview</h1>
<dl class="section user"><dt></dt><dd>For a detailed description of all classes and functions see the <a class="el" href="group___strings.html">Strings Module</a> documentation. </dd></dl>
</div></div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Sat Feb 14 2015 09:21:36 for NVBIO by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.4
</small></address>
</body>
</html>
